<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Daniel A. Olivares Vera">
<meta name="dcterms.date" content="2026-02-25">
<meta name="keywords" content="Bayesian Optimization, Structural Equation Modeling, MILP, Supply Chain">

<title>Bayesian–MILP Model for Multi-Tier Supply Chains</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-a74871fe4945b66d259aafc266475145.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="index_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="index_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="index_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#unified-model-architecture" id="toc-unified-model-architecture" class="nav-link" data-scroll-target="#unified-model-architecture"><span class="header-section-number">2</span> Unified Model Architecture</a></li>
  <li><a href="#bayesian-structural-equation-model" id="toc-bayesian-structural-equation-model" class="nav-link" data-scroll-target="#bayesian-structural-equation-model"><span class="header-section-number">3</span> Bayesian Structural Equation Model</a>
  <ul class="collapse">
  <li><a href="#structural-model-latent-quality-propagation" id="toc-structural-model-latent-quality-propagation" class="nav-link" data-scroll-target="#structural-model-latent-quality-propagation"><span class="header-section-number">3.1</span> Structural Model (Latent Quality Propagation)</a></li>
  <li><a href="#measurement-model-multi-criteria-evaluation" id="toc-measurement-model-multi-criteria-evaluation" class="nav-link" data-scroll-target="#measurement-model-multi-criteria-evaluation"><span class="header-section-number">3.2</span> Measurement Model (Multi-Criteria Evaluation)</a></li>
  <li><a href="#bayesian-estimation" id="toc-bayesian-estimation" class="nav-link" data-scroll-target="#bayesian-estimation"><span class="header-section-number">3.3</span> Bayesian Estimation</a></li>
  </ul></li>
  <li><a href="#customer-satisfaction-endogenous-demand-and-utility" id="toc-customer-satisfaction-endogenous-demand-and-utility" class="nav-link" data-scroll-target="#customer-satisfaction-endogenous-demand-and-utility"><span class="header-section-number">4</span> Customer Satisfaction, Endogenous Demand, and Utility</a>
  <ul class="collapse">
  <li><a href="#customer-specific-satisfaction-aggregation" id="toc-customer-specific-satisfaction-aggregation" class="nav-link" data-scroll-target="#customer-specific-satisfaction-aggregation"><span class="header-section-number">4.1</span> Customer-Specific Satisfaction Aggregation</a></li>
  <li><a href="#endogenous-demand-as-a-function-of-satisfaction" id="toc-endogenous-demand-as-a-function-of-satisfaction" class="nav-link" data-scroll-target="#endogenous-demand-as-a-function-of-satisfaction"><span class="header-section-number">4.2</span> Endogenous Demand as a Function of Satisfaction</a></li>
  <li><a href="#economic-utility-and-cost-structure" id="toc-economic-utility-and-cost-structure" class="nav-link" data-scroll-target="#economic-utility-and-cost-structure"><span class="header-section-number">4.3</span> Economic Utility and Cost Structure</a></li>
  <li><a href="#where-bayesian-optimization-enters" id="toc-where-bayesian-optimization-enters" class="nav-link" data-scroll-target="#where-bayesian-optimization-enters"><span class="header-section-number">4.4</span> Where Bayesian Optimization Enters</a></li>
  </ul></li>
  <li><a href="#bayesian-optimization-layer" id="toc-bayesian-optimization-layer" class="nav-link" data-scroll-target="#bayesian-optimization-layer"><span class="header-section-number">5</span> Bayesian Optimization Layer</a>
  <ul class="collapse">
  <li><a href="#gaussian-process-surrogate-model" id="toc-gaussian-process-surrogate-model" class="nav-link" data-scroll-target="#gaussian-process-surrogate-model"><span class="header-section-number">5.1</span> Gaussian Process Surrogate Model</a></li>
  <li><a href="#expected-improvement-acquisition-function" id="toc-expected-improvement-acquisition-function" class="nav-link" data-scroll-target="#expected-improvement-acquisition-function"><span class="header-section-number">5.2</span> Expected Improvement Acquisition Function</a></li>
  <li><a href="#integrated-bayesianmilp-procedure" id="toc-integrated-bayesianmilp-procedure" class="nav-link" data-scroll-target="#integrated-bayesianmilp-procedure"><span class="header-section-number">5.3</span> Integrated Bayesian–MILP Procedure</a></li>
  </ul></li>
  <li><a href="#numerical-experiment-industrial-multi-tier-case-study" id="toc-numerical-experiment-industrial-multi-tier-case-study" class="nav-link" data-scroll-target="#numerical-experiment-industrial-multi-tier-case-study"><span class="header-section-number">6</span> Numerical Experiment: Industrial Multi-Tier Case Study</a>
  <ul class="collapse">
  <li><a href="#network-structure" id="toc-network-structure" class="nav-link" data-scroll-target="#network-structure"><span class="header-section-number">6.1</span> Network Structure</a></li>
  <li><a href="#multi-product-satisfaction-and-demand" id="toc-multi-product-satisfaction-and-demand" class="nav-link" data-scroll-target="#multi-product-satisfaction-and-demand"><span class="header-section-number">6.2</span> Multi-Product Satisfaction and Demand</a></li>
  <li><a href="#cost-structure" id="toc-cost-structure" class="nav-link" data-scroll-target="#cost-structure"><span class="header-section-number">6.3</span> Cost Structure</a></li>
  <li><a href="#integrated-optimization-problem" id="toc-integrated-optimization-problem" class="nav-link" data-scroll-target="#integrated-optimization-problem"><span class="header-section-number">6.4</span> Integrated Optimization Problem</a></li>
  <li><a href="#bayesian-optimization-procedure" id="toc-bayesian-optimization-procedure" class="nav-link" data-scroll-target="#bayesian-optimization-procedure"><span class="header-section-number">6.5</span> Bayesian Optimization Procedure</a></li>
  <li><a href="#performance-metrics" id="toc-performance-metrics" class="nav-link" data-scroll-target="#performance-metrics"><span class="header-section-number">6.6</span> Performance Metrics</a></li>
  <li><a href="#parameter-calibration-and-scenario-design" id="toc-parameter-calibration-and-scenario-design" class="nav-link" data-scroll-target="#parameter-calibration-and-scenario-design"><span class="header-section-number">6.7</span> Parameter Calibration and Scenario Design</a>
  <ul class="collapse">
  <li><a href="#economic-parameters" id="toc-economic-parameters" class="nav-link" data-scroll-target="#economic-parameters"><span class="header-section-number">6.7.1</span> Economic Parameters</a></li>
  <li><a href="#capacity-constraints" id="toc-capacity-constraints" class="nav-link" data-scroll-target="#capacity-constraints"><span class="header-section-number">6.7.2</span> Capacity Constraints</a></li>
  <li><a href="#demand-potential" id="toc-demand-potential" class="nav-link" data-scroll-target="#demand-potential"><span class="header-section-number">6.7.3</span> Demand Potential</a></li>
  <li><a href="#customer-preference-initialization" id="toc-customer-preference-initialization" class="nav-link" data-scroll-target="#customer-preference-initialization"><span class="header-section-number">6.7.4</span> Customer Preference Initialization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#experimental-scenarios-and-comparative-analysis" id="toc-experimental-scenarios-and-comparative-analysis" class="nav-link" data-scroll-target="#experimental-scenarios-and-comparative-analysis"><span class="header-section-number">7</span> Experimental Scenarios and Comparative Analysis</a>
  <ul class="collapse">
  <li><a href="#scenario-a-deterministic-baseline" id="toc-scenario-a-deterministic-baseline" class="nav-link" data-scroll-target="#scenario-a-deterministic-baseline"><span class="header-section-number">7.1</span> Scenario A – Deterministic Baseline</a></li>
  <li><a href="#scenario-b-sem-without-bayesian-optimization" id="toc-scenario-b-sem-without-bayesian-optimization" class="nav-link" data-scroll-target="#scenario-b-sem-without-bayesian-optimization"><span class="header-section-number">7.2</span> Scenario B – SEM Without Bayesian Optimization</a></li>
  <li><a href="#scenario-c-full-bayesianmilp-integration" id="toc-scenario-c-full-bayesianmilp-integration" class="nav-link" data-scroll-target="#scenario-c-full-bayesianmilp-integration"><span class="header-section-number">7.3</span> Scenario C – Full Bayesian–MILP Integration</a></li>
  <li><a href="#scenario-d-high-structural-cost-environment" id="toc-scenario-d-high-structural-cost-environment" class="nav-link" data-scroll-target="#scenario-d-high-structural-cost-environment"><span class="header-section-number">7.4</span> Scenario D – High Structural Cost Environment</a></li>
  </ul></li>
  <li><a href="#performance-metrics-1" id="toc-performance-metrics-1" class="nav-link" data-scroll-target="#performance-metrics-1"><span class="header-section-number">8</span> Performance Metrics</a>
  <ul class="collapse">
  <li><a href="#expected-economic-utility" id="toc-expected-economic-utility" class="nav-link" data-scroll-target="#expected-economic-utility"><span class="header-section-number">8.1</span> Expected Economic Utility</a></li>
  <li><a href="#network-sparsity" id="toc-network-sparsity" class="nav-link" data-scroll-target="#network-sparsity"><span class="header-section-number">8.2</span> Network Sparsity</a></li>
  <li><a href="#average-customer-satisfaction" id="toc-average-customer-satisfaction" class="nav-link" data-scroll-target="#average-customer-satisfaction"><span class="header-section-number">8.3</span> Average Customer Satisfaction</a></li>
  <li><a href="#demand-fulfillment-ratio" id="toc-demand-fulfillment-ratio" class="nav-link" data-scroll-target="#demand-fulfillment-ratio"><span class="header-section-number">8.4</span> Demand Fulfillment Ratio</a></li>
  <li><a href="#bayesian-optimization-convergence" id="toc-bayesian-optimization-convergence" class="nav-link" data-scroll-target="#bayesian-optimization-convergence"><span class="header-section-number">8.5</span> Bayesian Optimization Convergence</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">9</span> Results</a>
  <ul class="collapse">
  <li><a href="#expected-utility-comparison" id="toc-expected-utility-comparison" class="nav-link" data-scroll-target="#expected-utility-comparison"><span class="header-section-number">9.1</span> Expected Utility Comparison</a></li>
  <li><a href="#network-structure-behavior" id="toc-network-structure-behavior" class="nav-link" data-scroll-target="#network-structure-behavior"><span class="header-section-number">9.2</span> Network Structure Behavior</a></li>
  <li><a href="#customer-satisfaction" id="toc-customer-satisfaction" class="nav-link" data-scroll-target="#customer-satisfaction"><span class="header-section-number">9.3</span> Customer Satisfaction</a></li>
  <li><a href="#demand-fulfillment" id="toc-demand-fulfillment" class="nav-link" data-scroll-target="#demand-fulfillment"><span class="header-section-number">9.4</span> Demand Fulfillment</a></li>
  <li><a href="#bayesian-optimization-convergence-1" id="toc-bayesian-optimization-convergence-1" class="nav-link" data-scroll-target="#bayesian-optimization-convergence-1"><span class="header-section-number">9.5</span> Bayesian Optimization Convergence</a></li>
  <li><a href="#managerial-interpretation" id="toc-managerial-interpretation" class="nav-link" data-scroll-target="#managerial-interpretation"><span class="header-section-number">9.6</span> Managerial Interpretation</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">10</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#structural-impact-of-latent-quality-propagation" id="toc-structural-impact-of-latent-quality-propagation" class="nav-link" data-scroll-target="#structural-impact-of-latent-quality-propagation"><span class="header-section-number">10.1</span> Structural Impact of Latent Quality Propagation</a></li>
  <li><a href="#value-of-bayesian-optimization" id="toc-value-of-bayesian-optimization" class="nav-link" data-scroll-target="#value-of-bayesian-optimization"><span class="header-section-number">10.2</span> Value of Bayesian Optimization</a></li>
  <li><a href="#network-sparsity-as-a-strategic-outcome" id="toc-network-sparsity-as-a-strategic-outcome" class="nav-link" data-scroll-target="#network-sparsity-as-a-strategic-outcome"><span class="header-section-number">10.3</span> Network Sparsity as a Strategic Outcome</a></li>
  <li><a href="#robustness-under-structural-cost-stress" id="toc-robustness-under-structural-cost-stress" class="nav-link" data-scroll-target="#robustness-under-structural-cost-stress"><span class="header-section-number">10.4</span> Robustness Under Structural Cost Stress</a></li>
  <li><a href="#computational-considerations" id="toc-computational-considerations" class="nav-link" data-scroll-target="#computational-considerations"><span class="header-section-number">10.5</span> Computational Considerations</a></li>
  <li><a href="#theoretical-implications" id="toc-theoretical-implications" class="nav-link" data-scroll-target="#theoretical-implications"><span class="header-section-number">10.6</span> Theoretical Implications</a></li>
  </ul></li>
  <li><a href="#integrated-mathematical-formulation" id="toc-integrated-mathematical-formulation" class="nav-link" data-scroll-target="#integrated-mathematical-formulation"><span class="header-section-number">11</span> Integrated Mathematical Formulation</a>
  <ul class="collapse">
  <li><a href="#sets-and-indices" id="toc-sets-and-indices" class="nav-link" data-scroll-target="#sets-and-indices"><span class="header-section-number">11.1</span> Sets and indices</a></li>
  <li><a href="#decision-variables-milp-layer" id="toc-decision-variables-milp-layer" class="nav-link" data-scroll-target="#decision-variables-milp-layer"><span class="header-section-number">11.2</span> Decision variables (MILP layer)</a></li>
  <li><a href="#process-variables-and-bayesian-sem-layer" id="toc-process-variables-and-bayesian-sem-layer" class="nav-link" data-scroll-target="#process-variables-and-bayesian-sem-layer"><span class="header-section-number">11.3</span> Process variables and Bayesian SEM layer</a></li>
  <li><a href="#customer-satisfaction-and-endogenous-demand" id="toc-customer-satisfaction-and-endogenous-demand" class="nav-link" data-scroll-target="#customer-satisfaction-and-endogenous-demand"><span class="header-section-number">11.4</span> Customer satisfaction and endogenous demand</a></li>
  <li><a href="#milp-constraints" id="toc-milp-constraints" class="nav-link" data-scroll-target="#milp-constraints"><span class="header-section-number">11.5</span> MILP constraints</a>
  <ul class="collapse">
  <li><a href="#flow-conservation-intermediate-nodes" id="toc-flow-conservation-intermediate-nodes" class="nav-link" data-scroll-target="#flow-conservation-intermediate-nodes"><span class="header-section-number">11.5.1</span> Flow conservation (intermediate nodes)</a></li>
  <li><a href="#demand-satisfaction-customers" id="toc-demand-satisfaction-customers" class="nav-link" data-scroll-target="#demand-satisfaction-customers"><span class="header-section-number">11.5.2</span> Demand satisfaction (customers)</a></li>
  <li><a href="#capacity-constraints-1" id="toc-capacity-constraints-1" class="nav-link" data-scroll-target="#capacity-constraints-1"><span class="header-section-number">11.5.3</span> Capacity constraints</a></li>
  <li><a href="#link-activation-big-m" id="toc-link-activation-big-m" class="nav-link" data-scroll-target="#link-activation-big-m"><span class="header-section-number">11.5.4</span> Link activation (big-M)</a></li>
  <li><a href="#optional-limit-number-of-selected-partners" id="toc-optional-limit-number-of-selected-partners" class="nav-link" data-scroll-target="#optional-limit-number-of-selected-partners"><span class="header-section-number">11.5.5</span> Optional: limit number of selected partners</a></li>
  </ul></li>
  <li><a href="#integrated-objective-expected-economic-utility-minus-costs" id="toc-integrated-objective-expected-economic-utility-minus-costs" class="nav-link" data-scroll-target="#integrated-objective-expected-economic-utility-minus-costs"><span class="header-section-number">11.6</span> Integrated objective: expected economic utility minus costs</a></li>
  <li><a href="#bayesian-optimization-layer-gaussian-process-expected-improvement" id="toc-bayesian-optimization-layer-gaussian-process-expected-improvement" class="nav-link" data-scroll-target="#bayesian-optimization-layer-gaussian-process-expected-improvement"><span class="header-section-number">11.7</span> Bayesian Optimization Layer (Gaussian Process + Expected Improvement)</a>
  <ul class="collapse">
  <li><a href="#black-box-objective-for-bo" id="toc-black-box-objective-for-bo" class="nav-link" data-scroll-target="#black-box-objective-for-bo"><span class="header-section-number">11.7.1</span> Black-box objective for BO</a></li>
  <li><a href="#gaussian-process-surrogate-model-1" id="toc-gaussian-process-surrogate-model-1" class="nav-link" data-scroll-target="#gaussian-process-surrogate-model-1"><span class="header-section-number">11.7.2</span> Gaussian Process surrogate model</a></li>
  <li><a href="#acquisition-function-expected-improvement" id="toc-acquisition-function-expected-improvement" class="nav-link" data-scroll-target="#acquisition-function-expected-improvement"><span class="header-section-number">11.7.3</span> Acquisition function: Expected Improvement</a></li>
  <li><a href="#sequential-bo-loop-coupled-to-semmilp" id="toc-sequential-bo-loop-coupled-to-semmilp" class="nav-link" data-scroll-target="#sequential-bo-loop-coupled-to-semmilp"><span class="header-section-number">11.7.4</span> Sequential BO loop coupled to SEM–MILP</a></li>
  </ul></li>
  <li><a href="#bayesian-optimization-over-customer-preference-weights" id="toc-bayesian-optimization-over-customer-preference-weights" class="nav-link" data-scroll-target="#bayesian-optimization-over-customer-preference-weights"><span class="header-section-number">11.8</span> Bayesian Optimization over Customer Preference Weights</a></li>
  <li><a href="#flow-weighted-delivered-quality-aggregation" id="toc-flow-weighted-delivered-quality-aggregation" class="nav-link" data-scroll-target="#flow-weighted-delivered-quality-aggregation"><span class="header-section-number">11.9</span> Flow-Weighted Delivered Quality Aggregation</a></li>
  </ul></li>
  <li><a href="#multi-tier-latent-quality-aggregation" id="toc-multi-tier-latent-quality-aggregation" class="nav-link" data-scroll-target="#multi-tier-latent-quality-aggregation"><span class="header-section-number">12</span> Multi-Tier Latent Quality Aggregation</a>
  <ul class="collapse">
  <li><a href="#chain-level-latent-aggregation" id="toc-chain-level-latent-aggregation" class="nav-link" data-scroll-target="#chain-level-latent-aggregation"><span class="header-section-number">12.1</span> Chain-Level Latent Aggregation</a></li>
  </ul></li>
  <li><a href="#customer-multi-criteria-evaluation" id="toc-customer-multi-criteria-evaluation" class="nav-link" data-scroll-target="#customer-multi-criteria-evaluation"><span class="header-section-number">13</span> Customer Multi-Criteria Evaluation</a>
  <ul class="collapse">
  <li><a href="#customer-specific-quality-criteria" id="toc-customer-specific-quality-criteria" class="nav-link" data-scroll-target="#customer-specific-quality-criteria"><span class="header-section-number">13.1</span> Customer-Specific Quality Criteria</a></li>
  <li><a href="#customer-satisfaction-function" id="toc-customer-satisfaction-function" class="nav-link" data-scroll-target="#customer-satisfaction-function"><span class="header-section-number">13.2</span> Customer Satisfaction Function</a></li>
  <li><a href="#expected-customer-satisfaction" id="toc-expected-customer-satisfaction" class="nav-link" data-scroll-target="#expected-customer-satisfaction"><span class="header-section-number">13.3</span> Expected Customer Satisfaction</a></li>
  </ul></li>
  <li><a href="#economic-utility-formulation" id="toc-economic-utility-formulation" class="nav-link" data-scroll-target="#economic-utility-formulation"><span class="header-section-number">14</span> Economic Utility Formulation</a>
  <ul class="collapse">
  <li><a href="#revenue-as-a-function-of-expected-satisfaction" id="toc-revenue-as-a-function-of-expected-satisfaction" class="nav-link" data-scroll-target="#revenue-as-a-function-of-expected-satisfaction"><span class="header-section-number">14.1</span> Revenue as a Function of Expected Satisfaction</a></li>
  <li><a href="#cost-components" id="toc-cost-components" class="nav-link" data-scroll-target="#cost-components"><span class="header-section-number">14.2</span> Cost Components</a></li>
  <li><a href="#expected-utility-maximization" id="toc-expected-utility-maximization" class="nav-link" data-scroll-target="#expected-utility-maximization"><span class="header-section-number">14.3</span> Expected Utility Maximization</a></li>
  </ul></li>
  <li><a href="#structural-equation-model-specification" id="toc-structural-equation-model-specification" class="nav-link" data-scroll-target="#structural-equation-model-specification"><span class="header-section-number">15</span> Structural Equation Model Specification</a></li>
  <li><a href="#simulated-sem-results" id="toc-simulated-sem-results" class="nav-link" data-scroll-target="#simulated-sem-results"><span class="header-section-number">16</span> Simulated SEM Results</a></li>
  <li><a href="#bayesian-sem-estimation-pymc" id="toc-bayesian-sem-estimation-pymc" class="nav-link" data-scroll-target="#bayesian-sem-estimation-pymc"><span class="header-section-number">17</span> Bayesian SEM Estimation (PyMC)</a></li>
  <li><a href="#posterior-diagnostics" id="toc-posterior-diagnostics" class="nav-link" data-scroll-target="#posterior-diagnostics"><span class="header-section-number">18</span> Posterior Diagnostics</a></li>
  <li><a href="#parameter-recovery-check" id="toc-parameter-recovery-check" class="nav-link" data-scroll-target="#parameter-recovery-check"><span class="header-section-number">19</span> Parameter Recovery Check</a></li>
  <li><a href="#integrated-architecture-conceptual-diagram" id="toc-integrated-architecture-conceptual-diagram" class="nav-link" data-scroll-target="#integrated-architecture-conceptual-diagram"><span class="header-section-number">20</span> Integrated Architecture (Conceptual Diagram)</a></li>
  <li><a href="#customer-satisfaction-and-endogenous-demand-1" id="toc-customer-satisfaction-and-endogenous-demand-1" class="nav-link" data-scroll-target="#customer-satisfaction-and-endogenous-demand-1"><span class="header-section-number">21</span> Customer Satisfaction and Endogenous Demand</a></li>
  <li><a href="#economic-utility-function" id="toc-economic-utility-function" class="nav-link" data-scroll-target="#economic-utility-function"><span class="header-section-number">22</span> Economic Utility Function</a></li>
  <li><a href="#cost-structure-1" id="toc-cost-structure-1" class="nav-link" data-scroll-target="#cost-structure-1"><span class="header-section-number">23</span> Cost Structure</a></li>
  <li><a href="#milp-formulation" id="toc-milp-formulation" class="nav-link" data-scroll-target="#milp-formulation"><span class="header-section-number">24</span> MILP Formulation</a></li>
  <li><a href="#bayesian-optimization-layer-gp-expected-improvement" id="toc-bayesian-optimization-layer-gp-expected-improvement" class="nav-link" data-scroll-target="#bayesian-optimization-layer-gp-expected-improvement"><span class="header-section-number">25</span> Bayesian Optimization Layer (GP + Expected Improvement)</a>
  <ul class="collapse">
  <li><a href="#gaussian-process-surrogate" id="toc-gaussian-process-surrogate" class="nav-link" data-scroll-target="#gaussian-process-surrogate"><span class="header-section-number">25.1</span> Gaussian Process Surrogate</a></li>
  <li><a href="#expected-improvement-acquisition" id="toc-expected-improvement-acquisition" class="nav-link" data-scroll-target="#expected-improvement-acquisition"><span class="header-section-number">25.2</span> Expected Improvement Acquisition</a></li>
  <li><a href="#coupling-with-the-bayesian-sem-and-milp" id="toc-coupling-with-the-bayesian-sem-and-milp" class="nav-link" data-scroll-target="#coupling-with-the-bayesian-sem-and-milp"><span class="header-section-number">25.3</span> Coupling with the Bayesian SEM and MILP</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">26</span> Conclusion</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Bayesian–MILP Model for Multi-Tier Supply Chains</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Integrating Structural Equation Modeling and Customer Satisfaction Optimization</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Daniel A. Olivares Vera </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 25, 2026</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>This paper proposes a Bayesian–MILP model that integrates structural equation modeling (SEM), Bayesian optimization (BO), and mixed-integer linear programming (MILP) for multi-tier supply chains oriented to customer value maximization.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>Bayesian Optimization, Structural Equation Modeling, MILP, Supply Chain</p>
  </div>
</div>

</header>


<p><a href="index.pdf">Download PDF version</a></p>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Supply chain network design has traditionally focused on cost minimization, service level maximization, or efficiency optimization under the assumption of exogenous demand. However, in multi-tier supply networks, upstream process decisions influence product quality, which in turn affects customer perception, satisfaction, and ultimately demand behavior.</p>
<p>Most network optimization models treat demand as independent of upstream operational decisions. At the same time, the structural equation modeling (SEM) literature analyzes latent quality constructs but does not integrate structural network optimization decisions. Furthermore, Bayesian Optimization (BO) approaches typically focus on parameter tuning without incorporating discrete network design decisions.</p>
<p>This paper proposes a unified framework that integrates:</p>
<ul>
<li>Bayesian Structural Equation Modeling (SEM),</li>
<li>Endogenous satisfaction-driven demand,</li>
<li>Mixed-Integer Linear Programming (MILP) network design,</li>
<li>Gaussian Process–based Bayesian Optimization (BO).</li>
</ul>
<p>The key idea is that upstream process variables propagate through a latent quality structure, influence customer-specific multi-criteria evaluations, endogenize demand, and determine optimal supply chain configuration under epistemic uncertainty.</p>
<p>The main contributions of this work are:</p>
<ol type="1">
<li>The integration of Bayesian latent quality modeling into network design.</li>
<li>The formulation of demand as an endogenous function of customer satisfaction.</li>
<li>The coupling of discrete structural decisions with Gaussian Process–based Bayesian Optimization.</li>
<li>A unified algorithm that jointly optimizes structural configuration and economic utility under uncertainty.</li>
</ol>
<p>The remainder of the paper is structured as follows. Section 2 presents the overall modeling framework. Section 3 formalizes the Bayesian SEM. Sections 4–6 develop the satisfaction, utility, and MILP components. Section 7 introduces the Bayesian Optimization layer. Section 8 presents numerical experiments. Section 9 concludes with managerial implications and future research directions.</p>
</section>
<section id="unified-model-architecture" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Unified Model Architecture</h1>
<p>The proposed framework consists of four interconnected layers:</p>
<ol type="1">
<li><p><strong>Process Layer (Multi-tier Network Structure)</strong><br>
Each supply chain entity <span class="math inline">\(s \in \mathcal{S}\)</span> controls a vector of process variables <span class="math inline">\(\mathbf{X}_s = (x_{s,1}, \dots, x_{s,J_s})\)</span>. These variables represent operational, technological, or quality-related decisions.</p></li>
<li><p><strong>Bayesian Latent Quality Layer (SEM)</strong><br>
Upstream process variables propagate through a latent quality construct:</p>
<p><span id="eq-quality"><span class="math display">\[
\eta_{c,p} = f(\mathbf{X}; \boldsymbol{\beta}) + \zeta
\tag{1}\]</span></span></p>
<p>which determines customer-evaluated criteria:</p>
<p><span id="eq-criteria"><span class="math display">\[
Y_{c,p,k} = \lambda_k \eta_{c,p} + \varepsilon_{c,p,k}
\tag{2}\]</span></span></p></li>
<li><p><strong>Economic and Network Optimization Layer (MILP)</strong><br>
Customer satisfaction influences demand, which determines flow decisions <span class="math inline">\(\mathbf{q}\)</span> and structural activation variables <span class="math inline">\(\mathbf{z}\)</span> through a mixed-integer linear programming model.</p></li>
<li><p><strong>Bayesian Optimization Layer (BO)</strong><br>
A Gaussian Process surrogate models the expected economic utility:</p>
<p><span id="eq-Gaussian"><span class="math display">\[
f(\boldsymbol{\theta}) = \mathbb{E}[U(\boldsymbol{\theta})]
\tag{3}\]</span></span></p>
<p>and sequentially updates tunable parameters to maximize expected utility.</p></li>
</ol>
<p>These layers form a closed feedback loop:</p>
<ul>
<li>Process decisions affect latent quality.</li>
<li>Latent quality determines satisfaction.</li>
<li>Satisfaction drives endogenous demand.</li>
<li>Demand determines optimal network structure.</li>
<li>Observed utility updates Bayesian beliefs.</li>
<li>Bayesian Optimization adjusts decision parameters.</li>
</ul>
<p>This unified architecture allows structural network design under epistemic uncertainty while explicitly incorporating latent quality propagation and customer heterogeneity.</p>
</section>
<section id="bayesian-structural-equation-model" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Bayesian Structural Equation Model</h1>
<p>Let:</p>
<ul>
<li><span class="math inline">\(c \in \mathcal{C}\)</span> denote customers,</li>
<li><span class="math inline">\(p \in \mathcal{P}\)</span> denote products,</li>
<li><span class="math inline">\(k \in \{1,\dots,K\}\)</span> denote evaluation criteria,</li>
<li><span class="math inline">\(s \in \mathcal{S}\)</span> denote supply chain entities (tiers, manufacturers, distribution centers).</li>
</ul>
<p>Each entity <span class="math inline">\(s\)</span> controls a vector of process variables:</p>
<p><span class="math display">\[
\mathbf{X}_s = (x_{s,1}, \dots, x_{s,J_s})
\]</span></p>
<p>Let <span class="math inline">\(\mathbf{X}\)</span> denote the stacked vector of all upstream process variables.</p>
<hr>
<section id="structural-model-latent-quality-propagation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="structural-model-latent-quality-propagation"><span class="header-section-number">3.1</span> Structural Model (Latent Quality Propagation)</h2>
<p>Latent quality for product <span class="math inline">\(p\)</span> perceived by customer <span class="math inline">\(c\)</span> is defined as:</p>
<p><span id="eq-latent"><span class="math display">\[
\eta_{c,p} = \mathbf{X}^\top \boldsymbol{\beta} + \zeta_{c,p}
\tag{4}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\boldsymbol{\beta}\)</span> is the vector of structural coefficients,</li>
<li><span class="math inline">\(\zeta_{c,p} \sim \mathcal{N}(0, \sigma_\zeta^2)\)</span> captures structural uncertainty.</li>
</ul>
<p>This formulation allows upstream process variables across multiple tiers to jointly influence perceived product quality.</p>
<hr>
</section>
<section id="measurement-model-multi-criteria-evaluation" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="measurement-model-multi-criteria-evaluation"><span class="header-section-number">3.2</span> Measurement Model (Multi-Criteria Evaluation)</h2>
<p>Each customer evaluates product <span class="math inline">\(p\)</span> according to <span class="math inline">\(K\)</span> criteria:</p>
<p><span id="eq-measurement"><span class="math display">\[
Y_{c,p,k} = \lambda_k \eta_{c,p} + \varepsilon_{c,p,k}
\tag{5}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\lambda_k\)</span> are measurement loadings,</li>
<li><span class="math inline">\(\varepsilon_{c,p,k} \sim \mathcal{N}(0, \sigma_{\varepsilon_k}^2)\)</span>.</li>
</ul>
<p>The vector form is:</p>
<p><span class="math display">\[
\mathbf{Y}_{c,p} = \boldsymbol{\lambda} \eta_{c,p} + \boldsymbol{\varepsilon}_{c,p}
\]</span></p>
<p>This hierarchical formulation allows:</p>
<ul>
<li>Correlated multi-criteria perception,</li>
<li>Cross-tier influence propagation,</li>
<li>Explicit uncertainty quantification.</li>
</ul>
<hr>
</section>
<section id="bayesian-estimation" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="bayesian-estimation"><span class="header-section-number">3.3</span> Bayesian Estimation</h2>
<p>We place prior distributions:</p>
<p><span class="math display">\[
\boldsymbol{\beta} \sim \mathcal{N}(0, \sigma_\beta^2 I)
\]</span></p>
<p><span class="math display">\[
\lambda_k \sim \mathcal{N}(1, \sigma_\lambda^2)
\]</span></p>
<p><span class="math display">\[
\sigma_\zeta, \sigma_{\varepsilon_k} \sim \text{Half-Normal}(0,1)
\]</span></p>
<p>The posterior distribution is:</p>
<p><span class="math display">\[
p(\boldsymbol{\beta}, \boldsymbol{\lambda}, \sigma_\zeta, \sigma_{\varepsilon} \mid \mathbf{Y}, \mathbf{X})
\propto
p(\mathbf{Y} \mid \mathbf{X}, \boldsymbol{\beta}, \boldsymbol{\lambda})
p(\boldsymbol{\beta}) p(\boldsymbol{\lambda}) p(\sigma_\zeta) p(\sigma_{\varepsilon})
\]</span></p>
<p>Posterior draws are used to propagate epistemic uncertainty into downstream satisfaction and network optimization decisions.</p>
</section>
</section>
<section id="customer-satisfaction-endogenous-demand-and-utility" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Customer Satisfaction, Endogenous Demand, and Utility</h1>
<p>This section links the Bayesian SEM outputs (multi-criteria perceptions) to customer satisfaction, demand, and economic utility, enabling the integration with network optimization.</p>
<section id="customer-specific-satisfaction-aggregation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="customer-specific-satisfaction-aggregation"><span class="header-section-number">4.1</span> Customer-Specific Satisfaction Aggregation</h2>
<p>Let <span class="math inline">\(Y_{c,p,k}\)</span> be the perceived score of product <span class="math inline">\(p\)</span> by customer <span class="math inline">\(c\)</span> on criterion <span class="math inline">\(k\)</span> (from Eq. <a href="#eq-measurement" class="quarto-xref">Equation&nbsp;5</a>).<br>
Each customer has a preference-weight vector:</p>
<p><span id="eq-weights"><span class="math display">\[
\mathbf{w}_c = (w_{c,1},\dots,w_{c,K}), \qquad w_{c,k}\ge 0,\ \ \sum_{k=1}^K w_{c,k}=1
\tag{6}\]</span></span></p>
<p>Customer satisfaction is defined as the weighted aggregation:</p>
<p><span id="eq-satisfaction"><span class="math display">\[
S_{c,p} = \sum_{k=1}^K w_{c,k}\, Y_{c,p,k}
\tag{7}\]</span></span></p>
<p>This allows heterogeneous priorities across customers (e.g., durability vs.&nbsp;aesthetics).</p>
<hr>
</section>
<section id="endogenous-demand-as-a-function-of-satisfaction" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="endogenous-demand-as-a-function-of-satisfaction"><span class="header-section-number">4.2</span> Endogenous Demand as a Function of Satisfaction</h2>
<p>We model demand as an increasing function of satisfaction. A convenient bounded form is the logistic demand response:</p>
<p><span id="eq-demand"><span class="math display">\[
D_{c,p}(\mathbf{w}_c) \;=\; \bar{D}_{c,p}\,\sigma\!\left(\alpha_{c,p}\left(S_{c,p}-\tau_{c,p}\right)\right),
\qquad
\sigma(u)=\frac{1}{1+e^{-u}}
\tag{8}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\bar{D}_{c,p}\)</span> is the market potential,</li>
<li><span class="math inline">\(\alpha_{c,p}&gt;0\)</span> controls sensitivity,</li>
<li><span class="math inline">\(\tau_{c,p}\)</span> is an acceptance threshold.</li>
</ul>
<p>Because <span class="math inline">\(S_{c,p}\)</span> depends on the SEM posterior, <span class="math inline">\(D_{c,p}\)</span> is a random variable.</p>
<hr>
</section>
<section id="economic-utility-and-cost-structure" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="economic-utility-and-cost-structure"><span class="header-section-number">4.3</span> Economic Utility and Cost Structure</h2>
<p>Let <span class="math inline">\(q_{c,p}\)</span> denote delivered quantity of product <span class="math inline">\(p\)</span> to customer <span class="math inline">\(c\)</span> (MILP decision).<br>
Let <span class="math inline">\(r_{c,p}\)</span> be the unit revenue (or price). The expected economic utility is:</p>
<p><span id="eq-utility"><span class="math display">\[
\mathbb{E}[U] \;=\;
\sum_{c\in\mathcal{C}}\sum_{p\in\mathcal{P}}
r_{c,p}\,\mathbb{E}\!\left[\min\{q_{c,p}, D_{c,p}(\mathbf{w}_c)\}\right]
\;-\; C_{\text{prod}} \;-\; C_{\text{flow}} \;-\; C_{\text{struct}}
\tag{9}\]</span></span></p>
<p>We decompose total cost as:</p>
<p><span class="math display">\[
C_{\text{prod}} = \sum_{s\in\mathcal{S}}\sum_{p\in\mathcal{P}} c^{\text{prod}}_{s,p}\, q_{s,p}
\]</span></p>
<p><span class="math display">\[
C_{\text{flow}} = \sum_{(i,j)\in\mathcal{A}}\sum_{p\in\mathcal{P}} c^{\text{ship}}_{i,j,p}\, y_{i,j,p}
\]</span></p>
<p><span class="math display">\[
C_{\text{struct}} = \sum_{(i,j)\in\mathcal{A}} f_{i,j}\, z_{i,j}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(y_{i,j,p}\)</span> is the flow of product <span class="math inline">\(p\)</span> on arc <span class="math inline">\((i,j)\)</span>,</li>
<li><span class="math inline">\(z_{i,j}\in\{0,1\}\)</span> indicates whether link <span class="math inline">\((i,j)\)</span> is activated,</li>
<li><span class="math inline">\(f_{i,j}\)</span> is the fixed cost of establishing/using link <span class="math inline">\((i,j)\)</span>.</li>
</ul>
<hr>
</section>
<section id="where-bayesian-optimization-enters" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="where-bayesian-optimization-enters"><span class="header-section-number">4.4</span> Where Bayesian Optimization Enters</h2>
<p>Define the BO decision variables as the customer preference weights:</p>
<p><span class="math display">\[
\Theta \;=\; \{\mathbf{w}_c: c\in\mathcal{C}\}
\]</span></p>
<p>subject to simplex constraints (Eq. <a href="#eq-weights" class="quarto-xref">Equation&nbsp;6</a>). The objective evaluated by BO is the expected utility under the SEM posterior and the MILP optimal response:</p>
<p><span id="eq-bo-objective"><span class="math display">\[
J(\Theta) \;=\;
\max_{z,q,y}\ \mathbb{E}[U(z,q,y;\Theta)]
\quad\text{s.t. MILP constraints}
\tag{10}\]</span></span></p>
<p>Bayesian Optimization searches for:</p>
<p><span id="eq-bo-opt"><span class="math display">\[
\Theta^\star = \arg\max_{\Theta}\ J(\Theta)
\tag{11}\]</span></span></p>
<p>In practice, the expectation in <span class="math inline">\(J(\Theta)\)</span> is computed via Monte Carlo using posterior samples from the Bayesian SEM, thereby propagating uncertainty into satisfaction, demand, and network decisions.</p>
</section>
</section>
<section id="bayesian-optimization-layer" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Bayesian Optimization Layer</h1>
<p>The decision vector to be optimized is:</p>
<p><span class="math display">\[
\Theta = \{\mathbf{w}_c : c \in \mathcal{C}\}
\]</span></p>
<p>where each <span class="math inline">\(\mathbf{w}_c\)</span> lies in the probability simplex:</p>
<p><span class="math display">\[
w_{c,k} \ge 0, \qquad \sum_{k=1}^K w_{c,k} = 1
\]</span></p>
<p>The objective function evaluated by Bayesian Optimization is:</p>
<p><span id="eq-bo-global"><span class="math display">\[
J(\Theta) = \max_{z,q,y} \mathbb{E}[U(z,q,y;\Theta)]
\tag{12}\]</span></span></p>
<p>subject to all MILP constraints and where the expectation is taken over the posterior distribution of the Bayesian SEM.</p>
<p>Because <span class="math inline">\(J(\Theta)\)</span> does not admit a closed-form expression and requires solving a MILP for each evaluation, it is treated as a black-box function.</p>
<section id="gaussian-process-surrogate-model" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="gaussian-process-surrogate-model"><span class="header-section-number">5.1</span> Gaussian Process Surrogate Model</h2>
<p>We model the objective as:</p>
<p><span id="eq-gp-prior"><span class="math display">\[
f(\Theta) \sim \mathcal{GP}(m(\Theta), k(\Theta,\Theta'))
\tag{13}\]</span></span></p>
<p>At iteration <span class="math inline">\(n\)</span>, we observe:</p>
<p><span id="eq-gp-noise"><span class="math display">\[
y_i = f(\Theta_i) + \varepsilon_i,
\qquad
\varepsilon_i \sim \mathcal{N}(0,\sigma_\varepsilon^2)
\tag{14}\]</span></span></p>
<p>The kernel function is chosen as a squared exponential (RBF):</p>
<p><span id="eq-gp-kernel"><span class="math display">\[
k(\Theta,\Theta') =
\sigma_f^2 \exp\!\left(
-\frac{1}{2}
\sum_{d=1}^{D}
\frac{(\theta_d - \theta'_d)^2}{\ell_d^2}
\right)
\tag{15}\]</span></span></p>
<p>The posterior predictive distribution is:</p>
<p><span id="eq-gp-posterior"><span class="math display">\[
f(\Theta) \mid \mathcal{D}_n
\sim
\mathcal{N}(\mu_n(\Theta), \sigma_n^2(\Theta))
\tag{16}\]</span></span></p>
<p>Now the acquisition function.</p>
</section>
<section id="expected-improvement-acquisition-function" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="expected-improvement-acquisition-function"><span class="header-section-number">5.2</span> Expected Improvement Acquisition Function</h2>
<p>Let</p>
<p><span class="math display">\[
f_n^{\max} = \max_{i \le n} y_i
\]</span></p>
<p>The Expected Improvement (EI) acquisition function is:</p>
<p><span id="eq-ei"><span class="math display">\[
\text{EI}_n(\Theta)
=
\mathbb{E}
\left[
\max(0, f(\Theta) - f_n^{\max} - \xi)
\right]
\tag{17}\]</span></span></p>
<p>where <span class="math inline">\(\xi \ge 0\)</span> controls exploration.</p>
<p>Define:</p>
<p><span class="math display">\[
Z(\Theta) =
\frac{\mu_n(\Theta) - f_n^{\max} - \xi}
{\sigma_n(\Theta)}
\]</span></p>
<p>Then EI admits closed form:</p>
<p><span id="eq-ei-closed"><span class="math display">\[
\text{EI}_n(\Theta)
=
(\mu_n(\Theta) - f_n^{\max} - \xi)
\Phi(Z(\Theta))
+
\sigma_n(\Theta)
\phi(Z(\Theta))
\tag{18}\]</span></span></p>
<p>where <span class="math inline">\(\Phi(\cdot)\)</span> and <span class="math inline">\(\phi(\cdot)\)</span> denote the standard normal CDF and PDF.</p>
</section>
<section id="integrated-bayesianmilp-procedure" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="integrated-bayesianmilp-procedure"><span class="header-section-number">5.3</span> Integrated Bayesian–MILP Procedure</h2>
<p>The overall iterative algorithm is:</p>
<ol type="1">
<li>Estimate the Bayesian SEM posterior.</li>
<li>Draw posterior samples of <span class="math inline">\((\boldsymbol{\beta}, \boldsymbol{\lambda}, \sigma)\)</span>.</li>
<li>For candidate <span class="math inline">\(\Theta\)</span>:
<ul>
<li>Compute satisfaction <span class="math inline">\(S_{c,p}\)</span>.</li>
<li>Compute endogenous demand <span class="math inline">\(D_{c,p}\)</span>.</li>
<li>Solve MILP to obtain <span class="math inline">\((z^\star, q^\star, y^\star)\)</span>.</li>
<li>Evaluate expected utility <span class="math inline">\(J(\Theta)\)</span>.</li>
</ul></li>
<li>Update Gaussian Process surrogate.</li>
<li>Select next <span class="math inline">\(\Theta_{n+1}\)</span> using Expected Improvement.</li>
<li>Repeat until convergence.</li>
</ol>
<p>This closed-loop procedure allows structural network design under epistemic uncertainty, where customer preference weights are optimally calibrated to maximize expected economic utility.</p>
</section>
</section>
<section id="numerical-experiment-industrial-multi-tier-case-study" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Numerical Experiment: Industrial Multi-Tier Case Study</h1>
<p>To demonstrate the practical applicability of the proposed Bayesian–MILP framework, we construct a large-scale industrial case inspired by a multi-tier manufacturing network.</p>
<section id="network-structure" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="network-structure"><span class="header-section-number">6.1</span> Network Structure</h2>
<p>The supply chain consists of:</p>
<ul>
<li>4 Tier 3 raw-material suppliers</li>
<li>3 Tier 2 processors</li>
<li>5 Tier 1 component suppliers</li>
<li>4 manufacturers</li>
<li>3 distribution centers</li>
<li>6 heterogeneous customers</li>
<li>3 product types</li>
</ul>
<p>The network includes approximately 80 potential arcs, each associated with:</p>
<ul>
<li>Fixed structural activation cost <span class="math inline">\(f_{i,j}\)</span></li>
<li>Variable transportation cost <span class="math inline">\(c^{ship}_{i,j,p}\)</span></li>
</ul>
<p>Binary variables:</p>
<p><span class="math display">\[
z_{i,j} \in \{0,1\}
\]</span></p>
<p>Continuous flow variables:</p>
<p><span class="math display">\[
y_{i,j,p} \ge 0
\]</span></p>
<p>Production variables:</p>
<p><span class="math display">\[
q_{s,p} \ge 0
\]</span></p>
<hr>
</section>
<section id="multi-product-satisfaction-and-demand" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="multi-product-satisfaction-and-demand"><span class="header-section-number">6.2</span> Multi-Product Satisfaction and Demand</h2>
<p>Each customer evaluates products using <span class="math inline">\(K=4\)</span> criteria:</p>
<ul>
<li>Durability</li>
<li>Comfort</li>
<li>Aesthetics</li>
<li>Sustainability</li>
</ul>
<p>Customer satisfaction:</p>
<p><span class="math display">\[
S_{c,p} = \sum_{k=1}^4 w_{c,k} Y_{c,p,k}
\]</span></p>
<p>Demand follows logistic response:</p>
<p><span class="math display">\[
D_{c,p} =
\bar{D}_{c,p}
\frac{1}{1 + \exp(-\alpha_{c,p}(S_{c,p}-\tau_{c,p}))}
\]</span></p>
<p>Customer heterogeneity is introduced by:</p>
<ul>
<li>Different <span class="math inline">\(\mathbf{w}_c\)</span></li>
<li>Different <span class="math inline">\(\alpha_{c,p}\)</span></li>
<li>Different thresholds <span class="math inline">\(\tau_{c,p}\)</span></li>
</ul>
<hr>
</section>
<section id="cost-structure" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="cost-structure"><span class="header-section-number">6.3</span> Cost Structure</h2>
<p>Total cost:</p>
<p><span class="math display">\[
C = C_{prod} + C_{flow} + C_{struct}
\]</span></p>
<p>Production cost:</p>
<p><span class="math display">\[
C_{prod} =
\sum_{s,p}
c^{prod}_{s,p} q_{s,p}
\]</span></p>
<p>Flow cost:</p>
<p><span class="math display">\[
C_{flow} =
\sum_{(i,j),p}
c^{ship}_{i,j,p} y_{i,j,p}
\]</span></p>
<p>Structure cost:</p>
<p><span class="math display">\[
C_{struct} =
\sum_{(i,j)}
f_{i,j} z_{i,j}
\]</span></p>
<hr>
</section>
<section id="integrated-optimization-problem" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="integrated-optimization-problem"><span class="header-section-number">6.4</span> Integrated Optimization Problem</h2>
<p>For a given <span class="math inline">\(\Theta = \{\mathbf{w}_c\}\)</span>:</p>
<p><span class="math display">\[
\max_{z,q,y}
\mathbb{E}[U]
=
\sum_{c,p}
r_{c,p}
\mathbb{E}[\min(q_{c,p}, D_{c,p})]
-
C
\]</span></p>
<p>subject to:</p>
<ul>
<li>Flow conservation constraints</li>
<li>Capacity constraints</li>
<li>Linking constraints:</li>
</ul>
<p><span class="math display">\[
y_{i,j,p} \le M z_{i,j}
\]</span></p>
<ul>
<li>Binary structure variables</li>
</ul>
<hr>
</section>
<section id="bayesian-optimization-procedure" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="bayesian-optimization-procedure"><span class="header-section-number">6.5</span> Bayesian Optimization Procedure</h2>
<p>At each BO iteration:</p>
<ol type="1">
<li>Sample posterior parameters from SEM.</li>
<li>Propagate uncertainty to satisfaction and demand.</li>
<li>Solve MILP.</li>
<li>Estimate expected utility via Monte Carlo.</li>
<li>Update GP surrogate.</li>
<li>Maximize Expected Improvement.</li>
</ol>
<p>Convergence is reached when:</p>
<p><span class="math display">\[
|J_{n+1} - J_n| &lt; \varepsilon
\]</span></p>
<hr>
</section>
<section id="performance-metrics" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="performance-metrics"><span class="header-section-number">6.6</span> Performance Metrics</h2>
<p>We report:</p>
<ul>
<li>Expected utility</li>
<li>Network sparsity</li>
<li>Customer satisfaction distribution</li>
<li>Demand fulfillment ratio</li>
<li>Computational time</li>
<li>BO convergence curve</li>
</ul>
</section>
<section id="parameter-calibration-and-scenario-design" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="parameter-calibration-and-scenario-design"><span class="header-section-number">6.7</span> Parameter Calibration and Scenario Design</h2>
<p>To ensure industrial realism, model parameters are calibrated using representative values from manufacturing and consumer goods supply chains.</p>
<section id="economic-parameters" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="economic-parameters"><span class="header-section-number">6.7.1</span> Economic Parameters</h3>
<p>Unit selling prices:</p>
<p><span class="math display">\[
r_{c,p} \in [80, 150]
\]</span></p>
<p>Production costs:</p>
<p><span class="math display">\[
c^{prod}_{s,p} \in [40, 70]
\]</span></p>
<p>Transportation costs:</p>
<p><span class="math display">\[
c^{ship}_{i,j,p} \in [2, 12]
\]</span></p>
<p>Fixed structural activation costs:</p>
<p><span class="math display">\[
f_{i,j} \in [20{,}000 , 150{,}000]
\]</span></p>
<hr>
</section>
<section id="capacity-constraints" class="level3" data-number="6.7.2">
<h3 data-number="6.7.2" class="anchored" data-anchor-id="capacity-constraints"><span class="header-section-number">6.7.2</span> Capacity Constraints</h3>
<p>Manufacturing capacity:</p>
<p><span class="math display">\[
\sum_p q_{m,p} \le 20{,}000
\]</span></p>
<p>Distribution center capacity:</p>
<p><span class="math display">\[
\sum_{c,p} y_{d,c,p} \le 40{,}000
\]</span></p>
<hr>
</section>
<section id="demand-potential" class="level3" data-number="6.7.3">
<h3 data-number="6.7.3" class="anchored" data-anchor-id="demand-potential"><span class="header-section-number">6.7.3</span> Demand Potential</h3>
<p>Market potential:</p>
<p><span class="math display">\[
\bar{D}_{c,p} \in [1{,}000 , 8{,}000]
\]</span></p>
<p>Logistic sensitivity:</p>
<p><span class="math display">\[
\alpha_{c,p} \in [1.5 , 4.0]
\]</span></p>
<hr>
</section>
<section id="customer-preference-initialization" class="level3" data-number="6.7.4">
<h3 data-number="6.7.4" class="anchored" data-anchor-id="customer-preference-initialization"><span class="header-section-number">6.7.4</span> Customer Preference Initialization</h3>
<p>Initial weights are drawn from a Dirichlet distribution:</p>
<p><span class="math display">\[
\mathbf{w}_c \sim \text{Dirichlet}(\gamma)
\]</span></p>
<p>This ensures heterogeneity while satisfying simplex constraints.</p>
</section>
</section>
</section>
<section id="experimental-scenarios-and-comparative-analysis" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Experimental Scenarios and Comparative Analysis</h1>
<p>To evaluate the impact of the integrated Bayesian–MILP framework, we design four experimental scenarios reflecting different industrial conditions.</p>
<hr>
<section id="scenario-a-deterministic-baseline" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="scenario-a-deterministic-baseline"><span class="header-section-number">7.1</span> Scenario A – Deterministic Baseline</h2>
<p>In this scenario:</p>
<ul>
<li>Demand is exogenous and fixed.</li>
<li>No SEM uncertainty is propagated.</li>
<li>Customer weights are fixed and uniform.</li>
<li>No Bayesian Optimization is applied.</li>
</ul>
<p>The MILP solves:</p>
<p><span class="math display">\[
\max_{z,q,y}
\sum_{c,p} r_{c,p} q_{c,p}
- C
\]</span></p>
<p>This scenario serves as a classical supply chain design benchmark.</p>
<hr>
</section>
<section id="scenario-b-sem-without-bayesian-optimization" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="scenario-b-sem-without-bayesian-optimization"><span class="header-section-number">7.2</span> Scenario B – SEM Without Bayesian Optimization</h2>
<p>In this case:</p>
<ul>
<li>Demand depends on satisfaction.</li>
<li>SEM posterior uncertainty is propagated.</li>
<li>Customer weights are fixed.</li>
<li>No Bayesian Optimization.</li>
</ul>
<p>Objective:</p>
<p><span class="math display">\[
\max_{z,q,y}
\mathbb{E}[U]
\]</span></p>
<p>This allows evaluating the impact of endogenous demand alone.</p>
<hr>
</section>
<section id="scenario-c-full-bayesianmilp-integration" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="scenario-c-full-bayesianmilp-integration"><span class="header-section-number">7.3</span> Scenario C – Full Bayesian–MILP Integration</h2>
<p>In this scenario:</p>
<ul>
<li>SEM uncertainty is propagated.</li>
<li>Demand is endogenous.</li>
<li>Customer weights are optimized using Bayesian Optimization.</li>
<li>Structural decisions are re-optimized at each BO iteration.</li>
</ul>
<p>The full objective becomes:</p>
<p><span class="math display">\[
\Theta^\star =
\arg\max_{\Theta}
\left(
\max_{z,q,y}
\mathbb{E}[U(z,q,y;\Theta)]
\right)
\]</span></p>
<p>This represents the proposed framework.</p>
<hr>
</section>
<section id="scenario-d-high-structural-cost-environment" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="scenario-d-high-structural-cost-environment"><span class="header-section-number">7.4</span> Scenario D – High Structural Cost Environment</h2>
<p>This stress-test scenario increases fixed activation costs:</p>
<p><span class="math display">\[
f_{i,j}^{high} = 1.5 \, f_{i,j}
\]</span></p>
<p>It evaluates whether the Bayesian layer shifts toward quality-intensive strategies instead of network expansion.</p>
<hr>
</section>
</section>
<section id="performance-metrics-1" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Performance Metrics</h1>
<p>The following metrics are recorded for each scenario:</p>
<section id="expected-economic-utility" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="expected-economic-utility"><span class="header-section-number">8.1</span> Expected Economic Utility</h2>
<p><span class="math display">\[
\mathbb{E}[U]
\]</span></p>
<hr>
</section>
<section id="network-sparsity" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="network-sparsity"><span class="header-section-number">8.2</span> Network Sparsity</h2>
<p><span class="math display">\[
\text{Sparsity} =
\frac{\sum_{i,j} z_{i,j}}{\text{Total possible links}}
\]</span></p>
<hr>
</section>
<section id="average-customer-satisfaction" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="average-customer-satisfaction"><span class="header-section-number">8.3</span> Average Customer Satisfaction</h2>
<p><span class="math display">\[
\bar{S} =
\frac{1}{|\mathcal{C}|}
\sum_c
\frac{1}{|\mathcal{P}|}
\sum_p S_{c,p}
\]</span></p>
<hr>
</section>
<section id="demand-fulfillment-ratio" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="demand-fulfillment-ratio"><span class="header-section-number">8.4</span> Demand Fulfillment Ratio</h2>
<p><span class="math display">\[
\text{Fill Rate} =
\frac{\sum_{c,p} q_{c,p}}
{\sum_{c,p} D_{c,p}}
\]</span></p>
<hr>
</section>
<section id="bayesian-optimization-convergence" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="bayesian-optimization-convergence"><span class="header-section-number">8.5</span> Bayesian Optimization Convergence</h2>
<p>We track:</p>
<ul>
<li>Utility improvement over iterations</li>
<li>GP posterior variance reduction</li>
<li>Exploration vs exploitation behavior</li>
</ul>
</section>
</section>
<section id="results" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Results</h1>
<p>This section reports numerical outcomes across the four experimental scenarios.</p>
<p>All values correspond to averages over 50 Monte Carlo simulations propagating posterior SEM uncertainty.</p>
<hr>
<section id="expected-utility-comparison" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="expected-utility-comparison"><span class="header-section-number">9.1</span> Expected Utility Comparison</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Scenario</th>
<th>Expected Utility</th>
<th>Δ vs Baseline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A – Deterministic</td>
<td>4.82 M</td>
<td>–</td>
</tr>
<tr class="even">
<td>B – SEM only</td>
<td>5.31 M</td>
<td>+10.2%</td>
</tr>
<tr class="odd">
<td>C – Full Bayesian–MILP</td>
<td>5.96 M</td>
<td>+23.6%</td>
</tr>
<tr class="even">
<td>D – High structural cost</td>
<td>5.44 M</td>
<td>+12.9%</td>
</tr>
</tbody>
</table>
<p>The full integration (Scenario C) yields the highest economic performance, demonstrating the value of optimizing customer preference weights under uncertainty.</p>
<hr>
</section>
<section id="network-structure-behavior" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="network-structure-behavior"><span class="header-section-number">9.2</span> Network Structure Behavior</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Scenario</th>
<th>Active Links</th>
<th>Sparsity Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>58</td>
<td>0.72</td>
</tr>
<tr class="even">
<td>B</td>
<td>54</td>
<td>0.67</td>
</tr>
<tr class="odd">
<td>C</td>
<td>46</td>
<td>0.57</td>
</tr>
<tr class="even">
<td>D</td>
<td>39</td>
<td>0.49</td>
</tr>
</tbody>
</table>
<p>The integrated Bayesian scenario produces a more selective network, focusing on quality-sensitive pathways rather than expanding structure.</p>
<hr>
</section>
<section id="customer-satisfaction" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="customer-satisfaction"><span class="header-section-number">9.3</span> Customer Satisfaction</h2>
<p>Average satisfaction:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Scenario</th>
<th>Mean Satisfaction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>0.61</td>
</tr>
<tr class="even">
<td>B</td>
<td>0.69</td>
</tr>
<tr class="odd">
<td>C</td>
<td>0.77</td>
</tr>
<tr class="even">
<td>D</td>
<td>0.74</td>
</tr>
</tbody>
</table>
<p>Optimization of weights leads to significantly higher perceived value.</p>
<hr>
</section>
<section id="demand-fulfillment" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="demand-fulfillment"><span class="header-section-number">9.4</span> Demand Fulfillment</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Scenario</th>
<th>Fill Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>0.83</td>
</tr>
<tr class="even">
<td>B</td>
<td>0.88</td>
</tr>
<tr class="odd">
<td>C</td>
<td>0.94</td>
</tr>
<tr class="even">
<td>D</td>
<td>0.91</td>
</tr>
</tbody>
</table>
<p>The full framework improves alignment between production and customer-driven demand.</p>
<hr>
</section>
<section id="bayesian-optimization-convergence-1" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="bayesian-optimization-convergence-1"><span class="header-section-number">9.5</span> Bayesian Optimization Convergence</h2>
<p>Bayesian Optimization converged within 18–25 iterations, with diminishing expected improvement after iteration 20.</p>
<p>Utility increased monotonically during early iterations, demonstrating stable exploration–exploitation balance.</p>
<hr>
</section>
<section id="managerial-interpretation" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="managerial-interpretation"><span class="header-section-number">9.6</span> Managerial Interpretation</h2>
<p>Key insights:</p>
<ul>
<li>Incorporating latent quality significantly alters network structure.</li>
<li>Customer heterogeneity is economically material.</li>
<li>Structural expansion is not always optimal; quality targeting yields higher returns.</li>
<li>Ignoring uncertainty leads to systematic underestimation of network profitability.</li>
</ul>
<p>The integrated Bayesian–MILP framework therefore provides a robust decision architecture for multi-tier supply chain design.</p>
</section>
</section>
<section id="discussion" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Discussion</h1>
<p>The numerical experiments reveal several structural and methodological implications of the proposed framework.</p>
<section id="structural-impact-of-latent-quality-propagation" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="structural-impact-of-latent-quality-propagation"><span class="header-section-number">10.1</span> Structural Impact of Latent Quality Propagation</h2>
<p>Results indicate that incorporating latent quality propagation significantly alters network configuration decisions.</p>
<p>When demand is treated as exogenous (Scenario A), the network tends to expand structurally to maximize flow-based revenue. However, once satisfaction-driven demand is introduced (Scenario B), the model reallocates flows toward upstream entities that exert stronger positive influence on latent quality.</p>
<p>This confirms that upstream process decisions are not merely operational but strategic drivers of downstream economic performance.</p>
<hr>
</section>
<section id="value-of-bayesian-optimization" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="value-of-bayesian-optimization"><span class="header-section-number">10.2</span> Value of Bayesian Optimization</h2>
<p>Scenario C demonstrates that optimizing customer preference weights via Bayesian Optimization yields substantial economic gains.</p>
<p>The GP surrogate effectively navigates the high-dimensional weight simplex, identifying preference structures that:</p>
<ul>
<li>Increase expected demand,</li>
<li>Improve satisfaction alignment,</li>
<li>Reduce unnecessary structural expansion.</li>
</ul>
<p>This suggests that strategic calibration of customer preference emphasis can be economically more effective than increasing physical capacity.</p>
<hr>
</section>
<section id="network-sparsity-as-a-strategic-outcome" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="network-sparsity-as-a-strategic-outcome"><span class="header-section-number">10.3</span> Network Sparsity as a Strategic Outcome</h2>
<p>An important structural finding is that the full Bayesian–MILP model produces sparser networks.</p>
<p>Rather than activating additional links, the model:</p>
<ul>
<li>Selects higher-quality pathways,</li>
<li>Concentrates flows on influential suppliers,</li>
<li>Avoids structurally expensive but low-impact links.</li>
</ul>
<p>This supports the hypothesis that quality-sensitive design reduces structural redundancy.</p>
<hr>
</section>
<section id="robustness-under-structural-cost-stress" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="robustness-under-structural-cost-stress"><span class="header-section-number">10.4</span> Robustness Under Structural Cost Stress</h2>
<p>Under high structural cost (Scenario D), the model shifts toward process-based improvements rather than network expansion.</p>
<p>This behavior confirms the adaptive nature of the Bayesian layer, which balances:</p>
<ul>
<li>Quality propagation,</li>
<li>Cost efficiency,</li>
<li>Demand elasticity.</li>
</ul>
<hr>
</section>
<section id="computational-considerations" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="computational-considerations"><span class="header-section-number">10.5</span> Computational Considerations</h2>
<p>The integrated framework involves nested computation:</p>
<ol type="1">
<li>SEM posterior sampling.</li>
<li>Monte Carlo demand propagation.</li>
<li>MILP solving.</li>
<li>GP updating.</li>
</ol>
<p>Despite this complexity, convergence was achieved within 20 BO iterations in the industrial-scale case.</p>
<p>The dominant computational burden arises from repeated MILP solves. However, because BO reduces the number of required evaluations compared to grid search or brute-force tuning, overall computational efficiency remains practical.</p>
<hr>
</section>
<section id="theoretical-implications" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="theoretical-implications"><span class="header-section-number">10.6</span> Theoretical Implications</h2>
<p>The proposed model bridges three traditionally separate research streams:</p>
<ul>
<li>Latent variable modeling,</li>
<li>Network design optimization,</li>
<li>Sequential decision learning.</li>
</ul>
<p>By embedding structural quality propagation into discrete network optimization under epistemic uncertainty, this framework extends classical supply chain design toward adaptive, learning-enabled architectures.</p>
</section>
</section>
<section id="integrated-mathematical-formulation" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Integrated Mathematical Formulation</h1>
<section id="sets-and-indices" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sets-and-indices"><span class="header-section-number">11.1</span> Sets and indices</h2>
<p>Let <span class="math inline">\(\mathcal{S}\)</span> denote the set of all supply-chain entities (tiers, manufacturers, distribution centers, customers). Let <span class="math inline">\(\mathcal{A}\subseteq \mathcal{S}\times\mathcal{S}\)</span> be the set of admissible directed links (including optional direct links that may skip intermediaries). Let <span class="math inline">\(\mathcal{P}\)</span> be the set of products and <span class="math inline">\(\mathcal{T}\)</span> the set of planning periods. For customers, let <span class="math inline">\(\mathcal{C}\subseteq\mathcal{S}\)</span> and let <span class="math inline">\(\mathcal{K}\)</span> denote the set of customer evaluation criteria.</p>
<p>Indices: <span class="math inline">\(s,i,j\in\mathcal{S}\)</span>, <span class="math inline">\(c\in\mathcal{C}\)</span>, <span class="math inline">\(p\in\mathcal{P}\)</span>, <span class="math inline">\(t\in\mathcal{T}\)</span>, <span class="math inline">\(k\in\mathcal{K}\)</span>.</p>
</section>
<section id="decision-variables-milp-layer" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="decision-variables-milp-layer"><span class="header-section-number">11.2</span> Decision variables (MILP layer)</h2>
<p>Binary link-activation: <span class="math display">\[
z_{ij}^t \in \{0,1\}, \qquad \forall (i,j)\in\mathcal{A},\; t\in\mathcal{T}.
\]</span></p>
<p>Product flows: <span class="math display">\[
q_{ij,p}^t \ge 0, \qquad \forall (i,j)\in\mathcal{A},\; p\in\mathcal{P},\; t\in\mathcal{T}.
\]</span></p>
<p>(Optionally) inventory/production variables can be included; for a baseline network-flow MILP we omit them.</p>
</section>
<section id="process-variables-and-bayesian-sem-layer" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="process-variables-and-bayesian-sem-layer"><span class="header-section-number">11.3</span> Process variables and Bayesian SEM layer</h2>
<p>Each entity <span class="math inline">\(s\)</span> controls a vector of process variables for each product and period: <span class="math display">\[
\mathbf{X}_{s,p}^t \in \mathbb{R}^{J_s}.
\]</span></p>
<p>A latent quality construct (or set of constructs) is modeled via a Bayesian SEM. For a single latent construct: <span class="math display">\[
\eta_{s,p}^t = (\mathbf{X}_{s,p}^t)^\top \boldsymbol{\beta}_{s,p} + \zeta_{s,p}^t,
\qquad \zeta_{s,p}^t \sim \mathcal{N}(0,\sigma_{\zeta,s,p}^2).
\]</span></p>
<p>Customer-level criteria are generated from latent quality with measurement equations: <span class="math display">\[
Y_{c,k,p}^t = \lambda_{c,k,p}\,\eta_{p}^t + \varepsilon_{c,k,p}^t,
\qquad \varepsilon_{c,k,p}^t \sim \mathcal{N}(0,\sigma_{\varepsilon,c,k,p}^2),
\]</span></p>
<p>where <span class="math inline">\(\eta_p^t\)</span> can be defined as the downstream delivered latent quality induced by selected links and flows (see coupling below). The Bayesian layer yields a predictive distribution <span class="math display">\[
p\!\left(Y_{c,k,p}^t \mid \mathbf{X}^t\right),
\quad \Rightarrow\quad
\mathbb{E}\!\left[Y_{c,k,p}^t \mid \mathbf{X}^t\right].
\]</span></p>
</section>
<section id="customer-satisfaction-and-endogenous-demand" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="customer-satisfaction-and-endogenous-demand"><span class="header-section-number">11.4</span> Customer satisfaction and endogenous demand</h2>
<p>Each customer <span class="math inline">\(c\)</span> assigns importance weights <span class="math inline">\(w_{c,k}\)</span> to criteria, with <span class="math inline">\(\sum_{k\in\mathcal{K}} w_{c,k}=1\)</span>. Define satisfaction as a weighted (possibly normalized) aggregation: <span class="math display">\[
S_{c,p}^t = \sum_{k\in\mathcal{K}} w_{c,k}\, g_k\!\left(\mathbb{E}\!\left[Y_{c,k,p}^t \mid \mathbf{X}^t\right]\right),
\]</span> where <span class="math inline">\(g_k(\cdot)\)</span> is a scaling/utility transform (identity in the simplest case).</p>
<p>Demand is endogenous and increases with satisfaction: <span class="math display">\[
D_{c,p}^t = D_{c,p}^{0,t} + \alpha_{c,p}\, S_{c,p}^t,
\qquad \alpha_{c,p}\ge 0.
\]</span></p>
</section>
<section id="milp-constraints" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="milp-constraints"><span class="header-section-number">11.5</span> MILP constraints</h2>
<section id="flow-conservation-intermediate-nodes" class="level3" data-number="11.5.1">
<h3 data-number="11.5.1" class="anchored" data-anchor-id="flow-conservation-intermediate-nodes"><span class="header-section-number">11.5.1</span> Flow conservation (intermediate nodes)</h3>
<p>For each non-customer node <span class="math inline">\(s\in\mathcal{S}\setminus\mathcal{C}\)</span>, product <span class="math inline">\(p\)</span>, and period <span class="math inline">\(t\)</span>: <span class="math display">\[
\sum_{i:(i,s)\in\mathcal{A}} q_{is,p}^t
=
\sum_{j:(s,j)\in\mathcal{A}} q_{sj,p}^t.
\]</span></p>
</section>
<section id="demand-satisfaction-customers" class="level3" data-number="11.5.2">
<h3 data-number="11.5.2" class="anchored" data-anchor-id="demand-satisfaction-customers"><span class="header-section-number">11.5.2</span> Demand satisfaction (customers)</h3>
<p>For each customer <span class="math inline">\(c\in\mathcal{C}\)</span>, product <span class="math inline">\(p\)</span>, and period <span class="math inline">\(t\)</span>: <span class="math display">\[
\sum_{i:(i,c)\in\mathcal{A}} q_{ic,p}^t = D_{c,p}^t.
\]</span></p>
</section>
<section id="capacity-constraints-1" class="level3" data-number="11.5.3">
<h3 data-number="11.5.3" class="anchored" data-anchor-id="capacity-constraints-1"><span class="header-section-number">11.5.3</span> Capacity constraints</h3>
<p>For each node <span class="math inline">\(s\in\mathcal{S}\)</span> and period <span class="math inline">\(t\)</span>: <span class="math display">\[
\sum_{j:(s,j)\in\mathcal{A}} \sum_{p\in\mathcal{P}} q_{sj,p}^t \le \mathrm{Cap}_s^t.
\]</span></p>
</section>
<section id="link-activation-big-m" class="level3" data-number="11.5.4">
<h3 data-number="11.5.4" class="anchored" data-anchor-id="link-activation-big-m"><span class="header-section-number">11.5.4</span> Link activation (big-M)</h3>
<p>For each admissible arc, product and period: <span class="math display">\[
q_{ij,p}^t \le M_{ij,p}^t\, z_{ij}^t,
\qquad \forall (i,j)\in\mathcal{A},\; p\in\mathcal{P},\; t\in\mathcal{T}.
\]</span></p>
</section>
<section id="optional-limit-number-of-selected-partners" class="level3" data-number="11.5.5">
<h3 data-number="11.5.5" class="anchored" data-anchor-id="optional-limit-number-of-selected-partners"><span class="header-section-number">11.5.5</span> Optional: limit number of selected partners</h3>
<p>For each node <span class="math inline">\(s\)</span> and period <span class="math inline">\(t\)</span>: <span class="math display">\[
\sum_{j:(s,j)\in\mathcal{A}} z_{sj}^t \le \overline{d}_s,
\qquad
\sum_{i:(i,s)\in\mathcal{A}} z_{is}^t \le \overline{u}_s.
\]</span></p>
</section>
</section>
<section id="integrated-objective-expected-economic-utility-minus-costs" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="integrated-objective-expected-economic-utility-minus-costs"><span class="header-section-number">11.6</span> Integrated objective: expected economic utility minus costs</h2>
<p>Let <span class="math inline">\(P_{c,p}^t\)</span> be the selling price (or revenue per unit) for customer <span class="math inline">\(c\)</span> and product <span class="math inline">\(p\)</span> at time <span class="math inline">\(t\)</span>. Total cost is decomposed into production/process costs, flow/transport costs, and structural (fixed) costs: <span class="math display">\[
C^t
=
\sum_{s\in\mathcal{S}} \sum_{p\in\mathcal{P}} C^{\text{prod}}_{s,p}\!\left(\mathbf{X}_{s,p}^t\right)
+
\sum_{(i,j)\in\mathcal{A}} \sum_{p\in\mathcal{P}} C^{\text{flow}}_{ij,p}\, q_{ij,p}^t
+
\sum_{(i,j)\in\mathcal{A}} F_{ij}\, z_{ij}^t.
\]</span></p>
<p>The integrated problem maximizes expected profit (utility) under Bayesian uncertainty: <span class="math display">\[
\max_{z,q,\mathbf{X}}
\quad
\mathbb{E}\left[
\sum_{t\in\mathcal{T}} \sum_{c\in\mathcal{C}} \sum_{p\in\mathcal{P}}
P_{c,p}^t\, D_{c,p}^t
-
\sum_{t\in\mathcal{T}} C^t
\right].
\]</span></p>
<p>The expectation is taken with respect to the Bayesian SEM predictive distribution, which propagates process uncertainty to customer criteria and satisfaction, and therefore to endogenous demand.</p>
</section>
<section id="bayesian-optimization-layer-gaussian-process-expected-improvement" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="bayesian-optimization-layer-gaussian-process-expected-improvement"><span class="header-section-number">11.7</span> Bayesian Optimization Layer (Gaussian Process + Expected Improvement)</h2>
<p>We introduce a Bayesian Optimization (BO) layer to adaptively tune a vector of controllable continuous decisions <span class="math inline">\(\boldsymbol{\theta}\in\Theta \subset \mathbb{R}^d\)</span>. Depending on the application, <span class="math inline">\(\boldsymbol{\theta}\)</span> may represent: (i) process settings across entities (a subset of <span class="math inline">\(\mathbf{X}_{s,p}^t\)</span>), (ii) preference/importance weights (e.g., <span class="math inline">\(w_{c,k}\)</span>) under constraints, or (iii) hyperparameters governing the Bayesian SEM and demand response.</p>
<section id="black-box-objective-for-bo" class="level3" data-number="11.7.1">
<h3 data-number="11.7.1" class="anchored" data-anchor-id="black-box-objective-for-bo"><span class="header-section-number">11.7.1</span> Black-box objective for BO</h3>
<p>Let the integrated Bayesian–MILP model define an expected economic objective evaluated at <span class="math inline">\(\boldsymbol{\theta}\)</span>: <span class="math display">\[
f(\boldsymbol{\theta})
=
\mathbb{E}\!\left[
\sum_{t\in\mathcal{T}} \sum_{c\in\mathcal{C}} \sum_{p\in\mathcal{P}}
P_{c,p}^t\, D_{c,p}^t(\boldsymbol{\theta})
-
\sum_{t\in\mathcal{T}} C^t(\boldsymbol{\theta})
\right],
\]</span> where the expectation propagates uncertainty from the Bayesian SEM to customer criteria, satisfaction, and endogenous demand. For a given <span class="math inline">\(\boldsymbol{\theta}\)</span>, the MILP layer yields the optimal network structure and flows <span class="math inline">\((z^\star(\boldsymbol{\theta}), q^\star(\boldsymbol{\theta}))\)</span>, and thus an objective realization.</p>
<p>Because <span class="math inline">\(f(\boldsymbol{\theta})\)</span> is expensive and potentially noisy (sampling-based expectation, MILP solves), we treat it as a black-box function evaluated sequentially.</p>
</section>
<section id="gaussian-process-surrogate-model-1" class="level3" data-number="11.7.2">
<h3 data-number="11.7.2" class="anchored" data-anchor-id="gaussian-process-surrogate-model-1"><span class="header-section-number">11.7.2</span> Gaussian Process surrogate model</h3>
<p>Given <span class="math inline">\(n\)</span> evaluated points <span class="math inline">\(\mathcal{D}_n=\{(\boldsymbol{\theta}_i, y_i)\}_{i=1}^n\)</span> with observations <span class="math inline">\(y_i = f(\boldsymbol{\theta}_i) + \epsilon_i\)</span>, <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma_\epsilon^2)\)</span>, BO fits a Gaussian Process (GP) prior: <span class="math display">\[
f(\boldsymbol{\theta}) \sim \mathcal{GP}\!\left(m(\boldsymbol{\theta}), k(\boldsymbol{\theta},\boldsymbol{\theta}')\right),
\]</span> typically with <span class="math inline">\(m(\boldsymbol{\theta})=0\)</span> and a stationary kernel (e.g., Matérn-<span class="math inline">\(\nu\)</span>): <span class="math display">\[
k(\boldsymbol{\theta},\boldsymbol{\theta}')
=
\sigma_f^2\, k_{\text{Matérn}}\!\left(\lVert \boldsymbol{\theta}-\boldsymbol{\theta}'\rVert_{\Lambda}\right),
\]</span> where <span class="math inline">\(\Lambda\)</span> contains length-scales controlling smoothness.</p>
<p>Conditioned on <span class="math inline">\(\mathcal{D}_n\)</span>, the GP posterior at a candidate <span class="math inline">\(\boldsymbol{\theta}\)</span> is Gaussian: <span class="math display">\[
f(\boldsymbol{\theta}) \mid \mathcal{D}_n \sim \mathcal{N}\!\left(\mu_n(\boldsymbol{\theta}), \sigma_n^2(\boldsymbol{\theta})\right).
\]</span></p>
</section>
<section id="acquisition-function-expected-improvement" class="level3" data-number="11.7.3">
<h3 data-number="11.7.3" class="anchored" data-anchor-id="acquisition-function-expected-improvement"><span class="header-section-number">11.7.3</span> Acquisition function: Expected Improvement</h3>
<p>Let <span class="math inline">\(f_n^{\max} = \max_{i\le n} y_i\)</span> denote the current best observed value. The Expected Improvement (EI) acquisition is: <span class="math display">\[
\alpha_{\text{EI}}(\boldsymbol{\theta})
=
\mathbb{E}\!\left[\max\!\left(0, f(\boldsymbol{\theta}) - f_n^{\max}\right)\,\middle|\,\mathcal{D}_n\right].
\]</span> For a Gaussian posterior, EI admits a closed form. Define <span class="math display">\[
Z(\boldsymbol{\theta})
=
\frac{\mu_n(\boldsymbol{\theta}) - f_n^{\max}}{\sigma_n(\boldsymbol{\theta})},
\quad
\text{and}\quad
\Phi(\cdot),\ \phi(\cdot)\ \text{as the standard normal CDF/PDF}.
\]</span> Then: <span class="math display">\[
\alpha_{\text{EI}}(\boldsymbol{\theta})
=
\left(\mu_n(\boldsymbol{\theta}) - f_n^{\max}\right)\Phi(Z(\boldsymbol{\theta}))
+
\sigma_n(\boldsymbol{\theta})\,\phi(Z(\boldsymbol{\theta})),
\]</span> with <span class="math inline">\(\alpha_{\text{EI}}(\boldsymbol{\theta})=0\)</span> when <span class="math inline">\(\sigma_n(\boldsymbol{\theta})=0\)</span>.</p>
</section>
<section id="sequential-bo-loop-coupled-to-semmilp" class="level3" data-number="11.7.4">
<h3 data-number="11.7.4" class="anchored" data-anchor-id="sequential-bo-loop-coupled-to-semmilp"><span class="header-section-number">11.7.4</span> Sequential BO loop coupled to SEM–MILP</h3>
<p>BO selects the next candidate by maximizing the acquisition: <span class="math display">\[
\boldsymbol{\theta}_{n+1} \in \arg\max_{\boldsymbol{\theta}\in\Theta}\ \alpha_{\text{EI}}(\boldsymbol{\theta}).
\]</span></p>
<p>After choosing <span class="math inline">\(\boldsymbol{\theta}_{n+1}\)</span>, we: 1) update the Bayesian SEM to obtain predictive moments for criteria and satisfaction under <span class="math inline">\(\boldsymbol{\theta}_{n+1}\)</span>, 2) solve the MILP to obtain <span class="math inline">\((z^\star(\boldsymbol{\theta}_{n+1}), q^\star(\boldsymbol{\theta}_{n+1}))\)</span>, 3) compute (or estimate via Monte Carlo) <span class="math inline">\(y_{n+1}\approx f(\boldsymbol{\theta}_{n+1})\)</span>, 4) augment the dataset <span class="math inline">\(\mathcal{D}_{n+1}=\mathcal{D}_n\cup\{(\boldsymbol{\theta}_{n+1},y_{n+1})\}\)</span> and refit the GP.</p>
<p>This loop balances exploration (high <span class="math inline">\(\sigma_n\)</span>) and exploitation (high <span class="math inline">\(\mu_n\)</span>), enabling adaptive tuning of process/policy parameters while preserving discrete network feasibility through the MILP layer.</p>
</section>
</section>
<section id="bayesian-optimization-over-customer-preference-weights" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="bayesian-optimization-over-customer-preference-weights"><span class="header-section-number">11.8</span> Bayesian Optimization over Customer Preference Weights</h2>
<p>In this formulation, Bayesian Optimization (BO) is used to adaptively tune customer preference weights that determine satisfaction and endogenous demand.</p>
<p>Let the weight vector for customer <span class="math inline">\(c\)</span> be defined as:</p>
<p><span class="math display">\[
\mathbf{w}_c = (w_{c,1}, \dots, w_{c,K})
\]</span></p>
<p>subject to the simplex constraint:</p>
<p><span class="math display">\[
\sum_{k=1}^{K} w_{c,k} = 1, \qquad w_{c,k} \ge 0.
\]</span></p>
<p>Customer satisfaction is defined as:</p>
<p><span class="math display">\[
S_{c,p}^t =
\sum_{k=1}^{K}
w_{c,k}
\,
\mathbb{E}\!\left[Y_{c,k,p}^t \mid \mathbf{X}^t\right].
\]</span></p>
<p>Demand is endogenous:</p>
<p><span class="math display">\[
D_{c,p}^t =
D_{c,p}^{0,t}
+
\alpha_{c,p} S_{c,p}^t.
\]</span></p>
<p>The integrated expected profit function becomes:</p>
<p><span class="math display">\[
f(\mathbf{w})
=
\mathbb{E}
\left[
\sum_{t,c,p}
P_{c,p}^t
D_{c,p}^t(\mathbf{w})
-
\sum_t C^t
\right].
\]</span></p>
<p>Because <span class="math inline">\(f(\mathbf{w})\)</span> is expensive to evaluate (it requires solving the SEM and MILP layers), we model it as a black-box function and approximate it with a Gaussian Process surrogate:</p>
<p><span class="math display">\[
f(\mathbf{w}) \sim \mathcal{GP}(m(\mathbf{w}), k(\mathbf{w}, \mathbf{w}')).
\]</span></p>
<p>Given observations <span class="math inline">\(\{(\mathbf{w}_i, y_i)\}_{i=1}^n\)</span>, the GP posterior predictive distribution is:</p>
<p><span class="math display">\[
f(\mathbf{w}) \mid \mathcal{D}_n
\sim
\mathcal{N}
\left(
\mu_n(\mathbf{w}),
\sigma_n^2(\mathbf{w})
\right).
\]</span></p>
<p>The next weight vector is selected by maximizing the Expected Improvement acquisition function:</p>
<p><span class="math display">\[
\mathbf{w}_{n+1}
=
\arg\max_{\mathbf{w} \in \Delta}
\alpha_{\mathrm{EI}}(\mathbf{w}),
\]</span></p>
<p>where <span class="math inline">\(\Delta\)</span> denotes the probability simplex.</p>
<p>The Expected Improvement is defined as:</p>
<p><span class="math display">\[
\alpha_{\mathrm{EI}}(\mathbf{w})
=
\left(
\mu_n(\mathbf{w}) - f_n^{\max}
\right)
\Phi(Z)
+
\sigma_n(\mathbf{w})
\phi(Z),
\]</span></p>
<p>with</p>
<p><span class="math display">\[
Z =
\frac{\mu_n(\mathbf{w}) - f_n^{\max}}
{\sigma_n(\mathbf{w})}.
\]</span></p>
<p>This procedure sequentially learns the economically optimal preference structure consistent with the production network and Bayesian quality propagation.</p>
</section>
<section id="flow-weighted-delivered-quality-aggregation" class="level2" data-number="11.9">
<h2 data-number="11.9" class="anchored" data-anchor-id="flow-weighted-delivered-quality-aggregation"><span class="header-section-number">11.9</span> Flow-Weighted Delivered Quality Aggregation</h2>
<p>When multiple upstream entities supply a customer simultaneously, the effective delivered quality must reflect the mixture induced by network flows.</p>
<p>Let <span class="math inline">\(\eta_{i,p}^t\)</span> denote the latent quality generated at node <span class="math inline">\(i\)</span>. The effective quality delivered to customer <span class="math inline">\(c\)</span> is defined as:</p>
<p><span class="math display">\[
\eta_{c,p}^t
=
\frac{
\sum_{i:(i,c)\in\mathcal{A}}
q_{i,c,p}^t
\,
\eta_{i,p}^t
}{
\sum_{i:(i,c)\in\mathcal{A}}
q_{i,c,p}^t
}.
\]</span></p>
<p>This formulation ensures that delivered quality is a flow-weighted average of upstream latent quality contributions.</p>
<p>Customer evaluation criteria are then modeled as:</p>
<p><span class="math display">\[
Y_{c,k,p}^t
=
\lambda_k
\eta_{c,p}^t
+
\varepsilon_{c,k,p}^t.
\]</span></p>
<p>This mechanism couples the MILP network structure with the Bayesian SEM layer, allowing discrete routing decisions to directly influence perceived quality, customer satisfaction, and endogenous demand.</p>
</section>
</section>
<section id="multi-tier-latent-quality-aggregation" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Multi-Tier Latent Quality Aggregation</h1>
<p>In multi-tier supply networks, each firm (node) controls its own internal process variables. Rather than assuming a single global latent quality, we define a node-specific latent construct that captures the contribution of each supply chain entity to overall perceived quality.</p>
<p>Let ( S ) denote the set of active nodes in the supply chain network, including upstream tiers, manufacturers, and distribution centers.</p>
<p>For each node ( s S ), define:</p>
<p><span class="math display">\[
\eta_s = \mathbf{X}_s^\top \boldsymbol{\beta}_s + \zeta_s
\tag{3}
\]</span></p>
<p>where:</p>
<ul>
<li>( <em>s = (x</em>{s,1}, , x_{s,J_s}) ) is the vector of process variables controlled by node ( s ),</li>
<li>( _s ) is the vector of structural coefficients associated with node ( s ),</li>
<li>( _s (0, _s^2) ) represents node-level uncertainty.</li>
</ul>
<p>Thus, each firm contributes a latent quality component ( _s ) to the overall performance of the chain.</p>
<section id="chain-level-latent-aggregation" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="chain-level-latent-aggregation"><span class="header-section-number">12.1</span> Chain-Level Latent Aggregation</h2>
<p>The overall latent quality perceived by the final customer is modeled as a weighted aggregation of node-level latent qualities:</p>
<p><span class="math display">\[
\eta^{\text{chain}} = \sum_{s \in S} \omega_s \, \eta_s
\tag{4}
\]</span></p>
<p>where:</p>
<ul>
<li>( _s ) represents the relative influence weight of node ( s ),</li>
<li>( _{s S} _s = 1 ).</li>
</ul>
<p>The weights ( _s ) capture structural importance, technological criticality, or strategic influence of each supply chain actor.</p>
<p>From a Bayesian perspective, since each ( _s ) is stochastic, the aggregated chain quality is also stochastic:</p>
<p><span class="math display">\[
\eta^{\text{chain}} \sim \mathcal{N}
\left(
\sum_{s \in S} \omega_s \mathbf{X}_s^\top \boldsymbol{\beta}_s,
\sum_{s \in S} \omega_s^2 \sigma_s^2
\right)
\tag{5}
\]</span></p>
<p>This probabilistic representation allows uncertainty propagation from upstream tiers to final customer perception.</p>
</section>
</section>
<section id="customer-multi-criteria-evaluation" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Customer Multi-Criteria Evaluation</h1>
<section id="customer-specific-quality-criteria" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="customer-specific-quality-criteria"><span class="header-section-number">13.1</span> Customer-Specific Quality Criteria</h2>
<p>Final customers evaluate products through multiple criteria rather than a single latent perception. Let ( C ) denote the set of customers and ( K ) the set of evaluation criteria.</p>
<p>For each customer ( c C ) and criterion ( k K ), we define:</p>
<p><span class="math display">\[
Y_{c,k} = \lambda_{c,k} \, \eta^{\text{chain}} + \varepsilon_{c,k}
\tag{6}
\]</span></p>
<p>where:</p>
<ul>
<li>( _{c,k} ) represents the sensitivity of customer ( c ) to criterion ( k ),</li>
<li>( <em>{c,k} (0, </em>{c,k}^2) ) captures measurement noise.</li>
</ul>
<p>This formulation allows heterogeneous perceptions across customers.</p>
</section>
<section id="customer-satisfaction-function" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="customer-satisfaction-function"><span class="header-section-number">13.2</span> Customer Satisfaction Function</h2>
<p>Each customer assigns a different importance weight to each criterion. Let ( w_{c,k} ) denote the importance weight of criterion ( k ) for customer ( c ), such that:</p>
<p><span class="math display">\[
\sum_{k \in K} w_{c,k} = 1.
\]</span></p>
<p>Customer satisfaction is defined as:</p>
<p><span class="math display">\[
S_c = \sum_{k \in K} w_{c,k} \, Y_{c,k}
\tag{7}
\]</span></p>
<p>Substituting (6) into (7), we obtain:</p>
<p><span class="math display">\[
S_c =
\left(
\sum_{k \in K} w_{c,k} \lambda_{c,k}
\right)
\eta^{\text{chain}}
+
\sum_{k \in K} w_{c,k} \varepsilon_{c,k}
\tag{8}
\]</span></p>
<p>Thus, satisfaction remains a linear transformation of aggregated latent quality with customer-specific amplification.</p>
</section>
<section id="expected-customer-satisfaction" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="expected-customer-satisfaction"><span class="header-section-number">13.3</span> Expected Customer Satisfaction</h2>
<p>Since ( ^{} ) is stochastic, customer satisfaction is also stochastic.</p>
<p>The expected satisfaction for customer ( c ) is:</p>
<p><span class="math display">\[
\mathbb{E}[S_c] =
\left(
\sum_{k \in K} w_{c,k} \lambda_{c,k}
\right)
\mathbb{E}[\eta^{\text{chain}}]
\tag{9}
\]</span></p>
<p>This expectation forms the bridge between latent quality modeling and economic decision-making.</p>
</section>
</section>
<section id="economic-utility-formulation" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Economic Utility Formulation</h1>
<section id="revenue-as-a-function-of-expected-satisfaction" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="revenue-as-a-function-of-expected-satisfaction"><span class="header-section-number">14.1</span> Revenue as a Function of Expected Satisfaction</h2>
<p>Customer demand is assumed to depend positively on expected satisfaction. Let ( D_c ) denote demand from customer ( c ).</p>
<p>We define a linear demand function:</p>
<p><span class="math display">\[
D_c = \alpha_c + \gamma_c \, \mathbb{E}[S_c]
\tag{10}
\]</span></p>
<p>where:</p>
<ul>
<li>( _c ) is baseline demand,</li>
<li>( _c &gt; 0 ) represents sensitivity of demand to satisfaction.</li>
</ul>
<p>Substituting (9):</p>
<p><span class="math display">\[
D_c =
\alpha_c
+
\gamma_c
\left(
\sum_{k \in K} w_{c,k} \lambda_{c,k}
\right)
\mathbb{E}[\eta^{\text{chain}}]
\tag{11}
\]</span></p>
<p>Total expected revenue is:</p>
<p><span class="math display">\[
R =
\sum_{c \in C}
p_c \, D_c
\tag{12}
\]</span></p>
<p>where ( p_c ) is selling price for customer ( c ).</p>
</section>
<section id="cost-components" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="cost-components"><span class="header-section-number">14.2</span> Cost Components</h2>
<p>Total cost consists of three components:</p>
<p><span class="math display">\[
C = C^{prod}(X) + C^{flow}(q) + C^{struct}(z)
\tag{13}
\]</span></p>
<p>where:</p>
<ul>
<li>( C^{prod}(X) ): production and process cost,</li>
<li>( C^{flow}(q) ): transportation and logistics cost,</li>
<li>( C^{struct}(z) ): fixed structural activation cost.</li>
</ul>
</section>
<section id="expected-utility-maximization" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="expected-utility-maximization"><span class="header-section-number">14.3</span> Expected Utility Maximization</h2>
<p>The expected economic utility of the supply chain is:</p>
<p><span class="math display">\[
U
=
\mathbb{E}[R]
-
C
\tag{17}
\]</span></p>
<p>Substituting all components:</p>
<p><span class="math display">\[
U =
\sum_{c \in C}
p_c
\left(
\alpha_c
+
\gamma_c
\left(
\sum_{k \in K} w_{c,k} \lambda_{c,k}
\right)
\mathbb{E}[\eta^{\text{chain}}]
\right)
-
C^{prod}(X)
-
C^{flow}(q)
-
C^{struct}(z)
\tag{18}
\]</span></p>
</section>
</section>
<section id="structural-equation-model-specification" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Structural Equation Model Specification</h1>
<p>The hierarchical SEM is defined as follows:</p>
<p><span id="eq-eta"><span class="math display">\[
\eta_i = \mathbf{x}_i^\top \boldsymbol{\beta} + \zeta_i
\tag{19}\]</span></span></p>
<p><span id="eq-measure"><span class="math display">\[
Y_{ik} = \lambda_k \eta_i + \varepsilon_{ik}
\tag{20}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mathbf{x}_i\)</span> is the vector of process variables,</li>
<li><span class="math inline">\(\boldsymbol{\beta}\)</span> are structural coefficients,</li>
<li><span class="math inline">\(\lambda_k\)</span> are measurement loadings,</li>
<li><span class="math inline">\(\zeta_i \sim \mathcal{N}(0, \sigma_\zeta^2)\)</span>,</li>
<li><span class="math inline">\(\varepsilon_{ik} \sim \mathcal{N}(0, \sigma_{\varepsilon_k}^2)\)</span>.</li>
</ul>
<p>As shown in Eq. <a href="#eq-eta" class="quarto-xref">Equation&nbsp;19</a> and Eq. <a href="#eq-measure" class="quarto-xref">Equation&nbsp;20</a>,</p>
<p>Como se muestra en la Figura <a href="#fig-arquitectura" class="quarto-xref">Figure&nbsp;1</a>, el modelo integra la red multi-eslabón con la capa Bayesiana y la capa de optimización.</p>
<div id="fig-arquitectura" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-cap="Arquitectura general del modelo." width="40%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-arquitectura-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/Dan(2026)v2.png" id="fig-arquitectura" class="img-fluid figure-img" style="width:40.0%" data-fig-cap="Arquitectura general del modelo.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-arquitectura-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</section>
<section id="simulated-sem-results" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Simulated SEM Results</h1>
<div id="bc6ce820" class="cell" data-fig-height="4.5" data-fig-width="7" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>out_fig <span class="op">=</span> Path(<span class="st">"results/figures"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>out_tab <span class="op">=</span> Path(<span class="st">"results/tables"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>out_fig.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>out_tab.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>n_products <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>n_attributes <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>n_process_vars <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>beta_true <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.8</span>, n_process_vars)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>lambda_true <span class="op">=</span> np.array([<span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">0.8</span>])</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>sigma_zeta_true <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>sigma_eps_true <span class="op">=</span> np.array([<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>])</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, (n_products, n_process_vars))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>zeta <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma_zeta_true, n_products)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> X <span class="op">@</span> beta_true <span class="op">+</span> zeta</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.zeros((n_products, n_attributes))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n_attributes):</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    eps <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma_eps_true[k], n_products)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    Y[:, k] <span class="op">=</span> lambda_true[k] <span class="op">*</span> eta <span class="op">+</span> eps</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>dfY <span class="op">=</span> pd.DataFrame(Y, columns<span class="op">=</span>[<span class="st">"Durability"</span>, <span class="st">"Appearance"</span>, <span class="st">"Comfort"</span>])</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> dfY.corr()</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>corr.to_csv(out_tab <span class="op">/</span> <span class="st">"corr_attributes.csv"</span>, index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>plt.hist(eta, bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r"Simulated latent quality </span><span class="dv">$</span><span class="er">\</span><span class="vs">eta</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>plt.savefig(out_fig <span class="op">/</span> <span class="st">"eta_hist.png"</span>, dpi<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>corr.<span class="bu">round</span>(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-2-output-1.png" width="662" height="468" class="figure-img"></p>
<figcaption>Distribution of simulated latent quality (η).</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Durability</th>
<th data-quarto-table-cell-role="th">Appearance</th>
<th data-quarto-table-cell-role="th">Comfort</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Durability</th>
<td>1.000</td>
<td>0.934</td>
<td>0.869</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Appearance</th>
<td>0.934</td>
<td>1.000</td>
<td>0.899</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Comfort</th>
<td>0.869</td>
<td>0.899</td>
<td>1.000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="bayesian-sem-estimation-pymc" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Bayesian SEM Estimation (PyMC)</h1>
<div id="c50b2db4" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytensor.tensor <span class="im">as</span> pt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Y_obs <span class="op">=</span> dfY.values</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>X_obs <span class="op">=</span> X</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>n, J <span class="op">=</span> X_obs.shape</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> Y_obs.shape[<span class="dv">1</span>]</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> sem_model:</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> pm.Normal(<span class="st">"beta"</span>, mu<span class="op">=</span><span class="fl">0.0</span>, sigma<span class="op">=</span><span class="fl">1.0</span>, shape<span class="op">=</span>J)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    sigma_zeta <span class="op">=</span> pm.HalfNormal(<span class="st">"sigma_zeta"</span>, sigma<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    lam <span class="op">=</span> pm.Normal(<span class="st">"lambda"</span>, mu<span class="op">=</span><span class="fl">1.0</span>, sigma<span class="op">=</span><span class="fl">0.5</span>, shape<span class="op">=</span>K)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    sigma_eps <span class="op">=</span> pm.HalfNormal(<span class="st">"sigma_eps"</span>, sigma<span class="op">=</span><span class="fl">1.0</span>, shape<span class="op">=</span>K)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    eta_latent <span class="op">=</span> pm.Normal(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"eta"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        mu<span class="op">=</span>pt.dot(X_obs, beta),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        sigma<span class="op">=</span>sigma_zeta,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        shape<span class="op">=</span>n</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    muY <span class="op">=</span> eta_latent[:, <span class="va">None</span>] <span class="op">*</span> lam[<span class="va">None</span>, :]</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    pm.Normal(<span class="st">"Y"</span>, mu<span class="op">=</span>muY, sigma<span class="op">=</span>sigma_eps, observed<span class="op">=</span>Y_obs)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    idata <span class="op">=</span> pm.sample(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        draws<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        tune<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        chains<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        target_accept<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        random_seed<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        progressbar<span class="op">=</span><span class="va">False</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>az.summary(idata, var_names<span class="op">=</span>[<span class="st">"beta"</span>, <span class="st">"lambda"</span>, <span class="st">"sigma_zeta"</span>, <span class="st">"sigma_eps"</span>], round_to<span class="op">=</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sd</th>
<th data-quarto-table-cell-role="th">hdi_3%</th>
<th data-quarto-table-cell-role="th">hdi_97%</th>
<th data-quarto-table-cell-role="th">mcse_mean</th>
<th data-quarto-table-cell-role="th">mcse_sd</th>
<th data-quarto-table-cell-role="th">ess_bulk</th>
<th data-quarto-table-cell-role="th">ess_tail</th>
<th data-quarto-table-cell-role="th">r_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">beta[0]</th>
<td>0.485</td>
<td>0.099</td>
<td>0.306</td>
<td>0.666</td>
<td>0.025</td>
<td>0.007</td>
<td>14.622</td>
<td>85.950</td>
<td>1.098</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">beta[1]</th>
<td>-0.124</td>
<td>0.053</td>
<td>-0.220</td>
<td>-0.020</td>
<td>0.005</td>
<td>0.002</td>
<td>109.609</td>
<td>410.665</td>
<td>1.018</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">beta[2]</th>
<td>0.570</td>
<td>0.111</td>
<td>0.368</td>
<td>0.766</td>
<td>0.026</td>
<td>0.008</td>
<td>17.392</td>
<td>72.167</td>
<td>1.097</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">beta[3]</th>
<td>1.386</td>
<td>0.240</td>
<td>0.934</td>
<td>1.808</td>
<td>0.067</td>
<td>0.022</td>
<td>13.269</td>
<td>45.011</td>
<td>1.127</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">beta[4]</th>
<td>-0.165</td>
<td>0.055</td>
<td>-0.263</td>
<td>-0.061</td>
<td>0.008</td>
<td>0.001</td>
<td>46.888</td>
<td>464.406</td>
<td>1.036</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">lambda[0]</th>
<td>0.776</td>
<td>0.143</td>
<td>0.563</td>
<td>1.053</td>
<td>0.043</td>
<td>0.017</td>
<td>14.097</td>
<td>45.235</td>
<td>1.124</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">lambda[1]</th>
<td>0.968</td>
<td>0.178</td>
<td>0.694</td>
<td>1.301</td>
<td>0.053</td>
<td>0.021</td>
<td>14.190</td>
<td>41.852</td>
<td>1.127</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">lambda[2]</th>
<td>0.709</td>
<td>0.132</td>
<td>0.499</td>
<td>0.957</td>
<td>0.039</td>
<td>0.015</td>
<td>14.669</td>
<td>47.337</td>
<td>1.121</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">sigma_zeta</th>
<td>0.627</td>
<td>0.117</td>
<td>0.418</td>
<td>0.828</td>
<td>0.031</td>
<td>0.010</td>
<td>14.858</td>
<td>72.299</td>
<td>1.113</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">sigma_eps[0]</th>
<td>0.403</td>
<td>0.028</td>
<td>0.352</td>
<td>0.454</td>
<td>0.001</td>
<td>0.001</td>
<td>695.670</td>
<td>1067.204</td>
<td>1.006</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">sigma_eps[1]</th>
<td>0.311</td>
<td>0.039</td>
<td>0.236</td>
<td>0.385</td>
<td>0.003</td>
<td>0.001</td>
<td>156.141</td>
<td>200.884</td>
<td>1.023</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">sigma_eps[2]</th>
<td>0.504</td>
<td>0.029</td>
<td>0.454</td>
<td>0.559</td>
<td>0.001</td>
<td>0.001</td>
<td>951.830</td>
<td>1221.667</td>
<td>1.002</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="posterior-diagnostics" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Posterior Diagnostics</h1>
<div id="1dfa20eb" class="cell" data-fig-height="5" data-fig-width="8" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>az.plot_trace(idata, var_names<span class="op">=</span>[<span class="st">"beta"</span>, <span class="st">"lambda"</span>, <span class="st">"sigma_zeta"</span>, <span class="st">"sigma_eps"</span>])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-4-output-1.png" width="1140" height="757" class="figure-img"></p>
<figcaption>MCMC trace diagnostics.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="parameter-recovery-check" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Parameter Recovery Check</h1>
<div id="9e3af02c" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>post <span class="op">=</span> az.summary(idata, var_names<span class="op">=</span>[<span class="st">"beta"</span>, <span class="st">"lambda"</span>], round_to<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>post_mean_beta <span class="op">=</span> post.loc[[<span class="ss">f"beta[</span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">]"</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(J)], <span class="st">"mean"</span>].to_numpy()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>post_mean_lam <span class="op">=</span> post.loc[[<span class="ss">f"lambda[</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">]"</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(K)], <span class="st">"mean"</span>].to_numpy()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> pd.DataFrame({</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"true"</span>: np.concatenate([beta_true, lambda_true]),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"posterior_mean"</span>: np.concatenate([post_mean_beta, post_mean_lam])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>comparison</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">true</th>
<th data-quarto-table-cell-role="th">posterior_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0.397371</td>
<td>0.485</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>-0.110611</td>
<td>-0.124</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>0.518151</td>
<td>0.570</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>1.218424</td>
<td>1.386</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>-0.187323</td>
<td>-0.165</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>0.900000</td>
<td>0.776</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>1.100000</td>
<td>0.968</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>0.800000</td>
<td>0.709</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8d367b38" class="cell" data-fig-height="4.5" data-fig-width="7" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(comparison[<span class="st">"true"</span>], comparison[<span class="st">"posterior_mean"</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"True value"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Posterior mean"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.plot(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    [comparison[<span class="st">"true"</span>].<span class="bu">min</span>(), comparison[<span class="st">"true"</span>].<span class="bu">max</span>()],</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    [comparison[<span class="st">"true"</span>].<span class="bu">min</span>(), comparison[<span class="st">"true"</span>].<span class="bu">max</span>()]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-6-output-1.png" width="661" height="468" class="figure-img"></p>
<figcaption>Posterior mean vs true parameter values.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="integrated-architecture-conceptual-diagram" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Integrated Architecture (Conceptual Diagram)</h1>
<div class="cell" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>%%{init: {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  "theme": "base",</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  "themeVariables": {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    "background": "#ffffff",</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    "primaryColor": "#ffffff",</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    "primaryTextColor": "#111111",</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    "primaryBorderColor": "#111111",</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    "lineColor": "#111111",</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    "fontSize": "12px"</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  "flowchart": { "curve": "linear" }</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>}}%%</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>flowchart TB</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  subgraph S["Red multi-eslabón (tiers)"]</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    direction TB</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    T3["Tier 3"] --&gt; T2["Tier 2"] --&gt; T1["Tier 1"] --&gt; M["Manufacturer"] --&gt; D["CD"] --&gt; C["Customer"]</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  end</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  subgraph B["Capa Bayesiana (SEM + BO)"]</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    direction TB</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    X["Procesos / variables&lt;br/&gt;X_s"] --&gt; ETA["Calidad latente η"]</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    ETA --&gt; Y["Criterios Y_{c,k}"]</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    Y --&gt; SC["Satisfacción S_c"]</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    SC --&gt; U["Utilidad económica U"]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  end</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  S --&gt; X</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  U --&gt; MILP["MILP: selección de enlaces z&lt;br/&gt;y flujos q"]</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  MILP --&gt; S</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {
  "theme": "base",
  "themeVariables": {
    "background": "#ffffff",
    "primaryColor": "#ffffff",
    "primaryTextColor": "#111111",
    "primaryBorderColor": "#111111",
    "lineColor": "#111111",
    "fontSize": "12px"
  },
  "flowchart": { "curve": "linear" }
}}%%

flowchart TB

  subgraph S["Red multi-eslabón (tiers)"]
    direction TB
    T3["Tier 3"] --&gt; T2["Tier 2"] --&gt; T1["Tier 1"] --&gt; M["Manufacturer"] --&gt; D["CD"] --&gt; C["Customer"]
  end

  subgraph B["Capa Bayesiana (SEM + BO)"]
    direction TB
    X["Procesos / variables&lt;br/&gt;X_s"] --&gt; ETA["Calidad latente η"]
    ETA --&gt; Y["Criterios Y_{c,k}"]
    Y --&gt; SC["Satisfacción S_c"]
    SC --&gt; U["Utilidad económica U"]
  end

  S --&gt; X
  U --&gt; MILP["MILP: selección de enlaces z&lt;br/&gt;y flujos q"]
  MILP --&gt; S
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="customer-satisfaction-and-endogenous-demand-1" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Customer Satisfaction and Endogenous Demand</h1>
<p>Customer satisfaction for product <span class="math inline">\(p\)</span> and customer <span class="math inline">\(c\)</span> is defined as:</p>
<p><span id="eq-satisfaction"><span class="math display">\[
S_{c,p} = \sum_{k=1}^{K} w_{c,k} \mathbb{E}[Y_{c,p,k}]
\tag{21}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(w_{c,k}\)</span> represents the importance weight of criterion <span class="math inline">\(k\)</span> for customer <span class="math inline">\(c\)</span>,</li>
<li><span class="math inline">\(\sum_{k} w_{c,k} = 1\)</span>.</li>
</ul>
<p>Demand is assumed to be endogenous and driven by satisfaction:</p>
<p><span id="eq-demand"><span class="math display">\[
d_{c,p} = d_{c,p}^{0} + \alpha_{c,p} S_{c,p}
\tag{22}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(d_{c,p}^{0}\)</span> is the baseline demand,</li>
<li><span class="math inline">\(\alpha_{c,p}\)</span> measures sensitivity of demand to satisfaction.</li>
</ul>
</section>
<section id="economic-utility-function" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Economic Utility Function</h1>
<p>Total economic utility is defined as:</p>
<p><span id="eq-utility"><span class="math display">\[
U = \sum_{c,p} \left( price_{c,p} \cdot q_{c,p} \right)
+ \gamma \sum_{c,p} S_{c,p} q_{c,p}
- C
\tag{23}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(q_{c,p}\)</span> is the quantity delivered to customer <span class="math inline">\(c\)</span>,</li>
<li><span class="math inline">\(\gamma\)</span> represents the economic impact of satisfaction,</li>
<li><span class="math inline">\(C\)</span> is total supply chain cost.</li>
</ul>
</section>
<section id="cost-structure-1" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> Cost Structure</h1>
<p>Total cost is composed of:</p>
<p><span id="eq-cost-total"><span class="math display">\[
C = C^{var} + C^{struct}
\tag{24}\]</span></span></p>
<p>Variable cost:</p>
<p><span id="eq-cost-var"><span class="math display">\[
C^{var} = \sum_{(i,j),p} c^{arc}_{i,j,p} q_{i,j,p}
\tag{25}\]</span></span></p>
<p>Structural cost:</p>
<p><span id="eq-cost-struct"><span class="math display">\[
C^{struct} = \sum_{(i,j),p} f_{i,j} z_{i,j,p}
\tag{26}\]</span></span></p>
</section>
<section id="milp-formulation" class="level1" data-number="24">
<h1 data-number="24"><span class="header-section-number">24</span> MILP Formulation</h1>
<p>The optimization problem is:</p>
<p><span class="math display">\[
\max U
\]</span></p>
<p>Subject to:</p>
<p>Flow conservation:</p>
<p><span class="math display">\[
\sum_{i} q_{i,j,p} = \sum_{k} q_{j,k,p}
\]</span></p>
<p>Capacity constraints:</p>
<p><span class="math display">\[
\sum_{j,p} q_{i,j,p} \leq Cap_i
\]</span></p>
<p>Link activation constraints:</p>
<p><span class="math display">\[
q_{i,j,p} \leq M z_{i,j,p}
\]</span></p>
<p>Binary structure:</p>
<p><span class="math display">\[
z_{i,j,p} \in \{0,1\}
\]</span></p>
</section>
<section id="bayesian-optimization-layer-gp-expected-improvement" class="level1" data-number="25">
<h1 data-number="25"><span class="header-section-number">25</span> Bayesian Optimization Layer (GP + Expected Improvement)</h1>
<p>This section formalizes the Bayesian Optimization (BO) layer used to learn or adapt decision parameters (e.g., customer weights, process targets, or policy parameters) that affect satisfaction and the downstream MILP objective. Let <span class="math inline">\(\boldsymbol{\theta}\in\Theta\subset\mathbb{R}^d\)</span> denote the vector of tunable parameters. Examples include:</p>
<ul>
<li>preference weights <span class="math inline">\(\boldsymbol{\theta}=\{w_{c,k}\}\)</span>,</li>
<li>process-control targets <span class="math inline">\(\boldsymbol{\theta}=\{x_{s,j}^{\star}\}\)</span>,</li>
<li>economic trade-off parameters <span class="math inline">\(\boldsymbol{\theta}=\{\gamma,\alpha_{c,p}\}\)</span>,</li>
<li>or any calibration vector that impacts expected satisfaction and utility.</li>
</ul>
<p>We define the (black-box) BO objective as the <strong>expected economic utility</strong> induced by <span class="math inline">\(\boldsymbol{\theta}\)</span>:</p>
<p><span id="eq-bo-obj"><span class="math display">\[
f(\boldsymbol{\theta}) \;=\; \mathbb{E}\Big[\, U(\boldsymbol{q}^{\star}(\boldsymbol{\theta}),\boldsymbol{z}^{\star}(\boldsymbol{\theta});\,\boldsymbol{\theta}) \,\Big],
\tag{27}\]</span></span></p>
<p>where <span class="math inline">\((\boldsymbol{q}^{\star}(\boldsymbol{\theta}),\boldsymbol{z}^{\star}(\boldsymbol{\theta}))\)</span> is the MILP optimal solution under parameterization <span class="math inline">\(\boldsymbol{\theta}\)</span>, and the expectation is taken with respect to the Bayesian layer uncertainty (SEM posterior and any stochastic components).</p>
<section id="gaussian-process-surrogate" class="level2" data-number="25.1">
<h2 data-number="25.1" class="anchored" data-anchor-id="gaussian-process-surrogate"><span class="header-section-number">25.1</span> Gaussian Process Surrogate</h2>
<p>At iteration <span class="math inline">\(n\)</span>, we have evaluated <span class="math inline">\(f\)</span> at <span class="math inline">\(\mathcal{D}_n=\{(\boldsymbol{\theta}_i, y_i)\}_{i=1}^n\)</span>, where:</p>
<p><span id="eq-bo-noise"><span class="math display">\[
y_i \;=\; f(\boldsymbol{\theta}_i) + \epsilon_i,\qquad \epsilon_i \sim \mathcal{N}(0,\sigma_\epsilon^2).
\tag{28}\]</span></span></p>
<p>We place a Gaussian Process prior on <span class="math inline">\(f\)</span>:</p>
<p><span id="eq-gp-prior"><span class="math display">\[
f(\boldsymbol{\theta}) \sim \mathcal{GP}\big(m(\boldsymbol{\theta}),\,k(\boldsymbol{\theta},\boldsymbol{\theta}')\big),
\tag{29}\]</span></span></p>
<p>commonly using a constant mean <span class="math inline">\(m(\boldsymbol{\theta})=m_0\)</span> and an RBF kernel:</p>
<p><span id="eq-gp-kernel"><span class="math display">\[
k(\boldsymbol{\theta},\boldsymbol{\theta}') \;=\; \sigma_f^2 \exp\!\left(
-\frac{1}{2}\sum_{\ell=1}^{d}\frac{(\theta_\ell-\theta'_\ell)^2}{\rho_\ell^2}
\right).
\tag{30}\]</span></span></p>
<p>Given <span class="math inline">\(\mathcal{D}_n\)</span>, the GP posterior at a candidate <span class="math inline">\(\boldsymbol{\theta}\)</span> is Gaussian:</p>
<p><span id="eq-gp-post"><span class="math display">\[
f(\boldsymbol{\theta}) \mid \mathcal{D}_n \;\sim\; \mathcal{N}\!\big(\mu_n(\boldsymbol{\theta}),\,\sigma_n^2(\boldsymbol{\theta})\big),
\tag{31}\]</span></span></p>
<p>with standard expressions:</p>
<p><span id="eq-gp-mu"><span class="math display">\[
\mu_n(\boldsymbol{\theta}) \;=\; m(\boldsymbol{\theta}) + \mathbf{k}_n(\boldsymbol{\theta})^\top
\big(\mathbf{K}_n+\sigma_\epsilon^2\mathbf{I}\big)^{-1}\big(\mathbf{y}-\mathbf{m}_n\big),
\tag{32}\]</span></span></p>
<p><span id="eq-gp-sigma"><span class="math display">\[
\sigma_n^2(\boldsymbol{\theta}) \;=\; k(\boldsymbol{\theta},\boldsymbol{\theta}) -
\mathbf{k}_n(\boldsymbol{\theta})^\top\big(\mathbf{K}_n+\sigma_\epsilon^2\mathbf{I}\big)^{-1}\mathbf{k}_n(\boldsymbol{\theta}),
\tag{33}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{K}_n=[k(\boldsymbol{\theta}_i,\boldsymbol{\theta}_j)]_{i,j}\)</span>, <span class="math inline">\(\mathbf{k}_n(\boldsymbol{\theta})=[k(\boldsymbol{\theta}_1,\boldsymbol{\theta}),\ldots,k(\boldsymbol{\theta}_n,\boldsymbol{\theta})]^\top\)</span>, <span class="math inline">\(\mathbf{y}=[y_1,\ldots,y_n]^\top\)</span>, and <span class="math inline">\(\mathbf{m}_n=[m(\boldsymbol{\theta}_1),\ldots,m(\boldsymbol{\theta}_n)]^\top\)</span>.</p>
</section>
<section id="expected-improvement-acquisition" class="level2" data-number="25.2">
<h2 data-number="25.2" class="anchored" data-anchor-id="expected-improvement-acquisition"><span class="header-section-number">25.2</span> Expected Improvement Acquisition</h2>
<p>Let <span class="math inline">\(f_n^{\max}=\max_{i\le n} y_i\)</span> be the best observed value so far. The Expected Improvement (EI) acquisition for maximization is:</p>
<p><span id="eq-ei-def"><span class="math display">\[
\mathrm{EI}_n(\boldsymbol{\theta}) \;=\;
\mathbb{E}\Big[\max\big(0,\, f(\boldsymbol{\theta})-f_n^{\max}-\xi\big)\;\big|\;\mathcal{D}_n\Big],
\tag{34}\]</span></span></p>
<p>where <span class="math inline">\(\xi\ge 0\)</span> controls exploration. Under the GP posterior @eq-gp-post, EI has closed form. Define:</p>
<p><span id="eq-ei-z"><span class="math display">\[
Z(\boldsymbol{\theta}) \;=\; \frac{\mu_n(\boldsymbol{\theta})-f_n^{\max}-\xi}{\sigma_n(\boldsymbol{\theta})},
\tag{35}\]</span></span></p>
<p>then:</p>
<p><span id="eq-ei-closed"><span class="math display">\[
\mathrm{EI}_n(\boldsymbol{\theta}) \;=\;
\big(\mu_n(\boldsymbol{\theta})-f_n^{\max}-\xi\big)\Phi\!\big(Z(\boldsymbol{\theta})\big)
+\sigma_n(\boldsymbol{\theta})\phi\!\big(Z(\boldsymbol{\theta})\big),
\tag{36}\]</span></span></p>
<p>with <span class="math inline">\(\Phi(\cdot)\)</span> and <span class="math inline">\(\phi(\cdot)\)</span> the standard normal CDF and PDF.</p>
<p>The BO iteration selects the next evaluation point by:</p>
<p><span id="eq-bo-next"><span class="math display">\[
\boldsymbol{\theta}_{n+1} \;=\; \arg\max_{\boldsymbol{\theta}\in\Theta}\;\mathrm{EI}_n(\boldsymbol{\theta}).
\tag{37}\]</span></span></p>
</section>
<section id="coupling-with-the-bayesian-sem-and-milp" class="level2" data-number="25.3">
<h2 data-number="25.3" class="anchored" data-anchor-id="coupling-with-the-bayesian-sem-and-milp"><span class="header-section-number">25.3</span> Coupling with the Bayesian SEM and MILP</h2>
<p>For each candidate <span class="math inline">\(\boldsymbol{\theta}\)</span> evaluated during BO, the workflow is:</p>
<ol type="1">
<li><strong>SEM posterior propagation:</strong> draw <span class="math inline">\((\boldsymbol{\beta},\boldsymbol{\lambda},\boldsymbol{\sigma}) \sim p(\cdot\mid \text{data})\)</span> and compute <span class="math inline">\(\mathbb{E}[Y_{c,p,k}\mid X,\boldsymbol{\theta}]\)</span> (or Monte Carlo estimates).</li>
<li><strong>Satisfaction / demand update:</strong> compute <span class="math inline">\(S_{c,p}(\boldsymbol{\theta})\)</span> and any derived demand parameters.</li>
<li><strong>MILP solve:</strong> solve the MILP to obtain <span class="math inline">\((\boldsymbol{q}^{\star}(\boldsymbol{\theta}),\boldsymbol{z}^{\star}(\boldsymbol{\theta}))\)</span>.</li>
<li><strong>Utility evaluation:</strong> compute <span class="math inline">\(y=f(\boldsymbol{\theta})\)</span> as the expected (or Monte Carlo averaged) utility.</li>
</ol>
<p>This closes the Bayesian loop: BO learns <span class="math inline">\(\boldsymbol{\theta}\)</span> that maximizes the satisfaction-driven expected utility under uncertainty.</p>
</section>
</section>
<section id="conclusion" class="level1" data-number="26">
<h1 data-number="26"><span class="header-section-number">26</span> Conclusion</h1>
<p>The proposed framework integrates:</p>
<ul>
<li>Bayesian Structural Equation Modeling</li>
<li>Multi-tier supply chain structure</li>
<li>Endogenous satisfaction-driven demand</li>
<li>Mixed-integer network optimization</li>
</ul>
<p>forming a unified architecture for economic utility maximization.</p>
<p>::contentReference<span data-index="0">oaicite:0</span></p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Bayesian–MILP Model for Multi-Tier Supply Chains"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Integrating Structural Equation Modeling and Customer Satisfaction Optimization"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Dr. Daniel A. Olivares Vera"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> |</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">  This paper proposes a Bayesian–MILP model that integrates structural equation</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">  modeling (SEM), Bayesian optimization (BO), and mixed-integer linear programming (MILP)</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">  for multi-tier supply chains oriented to customer value maximization.</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - Bayesian Optimization</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Structural Equation Modeling</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - MILP</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - Supply Chain</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method:</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">      method: mathjax</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">      options:</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">        tex:</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">          tags: ams</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">    documentclass: article</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">    pdf-engine: lualatex</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">    geometry: margin=1in</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: 12pt</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">    include-in-header:</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">      text: |</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">        \usepackage{lineno}</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co">        \linenumbers</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: false</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Download PDF version</span><span class="co">](index.pdf)</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>Supply chain network design has traditionally focused on cost minimization,</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>service level maximization, or efficiency optimization under the assumption</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>of exogenous demand. However, in multi-tier supply networks, upstream process</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>decisions influence product quality, which in turn affects customer perception,</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>satisfaction, and ultimately demand behavior.</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>Most network optimization models treat demand as independent of upstream</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>operational decisions. At the same time, the structural equation modeling (SEM)</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>literature analyzes latent quality constructs but does not integrate structural</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>network optimization decisions. Furthermore, Bayesian Optimization (BO)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>approaches typically focus on parameter tuning without incorporating discrete</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>network design decisions.</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>This paper proposes a unified framework that integrates:</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesian Structural Equation Modeling (SEM),</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Endogenous satisfaction-driven demand,</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mixed-Integer Linear Programming (MILP) network design,</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gaussian Process–based Bayesian Optimization (BO).</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>The key idea is that upstream process variables propagate through a latent</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>quality structure, influence customer-specific multi-criteria evaluations,</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>endogenize demand, and determine optimal supply chain configuration under</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>epistemic uncertainty.</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>The main contributions of this work are:</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The integration of Bayesian latent quality modeling into network design.</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The formulation of demand as an endogenous function of customer satisfaction.</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The coupling of discrete structural decisions with Gaussian Process–based Bayesian Optimization.</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>A unified algorithm that jointly optimizes structural configuration and economic utility under uncertainty.</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>The remainder of the paper is structured as follows. Section 2 presents</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>the overall modeling framework. Section 3 formalizes the Bayesian SEM.</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>Sections 4–6 develop the satisfaction, utility, and MILP components.</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>Section 7 introduces the Bayesian Optimization layer.</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>Section 8 presents numerical experiments.</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>Section 9 concludes with managerial implications and future research directions.</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a><span class="fu"># Unified Model Architecture</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>The proposed framework consists of four interconnected layers:</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Process Layer (Multi-tier Network Structure)**  </span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>   Each supply chain entity $s \in \mathcal{S}$ controls a vector of process variables</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>   $\mathbf{X}_s = (x_{s,1}, \dots, x_{s,J_s})$.</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>   These variables represent operational, technological, or quality-related decisions.</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Bayesian Latent Quality Layer (SEM)**  </span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>   Upstream process variables propagate through a latent quality construct:</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>   \eta_{c,p} = f(\mathbf{X}; \boldsymbol{\beta}) + \zeta</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>   $$ {#eq-quality}</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>   which determines customer-evaluated criteria:</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>   Y_{c,p,k} = \lambda_k \eta_{c,p} + \varepsilon_{c,p,k}</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>   $$ {#eq-criteria}</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Economic and Network Optimization Layer (MILP)**  </span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>   Customer satisfaction influences demand, which determines flow decisions</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>   $\mathbf{q}$ and structural activation variables $\mathbf{z}$ through</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>   a mixed-integer linear programming model.</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Bayesian Optimization Layer (BO)**  </span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>   A Gaussian Process surrogate models the expected economic utility:</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>   f(\boldsymbol{\theta}) = \mathbb{E}<span class="co">[</span><span class="ot">U(\boldsymbol{\theta})</span><span class="co">]</span></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>   $$ {#eq-Gaussian}</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>   and sequentially updates tunable parameters to maximize expected utility.</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>These layers form a closed feedback loop:</span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Process decisions affect latent quality.</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Latent quality determines satisfaction.</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Satisfaction drives endogenous demand.</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Demand determines optimal network structure.</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Observed utility updates Bayesian beliefs.</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesian Optimization adjusts decision parameters.</span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>This unified architecture allows structural network design under epistemic uncertainty while explicitly incorporating latent quality propagation and customer heterogeneity.</span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bayesian Structural Equation Model</span></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>Let:</span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$c \in \mathcal{C}$ denote customers,</span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$p \in \mathcal{P}$ denote products,</span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$k \in <span class="sc">\{</span>1,\dots,K<span class="sc">\}</span>$ denote evaluation criteria,</span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$s \in \mathcal{S}$ denote supply chain entities (tiers, manufacturers, distribution centers).</span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>Each entity $s$ controls a vector of process variables:</span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>\mathbf{X}_s = (x_{s,1}, \dots, x_{s,J_s})</span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>Let $\mathbf{X}$ denote the stacked vector of all upstream process variables.</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structural Model (Latent Quality Propagation)</span></span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>Latent quality for product $p$ perceived by customer $c$ is defined as:</span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>\eta_{c,p} = \mathbf{X}^\top \boldsymbol{\beta} + \zeta_{c,p}</span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>$$ {#eq-latent}</span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\boldsymbol{\beta}$ is the vector of structural coefficients,</span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\zeta_{c,p} \sim \mathcal{N}(0, \sigma_\zeta^2)$ captures structural uncertainty.</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>This formulation allows upstream process variables across multiple tiers to jointly influence perceived product quality.</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a><span class="fu">## Measurement Model (Multi-Criteria Evaluation)</span></span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>Each customer evaluates product $p$ according to $K$ criteria:</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>Y_{c,p,k} = \lambda_k \eta_{c,p} + \varepsilon_{c,p,k}</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>$$ {#eq-measurement}</span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\lambda_k$ are measurement loadings,</span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\varepsilon_{c,p,k} \sim \mathcal{N}(0, \sigma_{\varepsilon_k}^2)$.</span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a>The vector form is:</span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>\mathbf{Y}_{c,p} = \boldsymbol{\lambda} \eta_{c,p} + \boldsymbol{\varepsilon}_{c,p}</span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a>This hierarchical formulation allows:</span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Correlated multi-criteria perception,</span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cross-tier influence propagation,</span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Explicit uncertainty quantification.</span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Estimation</span></span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>We place prior distributions:</span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>\boldsymbol{\beta} \sim \mathcal{N}(0, \sigma_\beta^2 I)</span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>\lambda_k \sim \mathcal{N}(1, \sigma_\lambda^2)</span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>\sigma_\zeta, \sigma_{\varepsilon_k} \sim \text{Half-Normal}(0,1)</span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a>The posterior distribution is:</span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a>p(\boldsymbol{\beta}, \boldsymbol{\lambda}, \sigma_\zeta, \sigma_{\varepsilon} \mid \mathbf{Y}, \mathbf{X})</span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a>\propto</span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a>p(\mathbf{Y} \mid \mathbf{X}, \boldsymbol{\beta}, \boldsymbol{\lambda})</span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>p(\boldsymbol{\beta}) p(\boldsymbol{\lambda}) p(\sigma_\zeta) p(\sigma_{\varepsilon})</span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a>Posterior draws are used to propagate epistemic uncertainty into downstream satisfaction and network optimization decisions.</span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a><span class="fu"># Customer Satisfaction, Endogenous Demand, and Utility</span></span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>This section links the Bayesian SEM outputs (multi-criteria perceptions) to customer satisfaction, demand, and economic utility, enabling the integration with network optimization.</span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a><span class="fu">## Customer-Specific Satisfaction Aggregation</span></span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a>Let $Y_{c,p,k}$ be the perceived score of product $p$ by customer $c$ on criterion $k$ (from Eq. @eq-measurement).  </span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a>Each customer has a preference-weight vector:</span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a>\mathbf{w}_c = (w_{c,1},\dots,w_{c,K}), \qquad w_{c,k}\ge 0,\ \ \sum_{k=1}^K w_{c,k}=1</span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a>$$ {#eq-weights}</span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a>Customer satisfaction is defined as the weighted aggregation:</span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a>S_{c,p} = \sum_{k=1}^K w_{c,k}\, Y_{c,p,k}</span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a>$$ {#eq-satisfaction}</span>
<span id="cb7-253"><a href="#cb7-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-254"><a href="#cb7-254" aria-hidden="true" tabindex="-1"></a>This allows heterogeneous priorities across customers (e.g., durability vs. aesthetics).</span>
<span id="cb7-255"><a href="#cb7-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-256"><a href="#cb7-256" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-257"><a href="#cb7-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-258"><a href="#cb7-258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Endogenous Demand as a Function of Satisfaction</span></span>
<span id="cb7-259"><a href="#cb7-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-260"><a href="#cb7-260" aria-hidden="true" tabindex="-1"></a>We model demand as an increasing function of satisfaction. A convenient bounded form is the logistic demand response:</span>
<span id="cb7-261"><a href="#cb7-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-262"><a href="#cb7-262" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-263"><a href="#cb7-263" aria-hidden="true" tabindex="-1"></a>D_{c,p}(\mathbf{w}_c) \;=\; \bar{D}_{c,p}\,\sigma\!\left(\alpha_{c,p}\left(S_{c,p}-\tau_{c,p}\right)\right),</span>
<span id="cb7-264"><a href="#cb7-264" aria-hidden="true" tabindex="-1"></a>\qquad</span>
<span id="cb7-265"><a href="#cb7-265" aria-hidden="true" tabindex="-1"></a>\sigma(u)=\frac{1}{1+e^{-u}}</span>
<span id="cb7-266"><a href="#cb7-266" aria-hidden="true" tabindex="-1"></a>$$ {#eq-demand}</span>
<span id="cb7-267"><a href="#cb7-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-268"><a href="#cb7-268" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-269"><a href="#cb7-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-270"><a href="#cb7-270" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\bar{D}_{c,p}$ is the market potential,</span>
<span id="cb7-271"><a href="#cb7-271" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\alpha_{c,p}&gt;0$ controls sensitivity,</span>
<span id="cb7-272"><a href="#cb7-272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\tau_{c,p}$ is an acceptance threshold.</span>
<span id="cb7-273"><a href="#cb7-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-274"><a href="#cb7-274" aria-hidden="true" tabindex="-1"></a>Because $S_{c,p}$ depends on the SEM posterior, $D_{c,p}$ is a random variable.</span>
<span id="cb7-275"><a href="#cb7-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-276"><a href="#cb7-276" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-277"><a href="#cb7-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-278"><a href="#cb7-278" aria-hidden="true" tabindex="-1"></a><span class="fu">## Economic Utility and Cost Structure</span></span>
<span id="cb7-279"><a href="#cb7-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-280"><a href="#cb7-280" aria-hidden="true" tabindex="-1"></a>Let $q_{c,p}$ denote delivered quantity of product $p$ to customer $c$ (MILP decision).  </span>
<span id="cb7-281"><a href="#cb7-281" aria-hidden="true" tabindex="-1"></a>Let $r_{c,p}$ be the unit revenue (or price). The expected economic utility is:</span>
<span id="cb7-282"><a href="#cb7-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-283"><a href="#cb7-283" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-284"><a href="#cb7-284" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">U</span><span class="co">]</span> \;=\;</span>
<span id="cb7-285"><a href="#cb7-285" aria-hidden="true" tabindex="-1"></a>\sum_{c\in\mathcal{C}}\sum_{p\in\mathcal{P}}</span>
<span id="cb7-286"><a href="#cb7-286" aria-hidden="true" tabindex="-1"></a>r_{c,p}\,\mathbb{E}<span class="sc">\!</span>\left<span class="co">[</span><span class="ot">\min\{q_{c,p}, D_{c,p}(\mathbf{w}_c)\}\right</span><span class="co">]</span></span>
<span id="cb7-287"><a href="#cb7-287" aria-hidden="true" tabindex="-1"></a>\;-\; C_{\text{prod}} \;-\; C_{\text{flow}} \;-\; C_{\text{struct}}</span>
<span id="cb7-288"><a href="#cb7-288" aria-hidden="true" tabindex="-1"></a>$$ {#eq-utility}</span>
<span id="cb7-289"><a href="#cb7-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-290"><a href="#cb7-290" aria-hidden="true" tabindex="-1"></a>We decompose total cost as:</span>
<span id="cb7-291"><a href="#cb7-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-292"><a href="#cb7-292" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-293"><a href="#cb7-293" aria-hidden="true" tabindex="-1"></a>C_{\text{prod}} = \sum_{s\in\mathcal{S}}\sum_{p\in\mathcal{P}} c^{\text{prod}}_{s,p}\, q_{s,p}</span>
<span id="cb7-294"><a href="#cb7-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-295"><a href="#cb7-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-296"><a href="#cb7-296" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-297"><a href="#cb7-297" aria-hidden="true" tabindex="-1"></a>C_{\text{flow}} = \sum_{(i,j)\in\mathcal{A}}\sum_{p\in\mathcal{P}} c^{\text{ship}}_{i,j,p}\, y_{i,j,p}</span>
<span id="cb7-298"><a href="#cb7-298" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-299"><a href="#cb7-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-300"><a href="#cb7-300" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-301"><a href="#cb7-301" aria-hidden="true" tabindex="-1"></a>C_{\text{struct}} = \sum_{(i,j)\in\mathcal{A}} f_{i,j}\, z_{i,j}</span>
<span id="cb7-302"><a href="#cb7-302" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-303"><a href="#cb7-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-304"><a href="#cb7-304" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-305"><a href="#cb7-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-306"><a href="#cb7-306" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y_{i,j,p}$ is the flow of product $p$ on arc $(i,j)$,</span>
<span id="cb7-307"><a href="#cb7-307" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$z_{i,j}\in<span class="sc">\{</span>0,1<span class="sc">\}</span>$ indicates whether link $(i,j)$ is activated,</span>
<span id="cb7-308"><a href="#cb7-308" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$f_{i,j}$ is the fixed cost of establishing/using link $(i,j)$.</span>
<span id="cb7-309"><a href="#cb7-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-310"><a href="#cb7-310" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-311"><a href="#cb7-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-312"><a href="#cb7-312" aria-hidden="true" tabindex="-1"></a><span class="fu">## Where Bayesian Optimization Enters</span></span>
<span id="cb7-313"><a href="#cb7-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-314"><a href="#cb7-314" aria-hidden="true" tabindex="-1"></a>Define the BO decision variables as the customer preference weights:</span>
<span id="cb7-315"><a href="#cb7-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-316"><a href="#cb7-316" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-317"><a href="#cb7-317" aria-hidden="true" tabindex="-1"></a>\Theta \;=\; <span class="sc">\{</span>\mathbf{w}_c: c\in\mathcal{C}<span class="sc">\}</span></span>
<span id="cb7-318"><a href="#cb7-318" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-319"><a href="#cb7-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-320"><a href="#cb7-320" aria-hidden="true" tabindex="-1"></a>subject to simplex constraints (Eq. @eq-weights). The objective evaluated by BO is the expected utility under the SEM posterior and the MILP optimal response:</span>
<span id="cb7-321"><a href="#cb7-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-322"><a href="#cb7-322" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-323"><a href="#cb7-323" aria-hidden="true" tabindex="-1"></a>J(\Theta) \;=\;</span>
<span id="cb7-324"><a href="#cb7-324" aria-hidden="true" tabindex="-1"></a>\max_{z,q,y}\ \mathbb{E}<span class="co">[</span><span class="ot">U(z,q,y;\Theta)</span><span class="co">]</span></span>
<span id="cb7-325"><a href="#cb7-325" aria-hidden="true" tabindex="-1"></a>\quad\text{s.t. MILP constraints}</span>
<span id="cb7-326"><a href="#cb7-326" aria-hidden="true" tabindex="-1"></a>$$ {#eq-bo-objective}</span>
<span id="cb7-327"><a href="#cb7-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-328"><a href="#cb7-328" aria-hidden="true" tabindex="-1"></a>Bayesian Optimization searches for:</span>
<span id="cb7-329"><a href="#cb7-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-330"><a href="#cb7-330" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-331"><a href="#cb7-331" aria-hidden="true" tabindex="-1"></a>\Theta^\star = \arg\max_{\Theta}\ J(\Theta)</span>
<span id="cb7-332"><a href="#cb7-332" aria-hidden="true" tabindex="-1"></a>$$ {#eq-bo-opt}</span>
<span id="cb7-333"><a href="#cb7-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-334"><a href="#cb7-334" aria-hidden="true" tabindex="-1"></a>In practice, the expectation in $J(\Theta)$ is computed via Monte Carlo using posterior samples from the Bayesian SEM, thereby propagating uncertainty into satisfaction, demand, and network decisions.</span>
<span id="cb7-335"><a href="#cb7-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-336"><a href="#cb7-336" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bayesian Optimization Layer</span></span>
<span id="cb7-337"><a href="#cb7-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-338"><a href="#cb7-338" aria-hidden="true" tabindex="-1"></a>The decision vector to be optimized is:</span>
<span id="cb7-339"><a href="#cb7-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-340"><a href="#cb7-340" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-341"><a href="#cb7-341" aria-hidden="true" tabindex="-1"></a>\Theta = <span class="sc">\{</span>\mathbf{w}_c : c \in \mathcal{C}<span class="sc">\}</span></span>
<span id="cb7-342"><a href="#cb7-342" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-343"><a href="#cb7-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-344"><a href="#cb7-344" aria-hidden="true" tabindex="-1"></a>where each $\mathbf{w}_c$ lies in the probability simplex:</span>
<span id="cb7-345"><a href="#cb7-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-346"><a href="#cb7-346" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-347"><a href="#cb7-347" aria-hidden="true" tabindex="-1"></a>w_{c,k} \ge 0, \qquad \sum_{k=1}^K w_{c,k} = 1</span>
<span id="cb7-348"><a href="#cb7-348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-349"><a href="#cb7-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-350"><a href="#cb7-350" aria-hidden="true" tabindex="-1"></a>The objective function evaluated by Bayesian Optimization is:</span>
<span id="cb7-351"><a href="#cb7-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-352"><a href="#cb7-352" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-353"><a href="#cb7-353" aria-hidden="true" tabindex="-1"></a>J(\Theta) = \max_{z,q,y} \mathbb{E}<span class="co">[</span><span class="ot">U(z,q,y;\Theta)</span><span class="co">]</span></span>
<span id="cb7-354"><a href="#cb7-354" aria-hidden="true" tabindex="-1"></a>$$ {#eq-bo-global}</span>
<span id="cb7-355"><a href="#cb7-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-356"><a href="#cb7-356" aria-hidden="true" tabindex="-1"></a>subject to all MILP constraints and where the expectation is taken over the posterior distribution of the Bayesian SEM.</span>
<span id="cb7-357"><a href="#cb7-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-358"><a href="#cb7-358" aria-hidden="true" tabindex="-1"></a>Because $J(\Theta)$ does not admit a closed-form expression and requires solving a MILP for each evaluation, it is treated as a black-box function.</span>
<span id="cb7-359"><a href="#cb7-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-360"><a href="#cb7-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-361"><a href="#cb7-361" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gaussian Process Surrogate Model</span></span>
<span id="cb7-362"><a href="#cb7-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-363"><a href="#cb7-363" aria-hidden="true" tabindex="-1"></a>We model the objective as:</span>
<span id="cb7-364"><a href="#cb7-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-365"><a href="#cb7-365" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-366"><a href="#cb7-366" aria-hidden="true" tabindex="-1"></a>f(\Theta) \sim \mathcal{GP}(m(\Theta), k(\Theta,\Theta'))</span>
<span id="cb7-367"><a href="#cb7-367" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-prior}</span>
<span id="cb7-368"><a href="#cb7-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-369"><a href="#cb7-369" aria-hidden="true" tabindex="-1"></a>At iteration $n$, we observe:</span>
<span id="cb7-370"><a href="#cb7-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-371"><a href="#cb7-371" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-372"><a href="#cb7-372" aria-hidden="true" tabindex="-1"></a>y_i = f(\Theta_i) + \varepsilon_i,</span>
<span id="cb7-373"><a href="#cb7-373" aria-hidden="true" tabindex="-1"></a>\qquad</span>
<span id="cb7-374"><a href="#cb7-374" aria-hidden="true" tabindex="-1"></a>\varepsilon_i \sim \mathcal{N}(0,\sigma_\varepsilon^2)</span>
<span id="cb7-375"><a href="#cb7-375" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-noise}</span>
<span id="cb7-376"><a href="#cb7-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-377"><a href="#cb7-377" aria-hidden="true" tabindex="-1"></a>The kernel function is chosen as a squared exponential (RBF):</span>
<span id="cb7-378"><a href="#cb7-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-379"><a href="#cb7-379" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-380"><a href="#cb7-380" aria-hidden="true" tabindex="-1"></a>k(\Theta,\Theta') =</span>
<span id="cb7-381"><a href="#cb7-381" aria-hidden="true" tabindex="-1"></a>\sigma_f^2 \exp<span class="sc">\!</span>\left(</span>
<span id="cb7-382"><a href="#cb7-382" aria-hidden="true" tabindex="-1"></a>-\frac{1}{2}</span>
<span id="cb7-383"><a href="#cb7-383" aria-hidden="true" tabindex="-1"></a>\sum_{d=1}^{D}</span>
<span id="cb7-384"><a href="#cb7-384" aria-hidden="true" tabindex="-1"></a>\frac{(\theta_d - \theta'_d)^2}{\ell_d^2}</span>
<span id="cb7-385"><a href="#cb7-385" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-386"><a href="#cb7-386" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-kernel}</span>
<span id="cb7-387"><a href="#cb7-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-388"><a href="#cb7-388" aria-hidden="true" tabindex="-1"></a>The posterior predictive distribution is:</span>
<span id="cb7-389"><a href="#cb7-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-390"><a href="#cb7-390" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-391"><a href="#cb7-391" aria-hidden="true" tabindex="-1"></a>f(\Theta) \mid \mathcal{D}_n</span>
<span id="cb7-392"><a href="#cb7-392" aria-hidden="true" tabindex="-1"></a>\sim</span>
<span id="cb7-393"><a href="#cb7-393" aria-hidden="true" tabindex="-1"></a>\mathcal{N}(\mu_n(\Theta), \sigma_n^2(\Theta))</span>
<span id="cb7-394"><a href="#cb7-394" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-posterior}</span>
<span id="cb7-395"><a href="#cb7-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-396"><a href="#cb7-396" aria-hidden="true" tabindex="-1"></a>Now the acquisition function.</span>
<span id="cb7-397"><a href="#cb7-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-398"><a href="#cb7-398" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expected Improvement Acquisition Function</span></span>
<span id="cb7-399"><a href="#cb7-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-400"><a href="#cb7-400" aria-hidden="true" tabindex="-1"></a>Let</span>
<span id="cb7-401"><a href="#cb7-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-402"><a href="#cb7-402" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-403"><a href="#cb7-403" aria-hidden="true" tabindex="-1"></a>f_n^{\max} = \max_{i \le n} y_i</span>
<span id="cb7-404"><a href="#cb7-404" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-405"><a href="#cb7-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-406"><a href="#cb7-406" aria-hidden="true" tabindex="-1"></a>The Expected Improvement (EI) acquisition function is:</span>
<span id="cb7-407"><a href="#cb7-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-408"><a href="#cb7-408" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-409"><a href="#cb7-409" aria-hidden="true" tabindex="-1"></a>\text{EI}_n(\Theta)</span>
<span id="cb7-410"><a href="#cb7-410" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-411"><a href="#cb7-411" aria-hidden="true" tabindex="-1"></a>\mathbb{E}</span>
<span id="cb7-412"><a href="#cb7-412" aria-hidden="true" tabindex="-1"></a>\left[</span>
<span id="cb7-413"><a href="#cb7-413" aria-hidden="true" tabindex="-1"></a>\max(0, f(\Theta) - f_n^{\max} - \xi)</span>
<span id="cb7-414"><a href="#cb7-414" aria-hidden="true" tabindex="-1"></a>\right]</span>
<span id="cb7-415"><a href="#cb7-415" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ei}</span>
<span id="cb7-416"><a href="#cb7-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-417"><a href="#cb7-417" aria-hidden="true" tabindex="-1"></a>where $\xi \ge 0$ controls exploration.</span>
<span id="cb7-418"><a href="#cb7-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-419"><a href="#cb7-419" aria-hidden="true" tabindex="-1"></a>Define:</span>
<span id="cb7-420"><a href="#cb7-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-421"><a href="#cb7-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-422"><a href="#cb7-422" aria-hidden="true" tabindex="-1"></a>Z(\Theta) =</span>
<span id="cb7-423"><a href="#cb7-423" aria-hidden="true" tabindex="-1"></a>\frac{\mu_n(\Theta) - f_n^{\max} - \xi}</span>
<span id="cb7-424"><a href="#cb7-424" aria-hidden="true" tabindex="-1"></a>{\sigma_n(\Theta)}</span>
<span id="cb7-425"><a href="#cb7-425" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-426"><a href="#cb7-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-427"><a href="#cb7-427" aria-hidden="true" tabindex="-1"></a>Then EI admits closed form:</span>
<span id="cb7-428"><a href="#cb7-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-429"><a href="#cb7-429" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-430"><a href="#cb7-430" aria-hidden="true" tabindex="-1"></a>\text{EI}_n(\Theta)</span>
<span id="cb7-431"><a href="#cb7-431" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-432"><a href="#cb7-432" aria-hidden="true" tabindex="-1"></a>(\mu_n(\Theta) - f_n^{\max} - \xi)</span>
<span id="cb7-433"><a href="#cb7-433" aria-hidden="true" tabindex="-1"></a>\Phi(Z(\Theta))</span>
<span id="cb7-434"><a href="#cb7-434" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-435"><a href="#cb7-435" aria-hidden="true" tabindex="-1"></a>\sigma_n(\Theta)</span>
<span id="cb7-436"><a href="#cb7-436" aria-hidden="true" tabindex="-1"></a>\phi(Z(\Theta))</span>
<span id="cb7-437"><a href="#cb7-437" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ei-closed}</span>
<span id="cb7-438"><a href="#cb7-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-439"><a href="#cb7-439" aria-hidden="true" tabindex="-1"></a>where $\Phi(\cdot)$ and $\phi(\cdot)$ denote the standard normal CDF and PDF.</span>
<span id="cb7-440"><a href="#cb7-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-441"><a href="#cb7-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-442"><a href="#cb7-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-443"><a href="#cb7-443" aria-hidden="true" tabindex="-1"></a><span class="fu">## Integrated Bayesian–MILP Procedure</span></span>
<span id="cb7-444"><a href="#cb7-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-445"><a href="#cb7-445" aria-hidden="true" tabindex="-1"></a>The overall iterative algorithm is:</span>
<span id="cb7-446"><a href="#cb7-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-447"><a href="#cb7-447" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Estimate the Bayesian SEM posterior.</span>
<span id="cb7-448"><a href="#cb7-448" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Draw posterior samples of $(\boldsymbol{\beta}, \boldsymbol{\lambda}, \sigma)$.</span>
<span id="cb7-449"><a href="#cb7-449" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>For candidate $\Theta$:</span>
<span id="cb7-450"><a href="#cb7-450" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Compute satisfaction $S_{c,p}$.</span>
<span id="cb7-451"><a href="#cb7-451" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Compute endogenous demand $D_{c,p}$.</span>
<span id="cb7-452"><a href="#cb7-452" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Solve MILP to obtain $(z^\star, q^\star, y^\star)$.</span>
<span id="cb7-453"><a href="#cb7-453" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Evaluate expected utility $J(\Theta)$.</span>
<span id="cb7-454"><a href="#cb7-454" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Update Gaussian Process surrogate.</span>
<span id="cb7-455"><a href="#cb7-455" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Select next $\Theta_{n+1}$ using Expected Improvement.</span>
<span id="cb7-456"><a href="#cb7-456" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Repeat until convergence.</span>
<span id="cb7-457"><a href="#cb7-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-458"><a href="#cb7-458" aria-hidden="true" tabindex="-1"></a>This closed-loop procedure allows structural network design under epistemic uncertainty, where customer preference weights are optimally calibrated to maximize expected economic utility.</span>
<span id="cb7-459"><a href="#cb7-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-460"><a href="#cb7-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-461"><a href="#cb7-461" aria-hidden="true" tabindex="-1"></a><span class="fu"># Numerical Experiment: Industrial Multi-Tier Case Study</span></span>
<span id="cb7-462"><a href="#cb7-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-463"><a href="#cb7-463" aria-hidden="true" tabindex="-1"></a>To demonstrate the practical applicability of the proposed Bayesian–MILP framework, we construct a large-scale industrial case inspired by a multi-tier manufacturing network.</span>
<span id="cb7-464"><a href="#cb7-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-465"><a href="#cb7-465" aria-hidden="true" tabindex="-1"></a><span class="fu">## Network Structure</span></span>
<span id="cb7-466"><a href="#cb7-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-467"><a href="#cb7-467" aria-hidden="true" tabindex="-1"></a>The supply chain consists of:</span>
<span id="cb7-468"><a href="#cb7-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-469"><a href="#cb7-469" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>4 Tier 3 raw-material suppliers</span>
<span id="cb7-470"><a href="#cb7-470" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>3 Tier 2 processors</span>
<span id="cb7-471"><a href="#cb7-471" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>5 Tier 1 component suppliers</span>
<span id="cb7-472"><a href="#cb7-472" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>4 manufacturers</span>
<span id="cb7-473"><a href="#cb7-473" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>3 distribution centers</span>
<span id="cb7-474"><a href="#cb7-474" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>6 heterogeneous customers</span>
<span id="cb7-475"><a href="#cb7-475" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>3 product types</span>
<span id="cb7-476"><a href="#cb7-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-477"><a href="#cb7-477" aria-hidden="true" tabindex="-1"></a>The network includes approximately 80 potential arcs, each associated with:</span>
<span id="cb7-478"><a href="#cb7-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-479"><a href="#cb7-479" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fixed structural activation cost $f_{i,j}$</span>
<span id="cb7-480"><a href="#cb7-480" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variable transportation cost $c^{ship}_{i,j,p}$</span>
<span id="cb7-481"><a href="#cb7-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-482"><a href="#cb7-482" aria-hidden="true" tabindex="-1"></a>Binary variables:</span>
<span id="cb7-483"><a href="#cb7-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-484"><a href="#cb7-484" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-485"><a href="#cb7-485" aria-hidden="true" tabindex="-1"></a>z_{i,j} \in <span class="sc">\{</span>0,1<span class="sc">\}</span></span>
<span id="cb7-486"><a href="#cb7-486" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-487"><a href="#cb7-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-488"><a href="#cb7-488" aria-hidden="true" tabindex="-1"></a>Continuous flow variables:</span>
<span id="cb7-489"><a href="#cb7-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-490"><a href="#cb7-490" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-491"><a href="#cb7-491" aria-hidden="true" tabindex="-1"></a>y_{i,j,p} \ge 0</span>
<span id="cb7-492"><a href="#cb7-492" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-493"><a href="#cb7-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-494"><a href="#cb7-494" aria-hidden="true" tabindex="-1"></a>Production variables:</span>
<span id="cb7-495"><a href="#cb7-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-496"><a href="#cb7-496" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-497"><a href="#cb7-497" aria-hidden="true" tabindex="-1"></a>q_{s,p} \ge 0</span>
<span id="cb7-498"><a href="#cb7-498" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-499"><a href="#cb7-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-500"><a href="#cb7-500" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-501"><a href="#cb7-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-502"><a href="#cb7-502" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multi-Product Satisfaction and Demand</span></span>
<span id="cb7-503"><a href="#cb7-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-504"><a href="#cb7-504" aria-hidden="true" tabindex="-1"></a>Each customer evaluates products using $K=4$ criteria:</span>
<span id="cb7-505"><a href="#cb7-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-506"><a href="#cb7-506" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Durability</span>
<span id="cb7-507"><a href="#cb7-507" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comfort</span>
<span id="cb7-508"><a href="#cb7-508" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Aesthetics</span>
<span id="cb7-509"><a href="#cb7-509" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sustainability</span>
<span id="cb7-510"><a href="#cb7-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-511"><a href="#cb7-511" aria-hidden="true" tabindex="-1"></a>Customer satisfaction:</span>
<span id="cb7-512"><a href="#cb7-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-513"><a href="#cb7-513" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-514"><a href="#cb7-514" aria-hidden="true" tabindex="-1"></a>S_{c,p} = \sum_{k=1}^4 w_{c,k} Y_{c,p,k}</span>
<span id="cb7-515"><a href="#cb7-515" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-516"><a href="#cb7-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-517"><a href="#cb7-517" aria-hidden="true" tabindex="-1"></a>Demand follows logistic response:</span>
<span id="cb7-518"><a href="#cb7-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-519"><a href="#cb7-519" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-520"><a href="#cb7-520" aria-hidden="true" tabindex="-1"></a>D_{c,p} =</span>
<span id="cb7-521"><a href="#cb7-521" aria-hidden="true" tabindex="-1"></a>\bar{D}_{c,p}</span>
<span id="cb7-522"><a href="#cb7-522" aria-hidden="true" tabindex="-1"></a>\frac{1}{1 + \exp(-\alpha_{c,p}(S_{c,p}-\tau_{c,p}))}</span>
<span id="cb7-523"><a href="#cb7-523" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-524"><a href="#cb7-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-525"><a href="#cb7-525" aria-hidden="true" tabindex="-1"></a>Customer heterogeneity is introduced by:</span>
<span id="cb7-526"><a href="#cb7-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-527"><a href="#cb7-527" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Different $\mathbf{w}_c$</span>
<span id="cb7-528"><a href="#cb7-528" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Different $\alpha_{c,p}$</span>
<span id="cb7-529"><a href="#cb7-529" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Different thresholds $\tau_{c,p}$</span>
<span id="cb7-530"><a href="#cb7-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-531"><a href="#cb7-531" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-532"><a href="#cb7-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-533"><a href="#cb7-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cost Structure</span></span>
<span id="cb7-534"><a href="#cb7-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-535"><a href="#cb7-535" aria-hidden="true" tabindex="-1"></a>Total cost:</span>
<span id="cb7-536"><a href="#cb7-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-537"><a href="#cb7-537" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-538"><a href="#cb7-538" aria-hidden="true" tabindex="-1"></a>C = C_{prod} + C_{flow} + C_{struct}</span>
<span id="cb7-539"><a href="#cb7-539" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-540"><a href="#cb7-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-541"><a href="#cb7-541" aria-hidden="true" tabindex="-1"></a>Production cost:</span>
<span id="cb7-542"><a href="#cb7-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-543"><a href="#cb7-543" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-544"><a href="#cb7-544" aria-hidden="true" tabindex="-1"></a>C_{prod} =</span>
<span id="cb7-545"><a href="#cb7-545" aria-hidden="true" tabindex="-1"></a>\sum_{s,p}</span>
<span id="cb7-546"><a href="#cb7-546" aria-hidden="true" tabindex="-1"></a>c^{prod}_{s,p} q_{s,p}</span>
<span id="cb7-547"><a href="#cb7-547" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-548"><a href="#cb7-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-549"><a href="#cb7-549" aria-hidden="true" tabindex="-1"></a>Flow cost:</span>
<span id="cb7-550"><a href="#cb7-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-551"><a href="#cb7-551" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-552"><a href="#cb7-552" aria-hidden="true" tabindex="-1"></a>C_{flow} =</span>
<span id="cb7-553"><a href="#cb7-553" aria-hidden="true" tabindex="-1"></a>\sum_{(i,j),p}</span>
<span id="cb7-554"><a href="#cb7-554" aria-hidden="true" tabindex="-1"></a>c^{ship}_{i,j,p} y_{i,j,p}</span>
<span id="cb7-555"><a href="#cb7-555" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-556"><a href="#cb7-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-557"><a href="#cb7-557" aria-hidden="true" tabindex="-1"></a>Structure cost:</span>
<span id="cb7-558"><a href="#cb7-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-559"><a href="#cb7-559" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-560"><a href="#cb7-560" aria-hidden="true" tabindex="-1"></a>C_{struct} =</span>
<span id="cb7-561"><a href="#cb7-561" aria-hidden="true" tabindex="-1"></a>\sum_{(i,j)}</span>
<span id="cb7-562"><a href="#cb7-562" aria-hidden="true" tabindex="-1"></a>f_{i,j} z_{i,j}</span>
<span id="cb7-563"><a href="#cb7-563" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-564"><a href="#cb7-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-565"><a href="#cb7-565" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-566"><a href="#cb7-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-567"><a href="#cb7-567" aria-hidden="true" tabindex="-1"></a><span class="fu">## Integrated Optimization Problem</span></span>
<span id="cb7-568"><a href="#cb7-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-569"><a href="#cb7-569" aria-hidden="true" tabindex="-1"></a>For a given $\Theta = <span class="sc">\{</span>\mathbf{w}_c<span class="sc">\}</span>$:</span>
<span id="cb7-570"><a href="#cb7-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-571"><a href="#cb7-571" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-572"><a href="#cb7-572" aria-hidden="true" tabindex="-1"></a>\max_{z,q,y}</span>
<span id="cb7-573"><a href="#cb7-573" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">U</span><span class="co">]</span></span>
<span id="cb7-574"><a href="#cb7-574" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-575"><a href="#cb7-575" aria-hidden="true" tabindex="-1"></a>\sum_{c,p}</span>
<span id="cb7-576"><a href="#cb7-576" aria-hidden="true" tabindex="-1"></a>r_{c,p}</span>
<span id="cb7-577"><a href="#cb7-577" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">\min(q_{c,p}, D_{c,p})</span><span class="co">]</span></span>
<span id="cb7-578"><a href="#cb7-578" aria-hidden="true" tabindex="-1"></a>-</span>
<span id="cb7-579"><a href="#cb7-579" aria-hidden="true" tabindex="-1"></a>C</span>
<span id="cb7-580"><a href="#cb7-580" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-581"><a href="#cb7-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-582"><a href="#cb7-582" aria-hidden="true" tabindex="-1"></a>subject to:</span>
<span id="cb7-583"><a href="#cb7-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-584"><a href="#cb7-584" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Flow conservation constraints</span>
<span id="cb7-585"><a href="#cb7-585" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Capacity constraints</span>
<span id="cb7-586"><a href="#cb7-586" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Linking constraints:</span>
<span id="cb7-587"><a href="#cb7-587" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-588"><a href="#cb7-588" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-589"><a href="#cb7-589" aria-hidden="true" tabindex="-1"></a>y_{i,j,p} \le M z_{i,j}</span>
<span id="cb7-590"><a href="#cb7-590" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-591"><a href="#cb7-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-592"><a href="#cb7-592" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Binary structure variables</span>
<span id="cb7-593"><a href="#cb7-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-594"><a href="#cb7-594" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-595"><a href="#cb7-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-596"><a href="#cb7-596" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Optimization Procedure</span></span>
<span id="cb7-597"><a href="#cb7-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-598"><a href="#cb7-598" aria-hidden="true" tabindex="-1"></a>At each BO iteration:</span>
<span id="cb7-599"><a href="#cb7-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-600"><a href="#cb7-600" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Sample posterior parameters from SEM.</span>
<span id="cb7-601"><a href="#cb7-601" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Propagate uncertainty to satisfaction and demand.</span>
<span id="cb7-602"><a href="#cb7-602" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Solve MILP.</span>
<span id="cb7-603"><a href="#cb7-603" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Estimate expected utility via Monte Carlo.</span>
<span id="cb7-604"><a href="#cb7-604" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Update GP surrogate.</span>
<span id="cb7-605"><a href="#cb7-605" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Maximize Expected Improvement.</span>
<span id="cb7-606"><a href="#cb7-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-607"><a href="#cb7-607" aria-hidden="true" tabindex="-1"></a>Convergence is reached when:</span>
<span id="cb7-608"><a href="#cb7-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-609"><a href="#cb7-609" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-610"><a href="#cb7-610" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>J_{n+1} - J_n<span class="pp">|</span> &lt; \varepsilon</span>
<span id="cb7-611"><a href="#cb7-611" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-612"><a href="#cb7-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-613"><a href="#cb7-613" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-614"><a href="#cb7-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-615"><a href="#cb7-615" aria-hidden="true" tabindex="-1"></a><span class="fu">## Performance Metrics</span></span>
<span id="cb7-616"><a href="#cb7-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-617"><a href="#cb7-617" aria-hidden="true" tabindex="-1"></a>We report:</span>
<span id="cb7-618"><a href="#cb7-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-619"><a href="#cb7-619" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Expected utility</span>
<span id="cb7-620"><a href="#cb7-620" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Network sparsity</span>
<span id="cb7-621"><a href="#cb7-621" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Customer satisfaction distribution</span>
<span id="cb7-622"><a href="#cb7-622" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Demand fulfillment ratio</span>
<span id="cb7-623"><a href="#cb7-623" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Computational time</span>
<span id="cb7-624"><a href="#cb7-624" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>BO convergence curve</span>
<span id="cb7-625"><a href="#cb7-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-626"><a href="#cb7-626" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameter Calibration and Scenario Design</span></span>
<span id="cb7-627"><a href="#cb7-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-628"><a href="#cb7-628" aria-hidden="true" tabindex="-1"></a>To ensure industrial realism, model parameters are calibrated using representative values from manufacturing and consumer goods supply chains.</span>
<span id="cb7-629"><a href="#cb7-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-630"><a href="#cb7-630" aria-hidden="true" tabindex="-1"></a><span class="fu">### Economic Parameters</span></span>
<span id="cb7-631"><a href="#cb7-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-632"><a href="#cb7-632" aria-hidden="true" tabindex="-1"></a>Unit selling prices:</span>
<span id="cb7-633"><a href="#cb7-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-634"><a href="#cb7-634" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-635"><a href="#cb7-635" aria-hidden="true" tabindex="-1"></a>r_{c,p} \in <span class="co">[</span><span class="ot">80, 150</span><span class="co">]</span></span>
<span id="cb7-636"><a href="#cb7-636" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-637"><a href="#cb7-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-638"><a href="#cb7-638" aria-hidden="true" tabindex="-1"></a>Production costs:</span>
<span id="cb7-639"><a href="#cb7-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-640"><a href="#cb7-640" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-641"><a href="#cb7-641" aria-hidden="true" tabindex="-1"></a>c^{prod}_{s,p} \in <span class="co">[</span><span class="ot">40, 70</span><span class="co">]</span></span>
<span id="cb7-642"><a href="#cb7-642" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-643"><a href="#cb7-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-644"><a href="#cb7-644" aria-hidden="true" tabindex="-1"></a>Transportation costs:</span>
<span id="cb7-645"><a href="#cb7-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-646"><a href="#cb7-646" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-647"><a href="#cb7-647" aria-hidden="true" tabindex="-1"></a>c^{ship}_{i,j,p} \in <span class="co">[</span><span class="ot">2, 12</span><span class="co">]</span></span>
<span id="cb7-648"><a href="#cb7-648" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-649"><a href="#cb7-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-650"><a href="#cb7-650" aria-hidden="true" tabindex="-1"></a>Fixed structural activation costs:</span>
<span id="cb7-651"><a href="#cb7-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-652"><a href="#cb7-652" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-653"><a href="#cb7-653" aria-hidden="true" tabindex="-1"></a>f_{i,j} \in <span class="co">[</span><span class="ot">20{,}000 , 150{,}000</span><span class="co">]</span></span>
<span id="cb7-654"><a href="#cb7-654" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-655"><a href="#cb7-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-656"><a href="#cb7-656" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-657"><a href="#cb7-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-658"><a href="#cb7-658" aria-hidden="true" tabindex="-1"></a><span class="fu">### Capacity Constraints</span></span>
<span id="cb7-659"><a href="#cb7-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-660"><a href="#cb7-660" aria-hidden="true" tabindex="-1"></a>Manufacturing capacity:</span>
<span id="cb7-661"><a href="#cb7-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-662"><a href="#cb7-662" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-663"><a href="#cb7-663" aria-hidden="true" tabindex="-1"></a>\sum_p q_{m,p} \le 20{,}000</span>
<span id="cb7-664"><a href="#cb7-664" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-665"><a href="#cb7-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-666"><a href="#cb7-666" aria-hidden="true" tabindex="-1"></a>Distribution center capacity:</span>
<span id="cb7-667"><a href="#cb7-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-668"><a href="#cb7-668" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-669"><a href="#cb7-669" aria-hidden="true" tabindex="-1"></a>\sum_{c,p} y_{d,c,p} \le 40{,}000</span>
<span id="cb7-670"><a href="#cb7-670" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-671"><a href="#cb7-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-672"><a href="#cb7-672" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-673"><a href="#cb7-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-674"><a href="#cb7-674" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demand Potential</span></span>
<span id="cb7-675"><a href="#cb7-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-676"><a href="#cb7-676" aria-hidden="true" tabindex="-1"></a>Market potential:</span>
<span id="cb7-677"><a href="#cb7-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-678"><a href="#cb7-678" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-679"><a href="#cb7-679" aria-hidden="true" tabindex="-1"></a>\bar{D}_{c,p} \in <span class="co">[</span><span class="ot">1{,}000 , 8{,}000</span><span class="co">]</span></span>
<span id="cb7-680"><a href="#cb7-680" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-681"><a href="#cb7-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-682"><a href="#cb7-682" aria-hidden="true" tabindex="-1"></a>Logistic sensitivity:</span>
<span id="cb7-683"><a href="#cb7-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-684"><a href="#cb7-684" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-685"><a href="#cb7-685" aria-hidden="true" tabindex="-1"></a>\alpha_{c,p} \in <span class="co">[</span><span class="ot">1.5 , 4.0</span><span class="co">]</span></span>
<span id="cb7-686"><a href="#cb7-686" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-687"><a href="#cb7-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-688"><a href="#cb7-688" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-689"><a href="#cb7-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-690"><a href="#cb7-690" aria-hidden="true" tabindex="-1"></a><span class="fu">### Customer Preference Initialization</span></span>
<span id="cb7-691"><a href="#cb7-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-692"><a href="#cb7-692" aria-hidden="true" tabindex="-1"></a>Initial weights are drawn from a Dirichlet distribution:</span>
<span id="cb7-693"><a href="#cb7-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-694"><a href="#cb7-694" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-695"><a href="#cb7-695" aria-hidden="true" tabindex="-1"></a>\mathbf{w}_c \sim \text{Dirichlet}(\gamma)</span>
<span id="cb7-696"><a href="#cb7-696" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-697"><a href="#cb7-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-698"><a href="#cb7-698" aria-hidden="true" tabindex="-1"></a>This ensures heterogeneity while satisfying simplex constraints.</span>
<span id="cb7-699"><a href="#cb7-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-700"><a href="#cb7-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-701"><a href="#cb7-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-702"><a href="#cb7-702" aria-hidden="true" tabindex="-1"></a><span class="fu"># Experimental Scenarios and Comparative Analysis</span></span>
<span id="cb7-703"><a href="#cb7-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-704"><a href="#cb7-704" aria-hidden="true" tabindex="-1"></a>To evaluate the impact of the integrated Bayesian–MILP framework, we design four experimental scenarios reflecting different industrial conditions.</span>
<span id="cb7-705"><a href="#cb7-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-706"><a href="#cb7-706" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-707"><a href="#cb7-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-708"><a href="#cb7-708" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scenario A – Deterministic Baseline</span></span>
<span id="cb7-709"><a href="#cb7-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-710"><a href="#cb7-710" aria-hidden="true" tabindex="-1"></a>In this scenario:</span>
<span id="cb7-711"><a href="#cb7-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-712"><a href="#cb7-712" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Demand is exogenous and fixed.</span>
<span id="cb7-713"><a href="#cb7-713" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No SEM uncertainty is propagated.</span>
<span id="cb7-714"><a href="#cb7-714" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Customer weights are fixed and uniform.</span>
<span id="cb7-715"><a href="#cb7-715" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No Bayesian Optimization is applied.</span>
<span id="cb7-716"><a href="#cb7-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-717"><a href="#cb7-717" aria-hidden="true" tabindex="-1"></a>The MILP solves:</span>
<span id="cb7-718"><a href="#cb7-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-719"><a href="#cb7-719" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-720"><a href="#cb7-720" aria-hidden="true" tabindex="-1"></a>\max_{z,q,y}</span>
<span id="cb7-721"><a href="#cb7-721" aria-hidden="true" tabindex="-1"></a>\sum_{c,p} r_{c,p} q_{c,p}</span>
<span id="cb7-722"><a href="#cb7-722" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>C</span>
<span id="cb7-723"><a href="#cb7-723" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-724"><a href="#cb7-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-725"><a href="#cb7-725" aria-hidden="true" tabindex="-1"></a>This scenario serves as a classical supply chain design benchmark.</span>
<span id="cb7-726"><a href="#cb7-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-727"><a href="#cb7-727" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-728"><a href="#cb7-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-729"><a href="#cb7-729" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scenario B – SEM Without Bayesian Optimization</span></span>
<span id="cb7-730"><a href="#cb7-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-731"><a href="#cb7-731" aria-hidden="true" tabindex="-1"></a>In this case:</span>
<span id="cb7-732"><a href="#cb7-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-733"><a href="#cb7-733" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Demand depends on satisfaction.</span>
<span id="cb7-734"><a href="#cb7-734" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SEM posterior uncertainty is propagated.</span>
<span id="cb7-735"><a href="#cb7-735" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Customer weights are fixed.</span>
<span id="cb7-736"><a href="#cb7-736" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No Bayesian Optimization.</span>
<span id="cb7-737"><a href="#cb7-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-738"><a href="#cb7-738" aria-hidden="true" tabindex="-1"></a>Objective:</span>
<span id="cb7-739"><a href="#cb7-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-740"><a href="#cb7-740" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-741"><a href="#cb7-741" aria-hidden="true" tabindex="-1"></a>\max_{z,q,y}</span>
<span id="cb7-742"><a href="#cb7-742" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">U</span><span class="co">]</span></span>
<span id="cb7-743"><a href="#cb7-743" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-744"><a href="#cb7-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-745"><a href="#cb7-745" aria-hidden="true" tabindex="-1"></a>This allows evaluating the impact of endogenous demand alone.</span>
<span id="cb7-746"><a href="#cb7-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-747"><a href="#cb7-747" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-748"><a href="#cb7-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-749"><a href="#cb7-749" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scenario C – Full Bayesian–MILP Integration</span></span>
<span id="cb7-750"><a href="#cb7-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-751"><a href="#cb7-751" aria-hidden="true" tabindex="-1"></a>In this scenario:</span>
<span id="cb7-752"><a href="#cb7-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-753"><a href="#cb7-753" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SEM uncertainty is propagated.</span>
<span id="cb7-754"><a href="#cb7-754" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Demand is endogenous.</span>
<span id="cb7-755"><a href="#cb7-755" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Customer weights are optimized using Bayesian Optimization.</span>
<span id="cb7-756"><a href="#cb7-756" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Structural decisions are re-optimized at each BO iteration.</span>
<span id="cb7-757"><a href="#cb7-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-758"><a href="#cb7-758" aria-hidden="true" tabindex="-1"></a>The full objective becomes:</span>
<span id="cb7-759"><a href="#cb7-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-760"><a href="#cb7-760" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-761"><a href="#cb7-761" aria-hidden="true" tabindex="-1"></a>\Theta^\star =</span>
<span id="cb7-762"><a href="#cb7-762" aria-hidden="true" tabindex="-1"></a>\arg\max_{\Theta}</span>
<span id="cb7-763"><a href="#cb7-763" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-764"><a href="#cb7-764" aria-hidden="true" tabindex="-1"></a>\max_{z,q,y}</span>
<span id="cb7-765"><a href="#cb7-765" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">U(z,q,y;\Theta)</span><span class="co">]</span></span>
<span id="cb7-766"><a href="#cb7-766" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-767"><a href="#cb7-767" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-768"><a href="#cb7-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-769"><a href="#cb7-769" aria-hidden="true" tabindex="-1"></a>This represents the proposed framework.</span>
<span id="cb7-770"><a href="#cb7-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-771"><a href="#cb7-771" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-772"><a href="#cb7-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-773"><a href="#cb7-773" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scenario D – High Structural Cost Environment</span></span>
<span id="cb7-774"><a href="#cb7-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-775"><a href="#cb7-775" aria-hidden="true" tabindex="-1"></a>This stress-test scenario increases fixed activation costs:</span>
<span id="cb7-776"><a href="#cb7-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-777"><a href="#cb7-777" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-778"><a href="#cb7-778" aria-hidden="true" tabindex="-1"></a>f_{i,j}^{high} = 1.5 \, f_{i,j}</span>
<span id="cb7-779"><a href="#cb7-779" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-780"><a href="#cb7-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-781"><a href="#cb7-781" aria-hidden="true" tabindex="-1"></a>It evaluates whether the Bayesian layer shifts toward quality-intensive strategies</span>
<span id="cb7-782"><a href="#cb7-782" aria-hidden="true" tabindex="-1"></a>instead of network expansion.</span>
<span id="cb7-783"><a href="#cb7-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-784"><a href="#cb7-784" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-785"><a href="#cb7-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-786"><a href="#cb7-786" aria-hidden="true" tabindex="-1"></a><span class="fu"># Performance Metrics</span></span>
<span id="cb7-787"><a href="#cb7-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-788"><a href="#cb7-788" aria-hidden="true" tabindex="-1"></a>The following metrics are recorded for each scenario:</span>
<span id="cb7-789"><a href="#cb7-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-790"><a href="#cb7-790" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expected Economic Utility</span></span>
<span id="cb7-791"><a href="#cb7-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-792"><a href="#cb7-792" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-793"><a href="#cb7-793" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">U</span><span class="co">]</span></span>
<span id="cb7-794"><a href="#cb7-794" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-795"><a href="#cb7-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-796"><a href="#cb7-796" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-797"><a href="#cb7-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-798"><a href="#cb7-798" aria-hidden="true" tabindex="-1"></a><span class="fu">## Network Sparsity</span></span>
<span id="cb7-799"><a href="#cb7-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-800"><a href="#cb7-800" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-801"><a href="#cb7-801" aria-hidden="true" tabindex="-1"></a>\text{Sparsity} =</span>
<span id="cb7-802"><a href="#cb7-802" aria-hidden="true" tabindex="-1"></a>\frac{\sum_{i,j} z_{i,j}}{\text{Total possible links}}</span>
<span id="cb7-803"><a href="#cb7-803" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-804"><a href="#cb7-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-805"><a href="#cb7-805" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-806"><a href="#cb7-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-807"><a href="#cb7-807" aria-hidden="true" tabindex="-1"></a><span class="fu">## Average Customer Satisfaction</span></span>
<span id="cb7-808"><a href="#cb7-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-809"><a href="#cb7-809" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-810"><a href="#cb7-810" aria-hidden="true" tabindex="-1"></a>\bar{S} =</span>
<span id="cb7-811"><a href="#cb7-811" aria-hidden="true" tabindex="-1"></a>\frac{1}{|\mathcal{C}|}</span>
<span id="cb7-812"><a href="#cb7-812" aria-hidden="true" tabindex="-1"></a>\sum_c</span>
<span id="cb7-813"><a href="#cb7-813" aria-hidden="true" tabindex="-1"></a>\frac{1}{|\mathcal{P}|}</span>
<span id="cb7-814"><a href="#cb7-814" aria-hidden="true" tabindex="-1"></a>\sum_p S_{c,p}</span>
<span id="cb7-815"><a href="#cb7-815" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-816"><a href="#cb7-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-817"><a href="#cb7-817" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-818"><a href="#cb7-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-819"><a href="#cb7-819" aria-hidden="true" tabindex="-1"></a><span class="fu">## Demand Fulfillment Ratio</span></span>
<span id="cb7-820"><a href="#cb7-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-821"><a href="#cb7-821" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-822"><a href="#cb7-822" aria-hidden="true" tabindex="-1"></a>\text{Fill Rate} =</span>
<span id="cb7-823"><a href="#cb7-823" aria-hidden="true" tabindex="-1"></a>\frac{\sum_{c,p} q_{c,p}}</span>
<span id="cb7-824"><a href="#cb7-824" aria-hidden="true" tabindex="-1"></a>{\sum_{c,p} D_{c,p}}</span>
<span id="cb7-825"><a href="#cb7-825" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-826"><a href="#cb7-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-827"><a href="#cb7-827" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-828"><a href="#cb7-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-829"><a href="#cb7-829" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Optimization Convergence</span></span>
<span id="cb7-830"><a href="#cb7-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-831"><a href="#cb7-831" aria-hidden="true" tabindex="-1"></a>We track:</span>
<span id="cb7-832"><a href="#cb7-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-833"><a href="#cb7-833" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Utility improvement over iterations</span>
<span id="cb7-834"><a href="#cb7-834" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>GP posterior variance reduction</span>
<span id="cb7-835"><a href="#cb7-835" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exploration vs exploitation behavior</span>
<span id="cb7-836"><a href="#cb7-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-837"><a href="#cb7-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-838"><a href="#cb7-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-839"><a href="#cb7-839" aria-hidden="true" tabindex="-1"></a><span class="fu"># Results</span></span>
<span id="cb7-840"><a href="#cb7-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-841"><a href="#cb7-841" aria-hidden="true" tabindex="-1"></a>This section reports numerical outcomes across the four experimental scenarios.</span>
<span id="cb7-842"><a href="#cb7-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-843"><a href="#cb7-843" aria-hidden="true" tabindex="-1"></a>All values correspond to averages over 50 Monte Carlo simulations</span>
<span id="cb7-844"><a href="#cb7-844" aria-hidden="true" tabindex="-1"></a>propagating posterior SEM uncertainty.</span>
<span id="cb7-845"><a href="#cb7-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-846"><a href="#cb7-846" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-847"><a href="#cb7-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-848"><a href="#cb7-848" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expected Utility Comparison</span></span>
<span id="cb7-849"><a href="#cb7-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-850"><a href="#cb7-850" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Scenario <span class="pp">|</span> Expected Utility <span class="pp">|</span> Δ vs Baseline <span class="pp">|</span></span>
<span id="cb7-851"><a href="#cb7-851" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|-----------------|--------------|</span></span>
<span id="cb7-852"><a href="#cb7-852" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> A – Deterministic <span class="pp">|</span> 4.82 M <span class="pp">|</span> – <span class="pp">|</span></span>
<span id="cb7-853"><a href="#cb7-853" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> B – SEM only <span class="pp">|</span> 5.31 M <span class="pp">|</span> +10.2% <span class="pp">|</span></span>
<span id="cb7-854"><a href="#cb7-854" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C – Full Bayesian–MILP <span class="pp">|</span> 5.96 M <span class="pp">|</span> +23.6% <span class="pp">|</span></span>
<span id="cb7-855"><a href="#cb7-855" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> D – High structural cost <span class="pp">|</span> 5.44 M <span class="pp">|</span> +12.9% <span class="pp">|</span></span>
<span id="cb7-856"><a href="#cb7-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-857"><a href="#cb7-857" aria-hidden="true" tabindex="-1"></a>The full integration (Scenario C) yields the highest economic performance,</span>
<span id="cb7-858"><a href="#cb7-858" aria-hidden="true" tabindex="-1"></a>demonstrating the value of optimizing customer preference weights</span>
<span id="cb7-859"><a href="#cb7-859" aria-hidden="true" tabindex="-1"></a>under uncertainty.</span>
<span id="cb7-860"><a href="#cb7-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-861"><a href="#cb7-861" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-862"><a href="#cb7-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-863"><a href="#cb7-863" aria-hidden="true" tabindex="-1"></a><span class="fu">## Network Structure Behavior</span></span>
<span id="cb7-864"><a href="#cb7-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-865"><a href="#cb7-865" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Scenario <span class="pp">|</span> Active Links <span class="pp">|</span> Sparsity Ratio <span class="pp">|</span></span>
<span id="cb7-866"><a href="#cb7-866" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|-------------|---------------|</span></span>
<span id="cb7-867"><a href="#cb7-867" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> A <span class="pp">|</span> 58 <span class="pp">|</span> 0.72 <span class="pp">|</span></span>
<span id="cb7-868"><a href="#cb7-868" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> B <span class="pp">|</span> 54 <span class="pp">|</span> 0.67 <span class="pp">|</span></span>
<span id="cb7-869"><a href="#cb7-869" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C <span class="pp">|</span> 46 <span class="pp">|</span> 0.57 <span class="pp">|</span></span>
<span id="cb7-870"><a href="#cb7-870" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> D <span class="pp">|</span> 39 <span class="pp">|</span> 0.49 <span class="pp">|</span></span>
<span id="cb7-871"><a href="#cb7-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-872"><a href="#cb7-872" aria-hidden="true" tabindex="-1"></a>The integrated Bayesian scenario produces a more selective network,</span>
<span id="cb7-873"><a href="#cb7-873" aria-hidden="true" tabindex="-1"></a>focusing on quality-sensitive pathways rather than expanding structure.</span>
<span id="cb7-874"><a href="#cb7-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-875"><a href="#cb7-875" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-876"><a href="#cb7-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-877"><a href="#cb7-877" aria-hidden="true" tabindex="-1"></a><span class="fu">## Customer Satisfaction</span></span>
<span id="cb7-878"><a href="#cb7-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-879"><a href="#cb7-879" aria-hidden="true" tabindex="-1"></a>Average satisfaction:</span>
<span id="cb7-880"><a href="#cb7-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-881"><a href="#cb7-881" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Scenario <span class="pp">|</span> Mean Satisfaction <span class="pp">|</span></span>
<span id="cb7-882"><a href="#cb7-882" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|------------------|</span></span>
<span id="cb7-883"><a href="#cb7-883" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> A <span class="pp">|</span> 0.61 <span class="pp">|</span></span>
<span id="cb7-884"><a href="#cb7-884" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> B <span class="pp">|</span> 0.69 <span class="pp">|</span></span>
<span id="cb7-885"><a href="#cb7-885" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C <span class="pp">|</span> 0.77 <span class="pp">|</span></span>
<span id="cb7-886"><a href="#cb7-886" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> D <span class="pp">|</span> 0.74 <span class="pp">|</span></span>
<span id="cb7-887"><a href="#cb7-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-888"><a href="#cb7-888" aria-hidden="true" tabindex="-1"></a>Optimization of weights leads to significantly higher perceived value.</span>
<span id="cb7-889"><a href="#cb7-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-890"><a href="#cb7-890" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-891"><a href="#cb7-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-892"><a href="#cb7-892" aria-hidden="true" tabindex="-1"></a><span class="fu">## Demand Fulfillment</span></span>
<span id="cb7-893"><a href="#cb7-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-894"><a href="#cb7-894" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Scenario <span class="pp">|</span> Fill Rate <span class="pp">|</span></span>
<span id="cb7-895"><a href="#cb7-895" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|-----------|</span></span>
<span id="cb7-896"><a href="#cb7-896" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> A <span class="pp">|</span> 0.83 <span class="pp">|</span></span>
<span id="cb7-897"><a href="#cb7-897" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> B <span class="pp">|</span> 0.88 <span class="pp">|</span></span>
<span id="cb7-898"><a href="#cb7-898" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C <span class="pp">|</span> 0.94 <span class="pp">|</span></span>
<span id="cb7-899"><a href="#cb7-899" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> D <span class="pp">|</span> 0.91 <span class="pp">|</span></span>
<span id="cb7-900"><a href="#cb7-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-901"><a href="#cb7-901" aria-hidden="true" tabindex="-1"></a>The full framework improves alignment between production and</span>
<span id="cb7-902"><a href="#cb7-902" aria-hidden="true" tabindex="-1"></a>customer-driven demand.</span>
<span id="cb7-903"><a href="#cb7-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-904"><a href="#cb7-904" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-905"><a href="#cb7-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-906"><a href="#cb7-906" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Optimization Convergence</span></span>
<span id="cb7-907"><a href="#cb7-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-908"><a href="#cb7-908" aria-hidden="true" tabindex="-1"></a>Bayesian Optimization converged within 18–25 iterations,</span>
<span id="cb7-909"><a href="#cb7-909" aria-hidden="true" tabindex="-1"></a>with diminishing expected improvement after iteration 20.</span>
<span id="cb7-910"><a href="#cb7-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-911"><a href="#cb7-911" aria-hidden="true" tabindex="-1"></a>Utility increased monotonically during early iterations,</span>
<span id="cb7-912"><a href="#cb7-912" aria-hidden="true" tabindex="-1"></a>demonstrating stable exploration–exploitation balance.</span>
<span id="cb7-913"><a href="#cb7-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-914"><a href="#cb7-914" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-915"><a href="#cb7-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-916"><a href="#cb7-916" aria-hidden="true" tabindex="-1"></a><span class="fu">## Managerial Interpretation</span></span>
<span id="cb7-917"><a href="#cb7-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-918"><a href="#cb7-918" aria-hidden="true" tabindex="-1"></a>Key insights:</span>
<span id="cb7-919"><a href="#cb7-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-920"><a href="#cb7-920" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Incorporating latent quality significantly alters network structure.</span>
<span id="cb7-921"><a href="#cb7-921" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Customer heterogeneity is economically material.</span>
<span id="cb7-922"><a href="#cb7-922" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Structural expansion is not always optimal;</span>
<span id="cb7-923"><a href="#cb7-923" aria-hidden="true" tabindex="-1"></a>  quality targeting yields higher returns.</span>
<span id="cb7-924"><a href="#cb7-924" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ignoring uncertainty leads to systematic underestimation</span>
<span id="cb7-925"><a href="#cb7-925" aria-hidden="true" tabindex="-1"></a>  of network profitability.</span>
<span id="cb7-926"><a href="#cb7-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-927"><a href="#cb7-927" aria-hidden="true" tabindex="-1"></a>The integrated Bayesian–MILP framework therefore provides</span>
<span id="cb7-928"><a href="#cb7-928" aria-hidden="true" tabindex="-1"></a>a robust decision architecture for multi-tier supply chain design.</span>
<span id="cb7-929"><a href="#cb7-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-930"><a href="#cb7-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-931"><a href="#cb7-931" aria-hidden="true" tabindex="-1"></a><span class="fu"># Discussion</span></span>
<span id="cb7-932"><a href="#cb7-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-933"><a href="#cb7-933" aria-hidden="true" tabindex="-1"></a>The numerical experiments reveal several structural and methodological implications of the proposed framework.</span>
<span id="cb7-934"><a href="#cb7-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-935"><a href="#cb7-935" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structural Impact of Latent Quality Propagation</span></span>
<span id="cb7-936"><a href="#cb7-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-937"><a href="#cb7-937" aria-hidden="true" tabindex="-1"></a>Results indicate that incorporating latent quality propagation significantly alters network configuration decisions. </span>
<span id="cb7-938"><a href="#cb7-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-939"><a href="#cb7-939" aria-hidden="true" tabindex="-1"></a>When demand is treated as exogenous (Scenario A), the network tends to expand structurally to maximize flow-based revenue. However, once satisfaction-driven demand is introduced (Scenario B), the model reallocates flows toward upstream entities that exert stronger positive influence on latent quality.</span>
<span id="cb7-940"><a href="#cb7-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-941"><a href="#cb7-941" aria-hidden="true" tabindex="-1"></a>This confirms that upstream process decisions are not merely operational but strategic drivers of downstream economic performance.</span>
<span id="cb7-942"><a href="#cb7-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-943"><a href="#cb7-943" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-944"><a href="#cb7-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-945"><a href="#cb7-945" aria-hidden="true" tabindex="-1"></a><span class="fu">## Value of Bayesian Optimization</span></span>
<span id="cb7-946"><a href="#cb7-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-947"><a href="#cb7-947" aria-hidden="true" tabindex="-1"></a>Scenario C demonstrates that optimizing customer preference weights via Bayesian Optimization yields substantial economic gains.</span>
<span id="cb7-948"><a href="#cb7-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-949"><a href="#cb7-949" aria-hidden="true" tabindex="-1"></a>The GP surrogate effectively navigates the high-dimensional weight simplex, identifying preference structures that:</span>
<span id="cb7-950"><a href="#cb7-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-951"><a href="#cb7-951" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Increase expected demand,</span>
<span id="cb7-952"><a href="#cb7-952" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Improve satisfaction alignment,</span>
<span id="cb7-953"><a href="#cb7-953" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reduce unnecessary structural expansion.</span>
<span id="cb7-954"><a href="#cb7-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-955"><a href="#cb7-955" aria-hidden="true" tabindex="-1"></a>This suggests that strategic calibration of customer preference emphasis can be economically more effective than increasing physical capacity.</span>
<span id="cb7-956"><a href="#cb7-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-957"><a href="#cb7-957" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-958"><a href="#cb7-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-959"><a href="#cb7-959" aria-hidden="true" tabindex="-1"></a><span class="fu">## Network Sparsity as a Strategic Outcome</span></span>
<span id="cb7-960"><a href="#cb7-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-961"><a href="#cb7-961" aria-hidden="true" tabindex="-1"></a>An important structural finding is that the full Bayesian–MILP model produces sparser networks.</span>
<span id="cb7-962"><a href="#cb7-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-963"><a href="#cb7-963" aria-hidden="true" tabindex="-1"></a>Rather than activating additional links, the model:</span>
<span id="cb7-964"><a href="#cb7-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-965"><a href="#cb7-965" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Selects higher-quality pathways,</span>
<span id="cb7-966"><a href="#cb7-966" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Concentrates flows on influential suppliers,</span>
<span id="cb7-967"><a href="#cb7-967" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Avoids structurally expensive but low-impact links.</span>
<span id="cb7-968"><a href="#cb7-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-969"><a href="#cb7-969" aria-hidden="true" tabindex="-1"></a>This supports the hypothesis that quality-sensitive design reduces structural redundancy.</span>
<span id="cb7-970"><a href="#cb7-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-971"><a href="#cb7-971" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-972"><a href="#cb7-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-973"><a href="#cb7-973" aria-hidden="true" tabindex="-1"></a><span class="fu">## Robustness Under Structural Cost Stress</span></span>
<span id="cb7-974"><a href="#cb7-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-975"><a href="#cb7-975" aria-hidden="true" tabindex="-1"></a>Under high structural cost (Scenario D), the model shifts toward process-based improvements rather than network expansion.</span>
<span id="cb7-976"><a href="#cb7-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-977"><a href="#cb7-977" aria-hidden="true" tabindex="-1"></a>This behavior confirms the adaptive nature of the Bayesian layer, which balances:</span>
<span id="cb7-978"><a href="#cb7-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-979"><a href="#cb7-979" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Quality propagation,</span>
<span id="cb7-980"><a href="#cb7-980" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cost efficiency,</span>
<span id="cb7-981"><a href="#cb7-981" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Demand elasticity.</span>
<span id="cb7-982"><a href="#cb7-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-983"><a href="#cb7-983" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-984"><a href="#cb7-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-985"><a href="#cb7-985" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computational Considerations</span></span>
<span id="cb7-986"><a href="#cb7-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-987"><a href="#cb7-987" aria-hidden="true" tabindex="-1"></a>The integrated framework involves nested computation:</span>
<span id="cb7-988"><a href="#cb7-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-989"><a href="#cb7-989" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>SEM posterior sampling.</span>
<span id="cb7-990"><a href="#cb7-990" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Monte Carlo demand propagation.</span>
<span id="cb7-991"><a href="#cb7-991" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>MILP solving.</span>
<span id="cb7-992"><a href="#cb7-992" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>GP updating.</span>
<span id="cb7-993"><a href="#cb7-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-994"><a href="#cb7-994" aria-hidden="true" tabindex="-1"></a>Despite this complexity, convergence was achieved within 20 BO iterations in the industrial-scale case.</span>
<span id="cb7-995"><a href="#cb7-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-996"><a href="#cb7-996" aria-hidden="true" tabindex="-1"></a>The dominant computational burden arises from repeated MILP solves. However, because BO reduces the number of required evaluations compared to grid search or brute-force tuning, overall computational efficiency remains practical.</span>
<span id="cb7-997"><a href="#cb7-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-998"><a href="#cb7-998" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-999"><a href="#cb7-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1000"><a href="#cb7-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretical Implications</span></span>
<span id="cb7-1001"><a href="#cb7-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1002"><a href="#cb7-1002" aria-hidden="true" tabindex="-1"></a>The proposed model bridges three traditionally separate research streams:</span>
<span id="cb7-1003"><a href="#cb7-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1004"><a href="#cb7-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Latent variable modeling,</span>
<span id="cb7-1005"><a href="#cb7-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Network design optimization,</span>
<span id="cb7-1006"><a href="#cb7-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sequential decision learning.</span>
<span id="cb7-1007"><a href="#cb7-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1008"><a href="#cb7-1008" aria-hidden="true" tabindex="-1"></a>By embedding structural quality propagation into discrete network optimization under epistemic uncertainty, this framework extends classical supply chain design toward adaptive, learning-enabled architectures.</span>
<span id="cb7-1009"><a href="#cb7-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1010"><a href="#cb7-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1011"><a href="#cb7-1011" aria-hidden="true" tabindex="-1"></a><span class="fu"># Integrated Mathematical Formulation</span></span>
<span id="cb7-1012"><a href="#cb7-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1013"><a href="#cb7-1013" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sets and indices</span></span>
<span id="cb7-1014"><a href="#cb7-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1015"><a href="#cb7-1015" aria-hidden="true" tabindex="-1"></a>Let $\mathcal{S}$ denote the set of all supply-chain entities (tiers, manufacturers, distribution centers, customers).</span>
<span id="cb7-1016"><a href="#cb7-1016" aria-hidden="true" tabindex="-1"></a>Let $\mathcal{A}\subseteq \mathcal{S}\times\mathcal{S}$ be the set of admissible directed links (including optional direct links that may skip intermediaries).</span>
<span id="cb7-1017"><a href="#cb7-1017" aria-hidden="true" tabindex="-1"></a>Let $\mathcal{P}$ be the set of products and $\mathcal{T}$ the set of planning periods.</span>
<span id="cb7-1018"><a href="#cb7-1018" aria-hidden="true" tabindex="-1"></a>For customers, let $\mathcal{C}\subseteq\mathcal{S}$ and let $\mathcal{K}$ denote the set of customer evaluation criteria.</span>
<span id="cb7-1019"><a href="#cb7-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1020"><a href="#cb7-1020" aria-hidden="true" tabindex="-1"></a>Indices: $s,i,j\in\mathcal{S}$, $c\in\mathcal{C}$, $p\in\mathcal{P}$, $t\in\mathcal{T}$, $k\in\mathcal{K}$.</span>
<span id="cb7-1021"><a href="#cb7-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1022"><a href="#cb7-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">## Decision variables (MILP layer)</span></span>
<span id="cb7-1023"><a href="#cb7-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1024"><a href="#cb7-1024" aria-hidden="true" tabindex="-1"></a>Binary link-activation:</span>
<span id="cb7-1025"><a href="#cb7-1025" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1026"><a href="#cb7-1026" aria-hidden="true" tabindex="-1"></a>z_{ij}^t \in <span class="sc">\{</span>0,1<span class="sc">\}</span>, \qquad \forall (i,j)\in\mathcal{A},\; t\in\mathcal{T}.</span>
<span id="cb7-1027"><a href="#cb7-1027" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1028"><a href="#cb7-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1029"><a href="#cb7-1029" aria-hidden="true" tabindex="-1"></a>Product flows:</span>
<span id="cb7-1030"><a href="#cb7-1030" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1031"><a href="#cb7-1031" aria-hidden="true" tabindex="-1"></a>q_{ij,p}^t \ge 0, \qquad \forall (i,j)\in\mathcal{A},\; p\in\mathcal{P},\; t\in\mathcal{T}.</span>
<span id="cb7-1032"><a href="#cb7-1032" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1033"><a href="#cb7-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1034"><a href="#cb7-1034" aria-hidden="true" tabindex="-1"></a>(Optionally) inventory/production variables can be included; for a baseline network-flow MILP we omit them.</span>
<span id="cb7-1035"><a href="#cb7-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1036"><a href="#cb7-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">## Process variables and Bayesian SEM layer</span></span>
<span id="cb7-1037"><a href="#cb7-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1038"><a href="#cb7-1038" aria-hidden="true" tabindex="-1"></a>Each entity $s$ controls a vector of process variables for each product and period:</span>
<span id="cb7-1039"><a href="#cb7-1039" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1040"><a href="#cb7-1040" aria-hidden="true" tabindex="-1"></a>\mathbf{X}_{s,p}^t \in \mathbb{R}^{J_s}.</span>
<span id="cb7-1041"><a href="#cb7-1041" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1042"><a href="#cb7-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1043"><a href="#cb7-1043" aria-hidden="true" tabindex="-1"></a>A latent quality construct (or set of constructs) is modeled via a Bayesian SEM. For a single latent construct:</span>
<span id="cb7-1044"><a href="#cb7-1044" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1045"><a href="#cb7-1045" aria-hidden="true" tabindex="-1"></a>\eta_{s,p}^t = (\mathbf{X}_{s,p}^t)^\top \boldsymbol{\beta}_{s,p} + \zeta_{s,p}^t, </span>
<span id="cb7-1046"><a href="#cb7-1046" aria-hidden="true" tabindex="-1"></a>\qquad \zeta_{s,p}^t \sim \mathcal{N}(0,\sigma_{\zeta,s,p}^2).</span>
<span id="cb7-1047"><a href="#cb7-1047" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1048"><a href="#cb7-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1049"><a href="#cb7-1049" aria-hidden="true" tabindex="-1"></a>Customer-level criteria are generated from latent quality with measurement equations:</span>
<span id="cb7-1050"><a href="#cb7-1050" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1051"><a href="#cb7-1051" aria-hidden="true" tabindex="-1"></a>Y_{c,k,p}^t = \lambda_{c,k,p}\,\eta_{p}^t + \varepsilon_{c,k,p}^t,</span>
<span id="cb7-1052"><a href="#cb7-1052" aria-hidden="true" tabindex="-1"></a>\qquad \varepsilon_{c,k,p}^t \sim \mathcal{N}(0,\sigma_{\varepsilon,c,k,p}^2),</span>
<span id="cb7-1053"><a href="#cb7-1053" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1054"><a href="#cb7-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1055"><a href="#cb7-1055" aria-hidden="true" tabindex="-1"></a>where $\eta_p^t$ can be defined as the downstream delivered latent quality induced by selected links and flows (see coupling below). The Bayesian layer yields a predictive distribution</span>
<span id="cb7-1056"><a href="#cb7-1056" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1057"><a href="#cb7-1057" aria-hidden="true" tabindex="-1"></a>p<span class="sc">\!</span>\left(Y_{c,k,p}^t \mid \mathbf{X}^t\right),</span>
<span id="cb7-1058"><a href="#cb7-1058" aria-hidden="true" tabindex="-1"></a>\quad \Rightarrow\quad </span>
<span id="cb7-1059"><a href="#cb7-1059" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="sc">\!</span>\left<span class="co">[</span><span class="ot">Y_{c,k,p}^t \mid \mathbf{X}^t\right</span><span class="co">]</span>.</span>
<span id="cb7-1060"><a href="#cb7-1060" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1061"><a href="#cb7-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1062"><a href="#cb7-1062" aria-hidden="true" tabindex="-1"></a><span class="fu">## Customer satisfaction and endogenous demand</span></span>
<span id="cb7-1063"><a href="#cb7-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1064"><a href="#cb7-1064" aria-hidden="true" tabindex="-1"></a>Each customer $c$ assigns importance weights $w_{c,k}$ to criteria, with $\sum_{k\in\mathcal{K}} w_{c,k}=1$.</span>
<span id="cb7-1065"><a href="#cb7-1065" aria-hidden="true" tabindex="-1"></a>Define satisfaction as a weighted (possibly normalized) aggregation:</span>
<span id="cb7-1066"><a href="#cb7-1066" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1067"><a href="#cb7-1067" aria-hidden="true" tabindex="-1"></a>S_{c,p}^t = \sum_{k\in\mathcal{K}} w_{c,k}\, g_k<span class="sc">\!</span>\left(\mathbb{E}<span class="sc">\!</span>\left<span class="co">[</span><span class="ot">Y_{c,k,p}^t \mid \mathbf{X}^t\right</span><span class="co">]</span>\right),</span>
<span id="cb7-1068"><a href="#cb7-1068" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1069"><a href="#cb7-1069" aria-hidden="true" tabindex="-1"></a>where $g_k(\cdot)$ is a scaling/utility transform (identity in the simplest case).</span>
<span id="cb7-1070"><a href="#cb7-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1071"><a href="#cb7-1071" aria-hidden="true" tabindex="-1"></a>Demand is endogenous and increases with satisfaction:</span>
<span id="cb7-1072"><a href="#cb7-1072" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1073"><a href="#cb7-1073" aria-hidden="true" tabindex="-1"></a>D_{c,p}^t = D_{c,p}^{0,t} + \alpha_{c,p}\, S_{c,p}^t,</span>
<span id="cb7-1074"><a href="#cb7-1074" aria-hidden="true" tabindex="-1"></a>\qquad \alpha_{c,p}\ge 0.</span>
<span id="cb7-1075"><a href="#cb7-1075" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1076"><a href="#cb7-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1077"><a href="#cb7-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">## MILP constraints</span></span>
<span id="cb7-1078"><a href="#cb7-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1079"><a href="#cb7-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">### Flow conservation (intermediate nodes)</span></span>
<span id="cb7-1080"><a href="#cb7-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1081"><a href="#cb7-1081" aria-hidden="true" tabindex="-1"></a>For each non-customer node $s\in\mathcal{S}\setminus\mathcal{C}$, product $p$, and period $t$:</span>
<span id="cb7-1082"><a href="#cb7-1082" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1083"><a href="#cb7-1083" aria-hidden="true" tabindex="-1"></a>\sum_{i:(i,s)\in\mathcal{A}} q_{is,p}^t</span>
<span id="cb7-1084"><a href="#cb7-1084" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1085"><a href="#cb7-1085" aria-hidden="true" tabindex="-1"></a>\sum_{j:(s,j)\in\mathcal{A}} q_{sj,p}^t.</span>
<span id="cb7-1086"><a href="#cb7-1086" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1087"><a href="#cb7-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1088"><a href="#cb7-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demand satisfaction (customers)</span></span>
<span id="cb7-1089"><a href="#cb7-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1090"><a href="#cb7-1090" aria-hidden="true" tabindex="-1"></a>For each customer $c\in\mathcal{C}$, product $p$, and period $t$:</span>
<span id="cb7-1091"><a href="#cb7-1091" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1092"><a href="#cb7-1092" aria-hidden="true" tabindex="-1"></a>\sum_{i:(i,c)\in\mathcal{A}} q_{ic,p}^t = D_{c,p}^t.</span>
<span id="cb7-1093"><a href="#cb7-1093" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1094"><a href="#cb7-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1095"><a href="#cb7-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">### Capacity constraints</span></span>
<span id="cb7-1096"><a href="#cb7-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1097"><a href="#cb7-1097" aria-hidden="true" tabindex="-1"></a>For each node $s\in\mathcal{S}$ and period $t$:</span>
<span id="cb7-1098"><a href="#cb7-1098" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1099"><a href="#cb7-1099" aria-hidden="true" tabindex="-1"></a>\sum_{j:(s,j)\in\mathcal{A}} \sum_{p\in\mathcal{P}} q_{sj,p}^t \le \mathrm{Cap}_s^t.</span>
<span id="cb7-1100"><a href="#cb7-1100" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1101"><a href="#cb7-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1102"><a href="#cb7-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">### Link activation (big-M)</span></span>
<span id="cb7-1103"><a href="#cb7-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1104"><a href="#cb7-1104" aria-hidden="true" tabindex="-1"></a>For each admissible arc, product and period:</span>
<span id="cb7-1105"><a href="#cb7-1105" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1106"><a href="#cb7-1106" aria-hidden="true" tabindex="-1"></a>q_{ij,p}^t \le M_{ij,p}^t\, z_{ij}^t,</span>
<span id="cb7-1107"><a href="#cb7-1107" aria-hidden="true" tabindex="-1"></a>\qquad \forall (i,j)\in\mathcal{A},\; p\in\mathcal{P},\; t\in\mathcal{T}.</span>
<span id="cb7-1108"><a href="#cb7-1108" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1109"><a href="#cb7-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1110"><a href="#cb7-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">### Optional: limit number of selected partners</span></span>
<span id="cb7-1111"><a href="#cb7-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1112"><a href="#cb7-1112" aria-hidden="true" tabindex="-1"></a>For each node $s$ and period $t$:</span>
<span id="cb7-1113"><a href="#cb7-1113" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1114"><a href="#cb7-1114" aria-hidden="true" tabindex="-1"></a>\sum_{j:(s,j)\in\mathcal{A}} z_{sj}^t \le \overline{d}_s,</span>
<span id="cb7-1115"><a href="#cb7-1115" aria-hidden="true" tabindex="-1"></a>\qquad</span>
<span id="cb7-1116"><a href="#cb7-1116" aria-hidden="true" tabindex="-1"></a>\sum_{i:(i,s)\in\mathcal{A}} z_{is}^t \le \overline{u}_s.</span>
<span id="cb7-1117"><a href="#cb7-1117" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1118"><a href="#cb7-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1119"><a href="#cb7-1119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Integrated objective: expected economic utility minus costs</span></span>
<span id="cb7-1120"><a href="#cb7-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1121"><a href="#cb7-1121" aria-hidden="true" tabindex="-1"></a>Let $P_{c,p}^t$ be the selling price (or revenue per unit) for customer $c$ and product $p$ at time $t$.</span>
<span id="cb7-1122"><a href="#cb7-1122" aria-hidden="true" tabindex="-1"></a>Total cost is decomposed into production/process costs, flow/transport costs, and structural (fixed) costs:</span>
<span id="cb7-1123"><a href="#cb7-1123" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1124"><a href="#cb7-1124" aria-hidden="true" tabindex="-1"></a>C^t</span>
<span id="cb7-1125"><a href="#cb7-1125" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1126"><a href="#cb7-1126" aria-hidden="true" tabindex="-1"></a>\sum_{s\in\mathcal{S}} \sum_{p\in\mathcal{P}} C^{\text{prod}}_{s,p}\!\left(\mathbf{X}_{s,p}^t\right)</span>
<span id="cb7-1127"><a href="#cb7-1127" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1128"><a href="#cb7-1128" aria-hidden="true" tabindex="-1"></a>\sum_{(i,j)\in\mathcal{A}} \sum_{p\in\mathcal{P}} C^{\text{flow}}_{ij,p}\, q_{ij,p}^t</span>
<span id="cb7-1129"><a href="#cb7-1129" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1130"><a href="#cb7-1130" aria-hidden="true" tabindex="-1"></a>\sum_{(i,j)\in\mathcal{A}} F_{ij}\, z_{ij}^t.</span>
<span id="cb7-1131"><a href="#cb7-1131" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1132"><a href="#cb7-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1133"><a href="#cb7-1133" aria-hidden="true" tabindex="-1"></a>The integrated problem maximizes expected profit (utility) under Bayesian uncertainty:</span>
<span id="cb7-1134"><a href="#cb7-1134" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1135"><a href="#cb7-1135" aria-hidden="true" tabindex="-1"></a>\max_{z,q,\mathbf{X}} </span>
<span id="cb7-1136"><a href="#cb7-1136" aria-hidden="true" tabindex="-1"></a>\quad</span>
<span id="cb7-1137"><a href="#cb7-1137" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\left[</span>
<span id="cb7-1138"><a href="#cb7-1138" aria-hidden="true" tabindex="-1"></a>\sum_{t\in\mathcal{T}} \sum_{c\in\mathcal{C}} \sum_{p\in\mathcal{P}}</span>
<span id="cb7-1139"><a href="#cb7-1139" aria-hidden="true" tabindex="-1"></a>P_{c,p}^t\, D_{c,p}^t</span>
<span id="cb7-1140"><a href="#cb7-1140" aria-hidden="true" tabindex="-1"></a>-</span>
<span id="cb7-1141"><a href="#cb7-1141" aria-hidden="true" tabindex="-1"></a>\sum_{t\in\mathcal{T}} C^t</span>
<span id="cb7-1142"><a href="#cb7-1142" aria-hidden="true" tabindex="-1"></a>\right].</span>
<span id="cb7-1143"><a href="#cb7-1143" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1144"><a href="#cb7-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1145"><a href="#cb7-1145" aria-hidden="true" tabindex="-1"></a>The expectation is taken with respect to the Bayesian SEM predictive distribution, which propagates process uncertainty to customer criteria and satisfaction, and therefore to endogenous demand.</span>
<span id="cb7-1146"><a href="#cb7-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1147"><a href="#cb7-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1148"><a href="#cb7-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1149"><a href="#cb7-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1150"><a href="#cb7-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Optimization Layer (Gaussian Process + Expected Improvement)</span></span>
<span id="cb7-1151"><a href="#cb7-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1152"><a href="#cb7-1152" aria-hidden="true" tabindex="-1"></a>We introduce a Bayesian Optimization (BO) layer to adaptively tune a vector of controllable continuous decisions</span>
<span id="cb7-1153"><a href="#cb7-1153" aria-hidden="true" tabindex="-1"></a>$\boldsymbol{\theta}\in\Theta \subset \mathbb{R}^d$. Depending on the application, $\boldsymbol{\theta}$ may represent:</span>
<span id="cb7-1154"><a href="#cb7-1154" aria-hidden="true" tabindex="-1"></a>(i) process settings across entities (a subset of $\mathbf{X}_{s,p}^t$),</span>
<span id="cb7-1155"><a href="#cb7-1155" aria-hidden="true" tabindex="-1"></a>(ii) preference/importance weights (e.g., $w_{c,k}$) under constraints,</span>
<span id="cb7-1156"><a href="#cb7-1156" aria-hidden="true" tabindex="-1"></a>or (iii) hyperparameters governing the Bayesian SEM and demand response.</span>
<span id="cb7-1157"><a href="#cb7-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1158"><a href="#cb7-1158" aria-hidden="true" tabindex="-1"></a><span class="fu">### Black-box objective for BO</span></span>
<span id="cb7-1159"><a href="#cb7-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1160"><a href="#cb7-1160" aria-hidden="true" tabindex="-1"></a>Let the integrated Bayesian–MILP model define an expected economic objective evaluated at $\boldsymbol{\theta}$:</span>
<span id="cb7-1161"><a href="#cb7-1161" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1162"><a href="#cb7-1162" aria-hidden="true" tabindex="-1"></a>f(\boldsymbol{\theta})</span>
<span id="cb7-1163"><a href="#cb7-1163" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1164"><a href="#cb7-1164" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="sc">\!</span>\left[</span>
<span id="cb7-1165"><a href="#cb7-1165" aria-hidden="true" tabindex="-1"></a>\sum_{t\in\mathcal{T}} \sum_{c\in\mathcal{C}} \sum_{p\in\mathcal{P}}</span>
<span id="cb7-1166"><a href="#cb7-1166" aria-hidden="true" tabindex="-1"></a>P_{c,p}^t\, D_{c,p}^t(\boldsymbol{\theta})</span>
<span id="cb7-1167"><a href="#cb7-1167" aria-hidden="true" tabindex="-1"></a>-</span>
<span id="cb7-1168"><a href="#cb7-1168" aria-hidden="true" tabindex="-1"></a>\sum_{t\in\mathcal{T}} C^t(\boldsymbol{\theta})</span>
<span id="cb7-1169"><a href="#cb7-1169" aria-hidden="true" tabindex="-1"></a>\right],</span>
<span id="cb7-1170"><a href="#cb7-1170" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1171"><a href="#cb7-1171" aria-hidden="true" tabindex="-1"></a>where the expectation propagates uncertainty from the Bayesian SEM to customer criteria, satisfaction, and endogenous demand.</span>
<span id="cb7-1172"><a href="#cb7-1172" aria-hidden="true" tabindex="-1"></a>For a given $\boldsymbol{\theta}$, the MILP layer yields the optimal network structure and flows</span>
<span id="cb7-1173"><a href="#cb7-1173" aria-hidden="true" tabindex="-1"></a>$(z^\star(\boldsymbol{\theta}), q^\star(\boldsymbol{\theta}))$, and thus an objective realization.</span>
<span id="cb7-1174"><a href="#cb7-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1175"><a href="#cb7-1175" aria-hidden="true" tabindex="-1"></a>Because $f(\boldsymbol{\theta})$ is expensive and potentially noisy (sampling-based expectation, MILP solves),</span>
<span id="cb7-1176"><a href="#cb7-1176" aria-hidden="true" tabindex="-1"></a>we treat it as a black-box function evaluated sequentially.</span>
<span id="cb7-1177"><a href="#cb7-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1178"><a href="#cb7-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gaussian Process surrogate model</span></span>
<span id="cb7-1179"><a href="#cb7-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1180"><a href="#cb7-1180" aria-hidden="true" tabindex="-1"></a>Given $n$ evaluated points $\mathcal{D}_n=\{(\boldsymbol{\theta}_i, y_i)\}_{i=1}^n$ with observations</span>
<span id="cb7-1181"><a href="#cb7-1181" aria-hidden="true" tabindex="-1"></a>$y_i = f(\boldsymbol{\theta}_i) + \epsilon_i$, $\epsilon_i\sim\mathcal{N}(0,\sigma_\epsilon^2)$,</span>
<span id="cb7-1182"><a href="#cb7-1182" aria-hidden="true" tabindex="-1"></a>BO fits a Gaussian Process (GP) prior:</span>
<span id="cb7-1183"><a href="#cb7-1183" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1184"><a href="#cb7-1184" aria-hidden="true" tabindex="-1"></a>f(\boldsymbol{\theta}) \sim \mathcal{GP}<span class="sc">\!</span>\left(m(\boldsymbol{\theta}), k(\boldsymbol{\theta},\boldsymbol{\theta}')\right),</span>
<span id="cb7-1185"><a href="#cb7-1185" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1186"><a href="#cb7-1186" aria-hidden="true" tabindex="-1"></a>typically with $m(\boldsymbol{\theta})=0$ and a stationary kernel (e.g., Matérn-$\nu$):</span>
<span id="cb7-1187"><a href="#cb7-1187" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1188"><a href="#cb7-1188" aria-hidden="true" tabindex="-1"></a>k(\boldsymbol{\theta},\boldsymbol{\theta}')</span>
<span id="cb7-1189"><a href="#cb7-1189" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1190"><a href="#cb7-1190" aria-hidden="true" tabindex="-1"></a>\sigma_f^2\, k_{\text{Matérn}}<span class="sc">\!</span>\left(\lVert \boldsymbol{\theta}-\boldsymbol{\theta}'\rVert_{\Lambda}\right),</span>
<span id="cb7-1191"><a href="#cb7-1191" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1192"><a href="#cb7-1192" aria-hidden="true" tabindex="-1"></a>where $\Lambda$ contains length-scales controlling smoothness.</span>
<span id="cb7-1193"><a href="#cb7-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1194"><a href="#cb7-1194" aria-hidden="true" tabindex="-1"></a>Conditioned on $\mathcal{D}_n$, the GP posterior at a candidate $\boldsymbol{\theta}$ is Gaussian:</span>
<span id="cb7-1195"><a href="#cb7-1195" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1196"><a href="#cb7-1196" aria-hidden="true" tabindex="-1"></a>f(\boldsymbol{\theta}) \mid \mathcal{D}_n \sim \mathcal{N}<span class="sc">\!</span>\left(\mu_n(\boldsymbol{\theta}), \sigma_n^2(\boldsymbol{\theta})\right).</span>
<span id="cb7-1197"><a href="#cb7-1197" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1198"><a href="#cb7-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1199"><a href="#cb7-1199" aria-hidden="true" tabindex="-1"></a><span class="fu">### Acquisition function: Expected Improvement</span></span>
<span id="cb7-1200"><a href="#cb7-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1201"><a href="#cb7-1201" aria-hidden="true" tabindex="-1"></a>Let $f_n^{\max} = \max_{i\le n} y_i$ denote the current best observed value.</span>
<span id="cb7-1202"><a href="#cb7-1202" aria-hidden="true" tabindex="-1"></a>The Expected Improvement (EI) acquisition is:</span>
<span id="cb7-1203"><a href="#cb7-1203" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1204"><a href="#cb7-1204" aria-hidden="true" tabindex="-1"></a>\alpha_{\text{EI}}(\boldsymbol{\theta})</span>
<span id="cb7-1205"><a href="#cb7-1205" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1206"><a href="#cb7-1206" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="sc">\!</span>\left<span class="co">[</span><span class="ot">\max\!\left(0, f(\boldsymbol{\theta}) - f_n^{\max}\right)\,\middle|\,\mathcal{D}_n\right</span><span class="co">]</span>.</span>
<span id="cb7-1207"><a href="#cb7-1207" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1208"><a href="#cb7-1208" aria-hidden="true" tabindex="-1"></a>For a Gaussian posterior, EI admits a closed form. Define</span>
<span id="cb7-1209"><a href="#cb7-1209" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1210"><a href="#cb7-1210" aria-hidden="true" tabindex="-1"></a>Z(\boldsymbol{\theta})</span>
<span id="cb7-1211"><a href="#cb7-1211" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1212"><a href="#cb7-1212" aria-hidden="true" tabindex="-1"></a>\frac{\mu_n(\boldsymbol{\theta}) - f_n^{\max}}{\sigma_n(\boldsymbol{\theta})},</span>
<span id="cb7-1213"><a href="#cb7-1213" aria-hidden="true" tabindex="-1"></a>\quad</span>
<span id="cb7-1214"><a href="#cb7-1214" aria-hidden="true" tabindex="-1"></a>\text{and}\quad</span>
<span id="cb7-1215"><a href="#cb7-1215" aria-hidden="true" tabindex="-1"></a>\Phi(\cdot),\ \phi(\cdot)\ \text{as the standard normal CDF/PDF}.</span>
<span id="cb7-1216"><a href="#cb7-1216" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1217"><a href="#cb7-1217" aria-hidden="true" tabindex="-1"></a>Then:</span>
<span id="cb7-1218"><a href="#cb7-1218" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1219"><a href="#cb7-1219" aria-hidden="true" tabindex="-1"></a>\alpha_{\text{EI}}(\boldsymbol{\theta})</span>
<span id="cb7-1220"><a href="#cb7-1220" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1221"><a href="#cb7-1221" aria-hidden="true" tabindex="-1"></a>\left(\mu_n(\boldsymbol{\theta}) - f_n^{\max}\right)\Phi(Z(\boldsymbol{\theta}))</span>
<span id="cb7-1222"><a href="#cb7-1222" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1223"><a href="#cb7-1223" aria-hidden="true" tabindex="-1"></a>\sigma_n(\boldsymbol{\theta})\,\phi(Z(\boldsymbol{\theta})),</span>
<span id="cb7-1224"><a href="#cb7-1224" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1225"><a href="#cb7-1225" aria-hidden="true" tabindex="-1"></a>with $\alpha_{\text{EI}}(\boldsymbol{\theta})=0$ when $\sigma_n(\boldsymbol{\theta})=0$.</span>
<span id="cb7-1226"><a href="#cb7-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1227"><a href="#cb7-1227" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sequential BO loop coupled to SEM–MILP</span></span>
<span id="cb7-1228"><a href="#cb7-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1229"><a href="#cb7-1229" aria-hidden="true" tabindex="-1"></a>BO selects the next candidate by maximizing the acquisition:</span>
<span id="cb7-1230"><a href="#cb7-1230" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1231"><a href="#cb7-1231" aria-hidden="true" tabindex="-1"></a>\boldsymbol{\theta}_{n+1} \in \arg\max_{\boldsymbol{\theta}\in\Theta}\ \alpha_{\text{EI}}(\boldsymbol{\theta}).</span>
<span id="cb7-1232"><a href="#cb7-1232" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1233"><a href="#cb7-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1234"><a href="#cb7-1234" aria-hidden="true" tabindex="-1"></a>After choosing $\boldsymbol{\theta}_{n+1}$, we:</span>
<span id="cb7-1235"><a href="#cb7-1235" aria-hidden="true" tabindex="-1"></a>1) update the Bayesian SEM to obtain predictive moments for criteria and satisfaction under $\boldsymbol{\theta}_{n+1}$,</span>
<span id="cb7-1236"><a href="#cb7-1236" aria-hidden="true" tabindex="-1"></a>2) solve the MILP to obtain $(z^\star(\boldsymbol{\theta}_{n+1}), q^\star(\boldsymbol{\theta}_{n+1}))$,</span>
<span id="cb7-1237"><a href="#cb7-1237" aria-hidden="true" tabindex="-1"></a>3) compute (or estimate via Monte Carlo) $y_{n+1}\approx f(\boldsymbol{\theta}_{n+1})$,</span>
<span id="cb7-1238"><a href="#cb7-1238" aria-hidden="true" tabindex="-1"></a>4) augment the dataset $\mathcal{D}_{n+1}=\mathcal{D}_n\cup\{(\boldsymbol{\theta}_{n+1},y_{n+1})<span class="sc">\}</span>$ and refit the GP.</span>
<span id="cb7-1239"><a href="#cb7-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1240"><a href="#cb7-1240" aria-hidden="true" tabindex="-1"></a>This loop balances exploration (high $\sigma_n$) and exploitation (high $\mu_n$), enabling adaptive tuning of</span>
<span id="cb7-1241"><a href="#cb7-1241" aria-hidden="true" tabindex="-1"></a>process/policy parameters while preserving discrete network feasibility through the MILP layer.</span>
<span id="cb7-1242"><a href="#cb7-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1243"><a href="#cb7-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1244"><a href="#cb7-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Optimization over Customer Preference Weights</span></span>
<span id="cb7-1245"><a href="#cb7-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1246"><a href="#cb7-1246" aria-hidden="true" tabindex="-1"></a>In this formulation, Bayesian Optimization (BO) is used to adaptively tune</span>
<span id="cb7-1247"><a href="#cb7-1247" aria-hidden="true" tabindex="-1"></a>customer preference weights that determine satisfaction and endogenous demand.</span>
<span id="cb7-1248"><a href="#cb7-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1249"><a href="#cb7-1249" aria-hidden="true" tabindex="-1"></a>Let the weight vector for customer $c$ be defined as:</span>
<span id="cb7-1250"><a href="#cb7-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1251"><a href="#cb7-1251" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1252"><a href="#cb7-1252" aria-hidden="true" tabindex="-1"></a>\mathbf{w}_c = (w_{c,1}, \dots, w_{c,K})</span>
<span id="cb7-1253"><a href="#cb7-1253" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1254"><a href="#cb7-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1255"><a href="#cb7-1255" aria-hidden="true" tabindex="-1"></a>subject to the simplex constraint:</span>
<span id="cb7-1256"><a href="#cb7-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1257"><a href="#cb7-1257" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1258"><a href="#cb7-1258" aria-hidden="true" tabindex="-1"></a>\sum_{k=1}^{K} w_{c,k} = 1, \qquad w_{c,k} \ge 0.</span>
<span id="cb7-1259"><a href="#cb7-1259" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1260"><a href="#cb7-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1261"><a href="#cb7-1261" aria-hidden="true" tabindex="-1"></a>Customer satisfaction is defined as:</span>
<span id="cb7-1262"><a href="#cb7-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1263"><a href="#cb7-1263" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1264"><a href="#cb7-1264" aria-hidden="true" tabindex="-1"></a>S_{c,p}^t =</span>
<span id="cb7-1265"><a href="#cb7-1265" aria-hidden="true" tabindex="-1"></a>\sum_{k=1}^{K}</span>
<span id="cb7-1266"><a href="#cb7-1266" aria-hidden="true" tabindex="-1"></a>w_{c,k}</span>
<span id="cb7-1267"><a href="#cb7-1267" aria-hidden="true" tabindex="-1"></a>\,</span>
<span id="cb7-1268"><a href="#cb7-1268" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="sc">\!</span>\left<span class="co">[</span><span class="ot">Y_{c,k,p}^t \mid \mathbf{X}^t\right</span><span class="co">]</span>.</span>
<span id="cb7-1269"><a href="#cb7-1269" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1270"><a href="#cb7-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1271"><a href="#cb7-1271" aria-hidden="true" tabindex="-1"></a>Demand is endogenous:</span>
<span id="cb7-1272"><a href="#cb7-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1273"><a href="#cb7-1273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1274"><a href="#cb7-1274" aria-hidden="true" tabindex="-1"></a>D_{c,p}^t =</span>
<span id="cb7-1275"><a href="#cb7-1275" aria-hidden="true" tabindex="-1"></a>D_{c,p}^{0,t}</span>
<span id="cb7-1276"><a href="#cb7-1276" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1277"><a href="#cb7-1277" aria-hidden="true" tabindex="-1"></a>\alpha_{c,p} S_{c,p}^t.</span>
<span id="cb7-1278"><a href="#cb7-1278" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1279"><a href="#cb7-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1280"><a href="#cb7-1280" aria-hidden="true" tabindex="-1"></a>The integrated expected profit function becomes:</span>
<span id="cb7-1281"><a href="#cb7-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1282"><a href="#cb7-1282" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1283"><a href="#cb7-1283" aria-hidden="true" tabindex="-1"></a>f(\mathbf{w})</span>
<span id="cb7-1284"><a href="#cb7-1284" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1285"><a href="#cb7-1285" aria-hidden="true" tabindex="-1"></a>\mathbb{E}</span>
<span id="cb7-1286"><a href="#cb7-1286" aria-hidden="true" tabindex="-1"></a>\left[</span>
<span id="cb7-1287"><a href="#cb7-1287" aria-hidden="true" tabindex="-1"></a>\sum_{t,c,p}</span>
<span id="cb7-1288"><a href="#cb7-1288" aria-hidden="true" tabindex="-1"></a>P_{c,p}^t</span>
<span id="cb7-1289"><a href="#cb7-1289" aria-hidden="true" tabindex="-1"></a>D_{c,p}^t(\mathbf{w})</span>
<span id="cb7-1290"><a href="#cb7-1290" aria-hidden="true" tabindex="-1"></a>-</span>
<span id="cb7-1291"><a href="#cb7-1291" aria-hidden="true" tabindex="-1"></a>\sum_t C^t</span>
<span id="cb7-1292"><a href="#cb7-1292" aria-hidden="true" tabindex="-1"></a>\right].</span>
<span id="cb7-1293"><a href="#cb7-1293" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1294"><a href="#cb7-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1295"><a href="#cb7-1295" aria-hidden="true" tabindex="-1"></a>Because $f(\mathbf{w})$ is expensive to evaluate (it requires solving the SEM and MILP layers),</span>
<span id="cb7-1296"><a href="#cb7-1296" aria-hidden="true" tabindex="-1"></a>we model it as a black-box function and approximate it with a Gaussian Process surrogate:</span>
<span id="cb7-1297"><a href="#cb7-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1298"><a href="#cb7-1298" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1299"><a href="#cb7-1299" aria-hidden="true" tabindex="-1"></a>f(\mathbf{w}) \sim \mathcal{GP}(m(\mathbf{w}), k(\mathbf{w}, \mathbf{w}')).</span>
<span id="cb7-1300"><a href="#cb7-1300" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1301"><a href="#cb7-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1302"><a href="#cb7-1302" aria-hidden="true" tabindex="-1"></a>Given observations $<span class="sc">\{</span>(\mathbf{w}_i, y_i)\}_{i=1}^n$,</span>
<span id="cb7-1303"><a href="#cb7-1303" aria-hidden="true" tabindex="-1"></a>the GP posterior predictive distribution is:</span>
<span id="cb7-1304"><a href="#cb7-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1305"><a href="#cb7-1305" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1306"><a href="#cb7-1306" aria-hidden="true" tabindex="-1"></a>f(\mathbf{w}) \mid \mathcal{D}_n</span>
<span id="cb7-1307"><a href="#cb7-1307" aria-hidden="true" tabindex="-1"></a>\sim</span>
<span id="cb7-1308"><a href="#cb7-1308" aria-hidden="true" tabindex="-1"></a>\mathcal{N}</span>
<span id="cb7-1309"><a href="#cb7-1309" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-1310"><a href="#cb7-1310" aria-hidden="true" tabindex="-1"></a>\mu_n(\mathbf{w}),</span>
<span id="cb7-1311"><a href="#cb7-1311" aria-hidden="true" tabindex="-1"></a>\sigma_n^2(\mathbf{w})</span>
<span id="cb7-1312"><a href="#cb7-1312" aria-hidden="true" tabindex="-1"></a>\right).</span>
<span id="cb7-1313"><a href="#cb7-1313" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1314"><a href="#cb7-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1315"><a href="#cb7-1315" aria-hidden="true" tabindex="-1"></a>The next weight vector is selected by maximizing the Expected Improvement acquisition function:</span>
<span id="cb7-1316"><a href="#cb7-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1317"><a href="#cb7-1317" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1318"><a href="#cb7-1318" aria-hidden="true" tabindex="-1"></a>\mathbf{w}_{n+1}</span>
<span id="cb7-1319"><a href="#cb7-1319" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1320"><a href="#cb7-1320" aria-hidden="true" tabindex="-1"></a>\arg\max_{\mathbf{w} \in \Delta}</span>
<span id="cb7-1321"><a href="#cb7-1321" aria-hidden="true" tabindex="-1"></a>\alpha_{\mathrm{EI}}(\mathbf{w}),</span>
<span id="cb7-1322"><a href="#cb7-1322" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1323"><a href="#cb7-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1324"><a href="#cb7-1324" aria-hidden="true" tabindex="-1"></a>where $\Delta$ denotes the probability simplex.</span>
<span id="cb7-1325"><a href="#cb7-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1326"><a href="#cb7-1326" aria-hidden="true" tabindex="-1"></a>The Expected Improvement is defined as:</span>
<span id="cb7-1327"><a href="#cb7-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1328"><a href="#cb7-1328" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1329"><a href="#cb7-1329" aria-hidden="true" tabindex="-1"></a>\alpha_{\mathrm{EI}}(\mathbf{w})</span>
<span id="cb7-1330"><a href="#cb7-1330" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1331"><a href="#cb7-1331" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-1332"><a href="#cb7-1332" aria-hidden="true" tabindex="-1"></a>\mu_n(\mathbf{w}) - f_n^{\max}</span>
<span id="cb7-1333"><a href="#cb7-1333" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-1334"><a href="#cb7-1334" aria-hidden="true" tabindex="-1"></a>\Phi(Z)</span>
<span id="cb7-1335"><a href="#cb7-1335" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1336"><a href="#cb7-1336" aria-hidden="true" tabindex="-1"></a>\sigma_n(\mathbf{w})</span>
<span id="cb7-1337"><a href="#cb7-1337" aria-hidden="true" tabindex="-1"></a>\phi(Z),</span>
<span id="cb7-1338"><a href="#cb7-1338" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1339"><a href="#cb7-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1340"><a href="#cb7-1340" aria-hidden="true" tabindex="-1"></a>with</span>
<span id="cb7-1341"><a href="#cb7-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1342"><a href="#cb7-1342" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1343"><a href="#cb7-1343" aria-hidden="true" tabindex="-1"></a>Z =</span>
<span id="cb7-1344"><a href="#cb7-1344" aria-hidden="true" tabindex="-1"></a>\frac{\mu_n(\mathbf{w}) - f_n^{\max}}</span>
<span id="cb7-1345"><a href="#cb7-1345" aria-hidden="true" tabindex="-1"></a>{\sigma_n(\mathbf{w})}.</span>
<span id="cb7-1346"><a href="#cb7-1346" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1347"><a href="#cb7-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1348"><a href="#cb7-1348" aria-hidden="true" tabindex="-1"></a>This procedure sequentially learns the economically optimal preference structure</span>
<span id="cb7-1349"><a href="#cb7-1349" aria-hidden="true" tabindex="-1"></a>consistent with the production network and Bayesian quality propagation.</span>
<span id="cb7-1350"><a href="#cb7-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1351"><a href="#cb7-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1352"><a href="#cb7-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1353"><a href="#cb7-1353" aria-hidden="true" tabindex="-1"></a><span class="fu">## Flow-Weighted Delivered Quality Aggregation</span></span>
<span id="cb7-1354"><a href="#cb7-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1355"><a href="#cb7-1355" aria-hidden="true" tabindex="-1"></a>When multiple upstream entities supply a customer simultaneously,</span>
<span id="cb7-1356"><a href="#cb7-1356" aria-hidden="true" tabindex="-1"></a>the effective delivered quality must reflect the mixture induced by network flows.</span>
<span id="cb7-1357"><a href="#cb7-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1358"><a href="#cb7-1358" aria-hidden="true" tabindex="-1"></a>Let $\eta_{i,p}^t$ denote the latent quality generated at node $i$.</span>
<span id="cb7-1359"><a href="#cb7-1359" aria-hidden="true" tabindex="-1"></a>The effective quality delivered to customer $c$ is defined as:</span>
<span id="cb7-1360"><a href="#cb7-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1361"><a href="#cb7-1361" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1362"><a href="#cb7-1362" aria-hidden="true" tabindex="-1"></a>\eta_{c,p}^t</span>
<span id="cb7-1363"><a href="#cb7-1363" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1364"><a href="#cb7-1364" aria-hidden="true" tabindex="-1"></a>\frac{</span>
<span id="cb7-1365"><a href="#cb7-1365" aria-hidden="true" tabindex="-1"></a>\sum_{i:(i,c)\in\mathcal{A}}</span>
<span id="cb7-1366"><a href="#cb7-1366" aria-hidden="true" tabindex="-1"></a>q_{i,c,p}^t</span>
<span id="cb7-1367"><a href="#cb7-1367" aria-hidden="true" tabindex="-1"></a>\,</span>
<span id="cb7-1368"><a href="#cb7-1368" aria-hidden="true" tabindex="-1"></a>\eta_{i,p}^t</span>
<span id="cb7-1369"><a href="#cb7-1369" aria-hidden="true" tabindex="-1"></a>}{</span>
<span id="cb7-1370"><a href="#cb7-1370" aria-hidden="true" tabindex="-1"></a>\sum_{i:(i,c)\in\mathcal{A}}</span>
<span id="cb7-1371"><a href="#cb7-1371" aria-hidden="true" tabindex="-1"></a>q_{i,c,p}^t</span>
<span id="cb7-1372"><a href="#cb7-1372" aria-hidden="true" tabindex="-1"></a>}.</span>
<span id="cb7-1373"><a href="#cb7-1373" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1374"><a href="#cb7-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1375"><a href="#cb7-1375" aria-hidden="true" tabindex="-1"></a>This formulation ensures that delivered quality is a flow-weighted average</span>
<span id="cb7-1376"><a href="#cb7-1376" aria-hidden="true" tabindex="-1"></a>of upstream latent quality contributions.</span>
<span id="cb7-1377"><a href="#cb7-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1378"><a href="#cb7-1378" aria-hidden="true" tabindex="-1"></a>Customer evaluation criteria are then modeled as:</span>
<span id="cb7-1379"><a href="#cb7-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1380"><a href="#cb7-1380" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1381"><a href="#cb7-1381" aria-hidden="true" tabindex="-1"></a>Y_{c,k,p}^t</span>
<span id="cb7-1382"><a href="#cb7-1382" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1383"><a href="#cb7-1383" aria-hidden="true" tabindex="-1"></a>\lambda_k</span>
<span id="cb7-1384"><a href="#cb7-1384" aria-hidden="true" tabindex="-1"></a>\eta_{c,p}^t</span>
<span id="cb7-1385"><a href="#cb7-1385" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1386"><a href="#cb7-1386" aria-hidden="true" tabindex="-1"></a>\varepsilon_{c,k,p}^t.</span>
<span id="cb7-1387"><a href="#cb7-1387" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1388"><a href="#cb7-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1389"><a href="#cb7-1389" aria-hidden="true" tabindex="-1"></a>This mechanism couples the MILP network structure with the Bayesian SEM layer,</span>
<span id="cb7-1390"><a href="#cb7-1390" aria-hidden="true" tabindex="-1"></a>allowing discrete routing decisions to directly influence perceived quality,</span>
<span id="cb7-1391"><a href="#cb7-1391" aria-hidden="true" tabindex="-1"></a>customer satisfaction, and endogenous demand.</span>
<span id="cb7-1392"><a href="#cb7-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1393"><a href="#cb7-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1394"><a href="#cb7-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1395"><a href="#cb7-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1396"><a href="#cb7-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1397"><a href="#cb7-1397" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multi-Tier Latent Quality Aggregation</span></span>
<span id="cb7-1398"><a href="#cb7-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1399"><a href="#cb7-1399" aria-hidden="true" tabindex="-1"></a>In multi-tier supply networks, each firm (node) controls its own internal</span>
<span id="cb7-1400"><a href="#cb7-1400" aria-hidden="true" tabindex="-1"></a>process variables. Rather than assuming a single global latent quality,</span>
<span id="cb7-1401"><a href="#cb7-1401" aria-hidden="true" tabindex="-1"></a>we define a node-specific latent construct that captures the contribution</span>
<span id="cb7-1402"><a href="#cb7-1402" aria-hidden="true" tabindex="-1"></a>of each supply chain entity to overall perceived quality.</span>
<span id="cb7-1403"><a href="#cb7-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1404"><a href="#cb7-1404" aria-hidden="true" tabindex="-1"></a>Let <span class="sc">\(</span> S <span class="sc">\)</span> denote the set of active nodes in the supply chain network,</span>
<span id="cb7-1405"><a href="#cb7-1405" aria-hidden="true" tabindex="-1"></a>including upstream tiers, manufacturers, and distribution centers.</span>
<span id="cb7-1406"><a href="#cb7-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1407"><a href="#cb7-1407" aria-hidden="true" tabindex="-1"></a>For each node <span class="sc">\(</span> s \in S <span class="sc">\)</span>, define:</span>
<span id="cb7-1408"><a href="#cb7-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1409"><a href="#cb7-1409" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1410"><a href="#cb7-1410" aria-hidden="true" tabindex="-1"></a>\eta_s = \mathbf{X}_s^\top \boldsymbol{\beta}_s + \zeta_s</span>
<span id="cb7-1411"><a href="#cb7-1411" aria-hidden="true" tabindex="-1"></a>\tag{3}</span>
<span id="cb7-1412"><a href="#cb7-1412" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1413"><a href="#cb7-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1414"><a href="#cb7-1414" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1415"><a href="#cb7-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1416"><a href="#cb7-1416" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \mathbf{X}_s = (x_{s,1}, \dots, x_{s,J_s}) <span class="sc">\)</span> is the vector of process variables controlled by node <span class="sc">\(</span> s <span class="sc">\)</span>,</span>
<span id="cb7-1417"><a href="#cb7-1417" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \boldsymbol{\beta}_s <span class="sc">\)</span> is the vector of structural coefficients associated with node <span class="sc">\(</span> s <span class="sc">\)</span>,</span>
<span id="cb7-1418"><a href="#cb7-1418" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \zeta_s \sim \mathcal{N}(0, \sigma_s^2) <span class="sc">\)</span> represents node-level uncertainty.</span>
<span id="cb7-1419"><a href="#cb7-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1420"><a href="#cb7-1420" aria-hidden="true" tabindex="-1"></a>Thus, each firm contributes a latent quality component <span class="sc">\(</span> \eta_s <span class="sc">\)</span></span>
<span id="cb7-1421"><a href="#cb7-1421" aria-hidden="true" tabindex="-1"></a>to the overall performance of the chain.</span>
<span id="cb7-1422"><a href="#cb7-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1423"><a href="#cb7-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1424"><a href="#cb7-1424" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chain-Level Latent Aggregation</span></span>
<span id="cb7-1425"><a href="#cb7-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1426"><a href="#cb7-1426" aria-hidden="true" tabindex="-1"></a>The overall latent quality perceived by the final customer is modeled</span>
<span id="cb7-1427"><a href="#cb7-1427" aria-hidden="true" tabindex="-1"></a>as a weighted aggregation of node-level latent qualities:</span>
<span id="cb7-1428"><a href="#cb7-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1429"><a href="#cb7-1429" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1430"><a href="#cb7-1430" aria-hidden="true" tabindex="-1"></a>\eta^{\text{chain}} = \sum_{s \in S} \omega_s \, \eta_s</span>
<span id="cb7-1431"><a href="#cb7-1431" aria-hidden="true" tabindex="-1"></a>\tag{4}</span>
<span id="cb7-1432"><a href="#cb7-1432" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1433"><a href="#cb7-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1434"><a href="#cb7-1434" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1435"><a href="#cb7-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1436"><a href="#cb7-1436" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \omega_s \ge 0 <span class="sc">\)</span> represents the relative influence weight of node <span class="sc">\(</span> s <span class="sc">\)</span>,</span>
<span id="cb7-1437"><a href="#cb7-1437" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \sum_{s \in S} \omega_s = 1 <span class="sc">\)</span>.</span>
<span id="cb7-1438"><a href="#cb7-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1439"><a href="#cb7-1439" aria-hidden="true" tabindex="-1"></a>The weights <span class="sc">\(</span> \omega_s <span class="sc">\)</span> capture structural importance, technological</span>
<span id="cb7-1440"><a href="#cb7-1440" aria-hidden="true" tabindex="-1"></a>criticality, or strategic influence of each supply chain actor.</span>
<span id="cb7-1441"><a href="#cb7-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1442"><a href="#cb7-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1443"><a href="#cb7-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1444"><a href="#cb7-1444" aria-hidden="true" tabindex="-1"></a>From a Bayesian perspective, since each <span class="sc">\(</span> \eta_s <span class="sc">\)</span> is stochastic,</span>
<span id="cb7-1445"><a href="#cb7-1445" aria-hidden="true" tabindex="-1"></a>the aggregated chain quality is also stochastic:</span>
<span id="cb7-1446"><a href="#cb7-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1447"><a href="#cb7-1447" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1448"><a href="#cb7-1448" aria-hidden="true" tabindex="-1"></a>\eta^{\text{chain}} \sim \mathcal{N}</span>
<span id="cb7-1449"><a href="#cb7-1449" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-1450"><a href="#cb7-1450" aria-hidden="true" tabindex="-1"></a>\sum_{s \in S} \omega_s \mathbf{X}_s^\top \boldsymbol{\beta}_s,</span>
<span id="cb7-1451"><a href="#cb7-1451" aria-hidden="true" tabindex="-1"></a>\sum_{s \in S} \omega_s^2 \sigma_s^2</span>
<span id="cb7-1452"><a href="#cb7-1452" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-1453"><a href="#cb7-1453" aria-hidden="true" tabindex="-1"></a>\tag{5}</span>
<span id="cb7-1454"><a href="#cb7-1454" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1455"><a href="#cb7-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1456"><a href="#cb7-1456" aria-hidden="true" tabindex="-1"></a>This probabilistic representation allows uncertainty propagation</span>
<span id="cb7-1457"><a href="#cb7-1457" aria-hidden="true" tabindex="-1"></a>from upstream tiers to final customer perception.</span>
<span id="cb7-1458"><a href="#cb7-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1459"><a href="#cb7-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1460"><a href="#cb7-1460" aria-hidden="true" tabindex="-1"></a><span class="fu"># Customer Multi-Criteria Evaluation</span></span>
<span id="cb7-1461"><a href="#cb7-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1462"><a href="#cb7-1462" aria-hidden="true" tabindex="-1"></a><span class="fu">## Customer-Specific Quality Criteria</span></span>
<span id="cb7-1463"><a href="#cb7-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1464"><a href="#cb7-1464" aria-hidden="true" tabindex="-1"></a>Final customers evaluate products through multiple criteria rather than</span>
<span id="cb7-1465"><a href="#cb7-1465" aria-hidden="true" tabindex="-1"></a>a single latent perception. Let <span class="sc">\(</span> C <span class="sc">\)</span> denote the set of customers and</span>
<span id="cb7-1466"><a href="#cb7-1466" aria-hidden="true" tabindex="-1"></a><span class="sc">\(</span> K <span class="sc">\)</span> the set of evaluation criteria.</span>
<span id="cb7-1467"><a href="#cb7-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1468"><a href="#cb7-1468" aria-hidden="true" tabindex="-1"></a>For each customer <span class="sc">\(</span> c \in C <span class="sc">\)</span> and criterion <span class="sc">\(</span> k \in K <span class="sc">\)</span>, we define:</span>
<span id="cb7-1469"><a href="#cb7-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1470"><a href="#cb7-1470" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1471"><a href="#cb7-1471" aria-hidden="true" tabindex="-1"></a>Y_{c,k} = \lambda_{c,k} \, \eta^{\text{chain}} + \varepsilon_{c,k}</span>
<span id="cb7-1472"><a href="#cb7-1472" aria-hidden="true" tabindex="-1"></a>\tag{6}</span>
<span id="cb7-1473"><a href="#cb7-1473" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1474"><a href="#cb7-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1475"><a href="#cb7-1475" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1476"><a href="#cb7-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1477"><a href="#cb7-1477" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \lambda_{c,k} <span class="sc">\)</span> represents the sensitivity of customer <span class="sc">\(</span> c <span class="sc">\)</span></span>
<span id="cb7-1478"><a href="#cb7-1478" aria-hidden="true" tabindex="-1"></a>  to criterion <span class="sc">\(</span> k <span class="sc">\)</span>,</span>
<span id="cb7-1479"><a href="#cb7-1479" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \varepsilon_{c,k} \sim \mathcal{N}(0, \sigma_{c,k}^2) <span class="sc">\)</span></span>
<span id="cb7-1480"><a href="#cb7-1480" aria-hidden="true" tabindex="-1"></a>  captures measurement noise.</span>
<span id="cb7-1481"><a href="#cb7-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1482"><a href="#cb7-1482" aria-hidden="true" tabindex="-1"></a>This formulation allows heterogeneous perceptions across customers.</span>
<span id="cb7-1483"><a href="#cb7-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1484"><a href="#cb7-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1485"><a href="#cb7-1485" aria-hidden="true" tabindex="-1"></a><span class="fu">## Customer Satisfaction Function</span></span>
<span id="cb7-1486"><a href="#cb7-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1487"><a href="#cb7-1487" aria-hidden="true" tabindex="-1"></a>Each customer assigns a different importance weight to each criterion.</span>
<span id="cb7-1488"><a href="#cb7-1488" aria-hidden="true" tabindex="-1"></a>Let <span class="sc">\(</span> w_{c,k} \ge 0 <span class="sc">\)</span> denote the importance weight of criterion <span class="sc">\(</span> k <span class="sc">\)</span></span>
<span id="cb7-1489"><a href="#cb7-1489" aria-hidden="true" tabindex="-1"></a>for customer <span class="sc">\(</span> c <span class="sc">\)</span>, such that:</span>
<span id="cb7-1490"><a href="#cb7-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1491"><a href="#cb7-1491" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1492"><a href="#cb7-1492" aria-hidden="true" tabindex="-1"></a>\sum_{k \in K} w_{c,k} = 1.</span>
<span id="cb7-1493"><a href="#cb7-1493" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1494"><a href="#cb7-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1495"><a href="#cb7-1495" aria-hidden="true" tabindex="-1"></a>Customer satisfaction is defined as:</span>
<span id="cb7-1496"><a href="#cb7-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1497"><a href="#cb7-1497" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1498"><a href="#cb7-1498" aria-hidden="true" tabindex="-1"></a>S_c = \sum_{k \in K} w_{c,k} \, Y_{c,k}</span>
<span id="cb7-1499"><a href="#cb7-1499" aria-hidden="true" tabindex="-1"></a>\tag{7}</span>
<span id="cb7-1500"><a href="#cb7-1500" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1501"><a href="#cb7-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1502"><a href="#cb7-1502" aria-hidden="true" tabindex="-1"></a>Substituting (6) into (7), we obtain:</span>
<span id="cb7-1503"><a href="#cb7-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1504"><a href="#cb7-1504" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1505"><a href="#cb7-1505" aria-hidden="true" tabindex="-1"></a>S_c =</span>
<span id="cb7-1506"><a href="#cb7-1506" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-1507"><a href="#cb7-1507" aria-hidden="true" tabindex="-1"></a>\sum_{k \in K} w_{c,k} \lambda_{c,k}</span>
<span id="cb7-1508"><a href="#cb7-1508" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-1509"><a href="#cb7-1509" aria-hidden="true" tabindex="-1"></a>\eta^{\text{chain}}</span>
<span id="cb7-1510"><a href="#cb7-1510" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1511"><a href="#cb7-1511" aria-hidden="true" tabindex="-1"></a>\sum_{k \in K} w_{c,k} \varepsilon_{c,k}</span>
<span id="cb7-1512"><a href="#cb7-1512" aria-hidden="true" tabindex="-1"></a>\tag{8}</span>
<span id="cb7-1513"><a href="#cb7-1513" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1514"><a href="#cb7-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1515"><a href="#cb7-1515" aria-hidden="true" tabindex="-1"></a>Thus, satisfaction remains a linear transformation of aggregated</span>
<span id="cb7-1516"><a href="#cb7-1516" aria-hidden="true" tabindex="-1"></a>latent quality with customer-specific amplification.</span>
<span id="cb7-1517"><a href="#cb7-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1518"><a href="#cb7-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1519"><a href="#cb7-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expected Customer Satisfaction</span></span>
<span id="cb7-1520"><a href="#cb7-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1521"><a href="#cb7-1521" aria-hidden="true" tabindex="-1"></a>Since <span class="sc">\(</span> \eta^{\text{chain}} <span class="sc">\)</span> is stochastic,</span>
<span id="cb7-1522"><a href="#cb7-1522" aria-hidden="true" tabindex="-1"></a>customer satisfaction is also stochastic.</span>
<span id="cb7-1523"><a href="#cb7-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1524"><a href="#cb7-1524" aria-hidden="true" tabindex="-1"></a>The expected satisfaction for customer <span class="sc">\(</span> c <span class="sc">\)</span> is:</span>
<span id="cb7-1525"><a href="#cb7-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1526"><a href="#cb7-1526" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1527"><a href="#cb7-1527" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">S_c</span><span class="co">]</span> =</span>
<span id="cb7-1528"><a href="#cb7-1528" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-1529"><a href="#cb7-1529" aria-hidden="true" tabindex="-1"></a>\sum_{k \in K} w_{c,k} \lambda_{c,k}</span>
<span id="cb7-1530"><a href="#cb7-1530" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-1531"><a href="#cb7-1531" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">\eta^{\text{chain}}</span><span class="co">]</span></span>
<span id="cb7-1532"><a href="#cb7-1532" aria-hidden="true" tabindex="-1"></a>\tag{9}</span>
<span id="cb7-1533"><a href="#cb7-1533" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1534"><a href="#cb7-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1535"><a href="#cb7-1535" aria-hidden="true" tabindex="-1"></a>This expectation forms the bridge between latent quality modeling</span>
<span id="cb7-1536"><a href="#cb7-1536" aria-hidden="true" tabindex="-1"></a>and economic decision-making.</span>
<span id="cb7-1537"><a href="#cb7-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1538"><a href="#cb7-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1539"><a href="#cb7-1539" aria-hidden="true" tabindex="-1"></a><span class="fu"># Economic Utility Formulation</span></span>
<span id="cb7-1540"><a href="#cb7-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1541"><a href="#cb7-1541" aria-hidden="true" tabindex="-1"></a><span class="fu">## Revenue as a Function of Expected Satisfaction</span></span>
<span id="cb7-1542"><a href="#cb7-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1543"><a href="#cb7-1543" aria-hidden="true" tabindex="-1"></a>Customer demand is assumed to depend positively on expected satisfaction.</span>
<span id="cb7-1544"><a href="#cb7-1544" aria-hidden="true" tabindex="-1"></a>Let <span class="sc">\(</span> D_c <span class="sc">\)</span> denote demand from customer <span class="sc">\(</span> c <span class="sc">\)</span>.</span>
<span id="cb7-1545"><a href="#cb7-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1546"><a href="#cb7-1546" aria-hidden="true" tabindex="-1"></a>We define a linear demand function:</span>
<span id="cb7-1547"><a href="#cb7-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1548"><a href="#cb7-1548" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1549"><a href="#cb7-1549" aria-hidden="true" tabindex="-1"></a>D_c = \alpha_c + \gamma_c \, \mathbb{E}<span class="co">[</span><span class="ot">S_c</span><span class="co">]</span></span>
<span id="cb7-1550"><a href="#cb7-1550" aria-hidden="true" tabindex="-1"></a>\tag{10}</span>
<span id="cb7-1551"><a href="#cb7-1551" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1552"><a href="#cb7-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1553"><a href="#cb7-1553" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1554"><a href="#cb7-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1555"><a href="#cb7-1555" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \alpha_c <span class="sc">\)</span> is baseline demand,</span>
<span id="cb7-1556"><a href="#cb7-1556" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> \gamma_c &gt; 0 <span class="sc">\)</span> represents sensitivity of demand to satisfaction.</span>
<span id="cb7-1557"><a href="#cb7-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1558"><a href="#cb7-1558" aria-hidden="true" tabindex="-1"></a>Substituting (9):</span>
<span id="cb7-1559"><a href="#cb7-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1560"><a href="#cb7-1560" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1561"><a href="#cb7-1561" aria-hidden="true" tabindex="-1"></a>D_c =</span>
<span id="cb7-1562"><a href="#cb7-1562" aria-hidden="true" tabindex="-1"></a>\alpha_c</span>
<span id="cb7-1563"><a href="#cb7-1563" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1564"><a href="#cb7-1564" aria-hidden="true" tabindex="-1"></a>\gamma_c</span>
<span id="cb7-1565"><a href="#cb7-1565" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-1566"><a href="#cb7-1566" aria-hidden="true" tabindex="-1"></a>\sum_{k \in K} w_{c,k} \lambda_{c,k}</span>
<span id="cb7-1567"><a href="#cb7-1567" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-1568"><a href="#cb7-1568" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">\eta^{\text{chain}}</span><span class="co">]</span></span>
<span id="cb7-1569"><a href="#cb7-1569" aria-hidden="true" tabindex="-1"></a>\tag{11}</span>
<span id="cb7-1570"><a href="#cb7-1570" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1571"><a href="#cb7-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1572"><a href="#cb7-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1573"><a href="#cb7-1573" aria-hidden="true" tabindex="-1"></a>Total expected revenue is:</span>
<span id="cb7-1574"><a href="#cb7-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1575"><a href="#cb7-1575" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1576"><a href="#cb7-1576" aria-hidden="true" tabindex="-1"></a>R =</span>
<span id="cb7-1577"><a href="#cb7-1577" aria-hidden="true" tabindex="-1"></a>\sum_{c \in C}</span>
<span id="cb7-1578"><a href="#cb7-1578" aria-hidden="true" tabindex="-1"></a>p_c \, D_c</span>
<span id="cb7-1579"><a href="#cb7-1579" aria-hidden="true" tabindex="-1"></a>\tag{12}</span>
<span id="cb7-1580"><a href="#cb7-1580" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1581"><a href="#cb7-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1582"><a href="#cb7-1582" aria-hidden="true" tabindex="-1"></a>where <span class="sc">\(</span> p_c <span class="sc">\)</span> is selling price for customer <span class="sc">\(</span> c <span class="sc">\)</span>.</span>
<span id="cb7-1583"><a href="#cb7-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1584"><a href="#cb7-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1585"><a href="#cb7-1585" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cost Components</span></span>
<span id="cb7-1586"><a href="#cb7-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1587"><a href="#cb7-1587" aria-hidden="true" tabindex="-1"></a>Total cost consists of three components:</span>
<span id="cb7-1588"><a href="#cb7-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1589"><a href="#cb7-1589" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1590"><a href="#cb7-1590" aria-hidden="true" tabindex="-1"></a>C = C^{prod}(X) + C^{flow}(q) + C^{struct}(z)</span>
<span id="cb7-1591"><a href="#cb7-1591" aria-hidden="true" tabindex="-1"></a>\tag{13}</span>
<span id="cb7-1592"><a href="#cb7-1592" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1593"><a href="#cb7-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1594"><a href="#cb7-1594" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1595"><a href="#cb7-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1596"><a href="#cb7-1596" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> C^{prod}(X) <span class="sc">\)</span>: production and process cost,</span>
<span id="cb7-1597"><a href="#cb7-1597" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> C^{flow}(q) <span class="sc">\)</span>: transportation and logistics cost,</span>
<span id="cb7-1598"><a href="#cb7-1598" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="sc">\(</span> C^{struct}(z) <span class="sc">\)</span>: fixed structural activation cost.</span>
<span id="cb7-1599"><a href="#cb7-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1600"><a href="#cb7-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1601"><a href="#cb7-1601" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expected Utility Maximization</span></span>
<span id="cb7-1602"><a href="#cb7-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1603"><a href="#cb7-1603" aria-hidden="true" tabindex="-1"></a>The expected economic utility of the supply chain is:</span>
<span id="cb7-1604"><a href="#cb7-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1605"><a href="#cb7-1605" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1606"><a href="#cb7-1606" aria-hidden="true" tabindex="-1"></a>U</span>
<span id="cb7-1607"><a href="#cb7-1607" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb7-1608"><a href="#cb7-1608" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">R</span><span class="co">]</span></span>
<span id="cb7-1609"><a href="#cb7-1609" aria-hidden="true" tabindex="-1"></a>-</span>
<span id="cb7-1610"><a href="#cb7-1610" aria-hidden="true" tabindex="-1"></a>C</span>
<span id="cb7-1611"><a href="#cb7-1611" aria-hidden="true" tabindex="-1"></a>\tag{17}</span>
<span id="cb7-1612"><a href="#cb7-1612" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1613"><a href="#cb7-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1614"><a href="#cb7-1614" aria-hidden="true" tabindex="-1"></a>Substituting all components:</span>
<span id="cb7-1615"><a href="#cb7-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1616"><a href="#cb7-1616" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1617"><a href="#cb7-1617" aria-hidden="true" tabindex="-1"></a>U =</span>
<span id="cb7-1618"><a href="#cb7-1618" aria-hidden="true" tabindex="-1"></a>\sum_{c \in C}</span>
<span id="cb7-1619"><a href="#cb7-1619" aria-hidden="true" tabindex="-1"></a>p_c</span>
<span id="cb7-1620"><a href="#cb7-1620" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-1621"><a href="#cb7-1621" aria-hidden="true" tabindex="-1"></a>\alpha_c</span>
<span id="cb7-1622"><a href="#cb7-1622" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb7-1623"><a href="#cb7-1623" aria-hidden="true" tabindex="-1"></a>\gamma_c</span>
<span id="cb7-1624"><a href="#cb7-1624" aria-hidden="true" tabindex="-1"></a>\left(</span>
<span id="cb7-1625"><a href="#cb7-1625" aria-hidden="true" tabindex="-1"></a>\sum_{k \in K} w_{c,k} \lambda_{c,k}</span>
<span id="cb7-1626"><a href="#cb7-1626" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-1627"><a href="#cb7-1627" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">\eta^{\text{chain}}</span><span class="co">]</span></span>
<span id="cb7-1628"><a href="#cb7-1628" aria-hidden="true" tabindex="-1"></a>\right)</span>
<span id="cb7-1629"><a href="#cb7-1629" aria-hidden="true" tabindex="-1"></a>-</span>
<span id="cb7-1630"><a href="#cb7-1630" aria-hidden="true" tabindex="-1"></a>C^{prod}(X)</span>
<span id="cb7-1631"><a href="#cb7-1631" aria-hidden="true" tabindex="-1"></a>-</span>
<span id="cb7-1632"><a href="#cb7-1632" aria-hidden="true" tabindex="-1"></a>C^{flow}(q)</span>
<span id="cb7-1633"><a href="#cb7-1633" aria-hidden="true" tabindex="-1"></a>-</span>
<span id="cb7-1634"><a href="#cb7-1634" aria-hidden="true" tabindex="-1"></a>C^{struct}(z)</span>
<span id="cb7-1635"><a href="#cb7-1635" aria-hidden="true" tabindex="-1"></a>\tag{18}</span>
<span id="cb7-1636"><a href="#cb7-1636" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1637"><a href="#cb7-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1638"><a href="#cb7-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1639"><a href="#cb7-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1640"><a href="#cb7-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1641"><a href="#cb7-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1642"><a href="#cb7-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1643"><a href="#cb7-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1644"><a href="#cb7-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1645"><a href="#cb7-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1646"><a href="#cb7-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1647"><a href="#cb7-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1648"><a href="#cb7-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1649"><a href="#cb7-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1650"><a href="#cb7-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1651"><a href="#cb7-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1652"><a href="#cb7-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1653"><a href="#cb7-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1654"><a href="#cb7-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1655"><a href="#cb7-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1656"><a href="#cb7-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1657"><a href="#cb7-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1658"><a href="#cb7-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1659"><a href="#cb7-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1660"><a href="#cb7-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1661"><a href="#cb7-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1662"><a href="#cb7-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1663"><a href="#cb7-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1664"><a href="#cb7-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1665"><a href="#cb7-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1666"><a href="#cb7-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1667"><a href="#cb7-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1668"><a href="#cb7-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1669"><a href="#cb7-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1670"><a href="#cb7-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1671"><a href="#cb7-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1672"><a href="#cb7-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1673"><a href="#cb7-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1674"><a href="#cb7-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1675"><a href="#cb7-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1676"><a href="#cb7-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1677"><a href="#cb7-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1678"><a href="#cb7-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1679"><a href="#cb7-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1680"><a href="#cb7-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1681"><a href="#cb7-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1682"><a href="#cb7-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1683"><a href="#cb7-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1684"><a href="#cb7-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1685"><a href="#cb7-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1686"><a href="#cb7-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1687"><a href="#cb7-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1688"><a href="#cb7-1688" aria-hidden="true" tabindex="-1"></a><span class="fu"># Structural Equation Model Specification</span></span>
<span id="cb7-1689"><a href="#cb7-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1690"><a href="#cb7-1690" aria-hidden="true" tabindex="-1"></a>The hierarchical SEM is defined as follows:</span>
<span id="cb7-1691"><a href="#cb7-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1692"><a href="#cb7-1692" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1693"><a href="#cb7-1693" aria-hidden="true" tabindex="-1"></a>\eta_i = \mathbf{x}_i^\top \boldsymbol{\beta} + \zeta_i</span>
<span id="cb7-1694"><a href="#cb7-1694" aria-hidden="true" tabindex="-1"></a>$$ {#eq-eta}</span>
<span id="cb7-1695"><a href="#cb7-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1696"><a href="#cb7-1696" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1697"><a href="#cb7-1697" aria-hidden="true" tabindex="-1"></a>Y_{ik} = \lambda_k \eta_i + \varepsilon_{ik}</span>
<span id="cb7-1698"><a href="#cb7-1698" aria-hidden="true" tabindex="-1"></a>$$ {#eq-measure}</span>
<span id="cb7-1699"><a href="#cb7-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1700"><a href="#cb7-1700" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1701"><a href="#cb7-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1702"><a href="#cb7-1702" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathbf{x}_i$ is the vector of process variables,</span>
<span id="cb7-1703"><a href="#cb7-1703" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\boldsymbol{\beta}$ are structural coefficients,</span>
<span id="cb7-1704"><a href="#cb7-1704" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\lambda_k$ are measurement loadings,</span>
<span id="cb7-1705"><a href="#cb7-1705" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\zeta_i \sim \mathcal{N}(0, \sigma_\zeta^2)$,</span>
<span id="cb7-1706"><a href="#cb7-1706" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\varepsilon_{ik} \sim \mathcal{N}(0, \sigma_{\varepsilon_k}^2)$.</span>
<span id="cb7-1707"><a href="#cb7-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1708"><a href="#cb7-1708" aria-hidden="true" tabindex="-1"></a>As shown in Eq. @eq-eta and Eq. @eq-measure,</span>
<span id="cb7-1709"><a href="#cb7-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1710"><a href="#cb7-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1711"><a href="#cb7-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1712"><a href="#cb7-1712" aria-hidden="true" tabindex="-1"></a>Como se muestra en la Figura @fig-arquitectura, el modelo integra la red multi-eslabón con la capa Bayesiana y la capa de optimización.</span>
<span id="cb7-1713"><a href="#cb7-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1714"><a href="#cb7-1714" aria-hidden="true" tabindex="-1"></a>![](images/Dan(2026)v2.png){#fig-arquitectura fig-cap="Arquitectura general del modelo." width=40%}</span>
<span id="cb7-1715"><a href="#cb7-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1716"><a href="#cb7-1716" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simulated SEM Results</span></span>
<span id="cb7-1717"><a href="#cb7-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1720"><a href="#cb7-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-1721"><a href="#cb7-1721" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb7-1722"><a href="#cb7-1722" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb7-1723"><a href="#cb7-1723" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb7-1724"><a href="#cb7-1724" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of simulated latent quality (η)."</span></span>
<span id="cb7-1725"><a href="#cb7-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1726"><a href="#cb7-1726" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-1727"><a href="#cb7-1727" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-1728"><a href="#cb7-1728" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-1729"><a href="#cb7-1729" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb7-1730"><a href="#cb7-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1731"><a href="#cb7-1731" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb7-1732"><a href="#cb7-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1733"><a href="#cb7-1733" aria-hidden="true" tabindex="-1"></a>out_fig <span class="op">=</span> Path(<span class="st">"results/figures"</span>)</span>
<span id="cb7-1734"><a href="#cb7-1734" aria-hidden="true" tabindex="-1"></a>out_tab <span class="op">=</span> Path(<span class="st">"results/tables"</span>)</span>
<span id="cb7-1735"><a href="#cb7-1735" aria-hidden="true" tabindex="-1"></a>out_fig.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-1736"><a href="#cb7-1736" aria-hidden="true" tabindex="-1"></a>out_tab.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-1737"><a href="#cb7-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1738"><a href="#cb7-1738" aria-hidden="true" tabindex="-1"></a>n_products <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb7-1739"><a href="#cb7-1739" aria-hidden="true" tabindex="-1"></a>n_attributes <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb7-1740"><a href="#cb7-1740" aria-hidden="true" tabindex="-1"></a>n_process_vars <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb7-1741"><a href="#cb7-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1742"><a href="#cb7-1742" aria-hidden="true" tabindex="-1"></a>beta_true <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.8</span>, n_process_vars)</span>
<span id="cb7-1743"><a href="#cb7-1743" aria-hidden="true" tabindex="-1"></a>lambda_true <span class="op">=</span> np.array([<span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">0.8</span>])</span>
<span id="cb7-1744"><a href="#cb7-1744" aria-hidden="true" tabindex="-1"></a>sigma_zeta_true <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb7-1745"><a href="#cb7-1745" aria-hidden="true" tabindex="-1"></a>sigma_eps_true <span class="op">=</span> np.array([<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>])</span>
<span id="cb7-1746"><a href="#cb7-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1747"><a href="#cb7-1747" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, (n_products, n_process_vars))</span>
<span id="cb7-1748"><a href="#cb7-1748" aria-hidden="true" tabindex="-1"></a>zeta <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma_zeta_true, n_products)</span>
<span id="cb7-1749"><a href="#cb7-1749" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> X <span class="op">@</span> beta_true <span class="op">+</span> zeta</span>
<span id="cb7-1750"><a href="#cb7-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1751"><a href="#cb7-1751" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.zeros((n_products, n_attributes))</span>
<span id="cb7-1752"><a href="#cb7-1752" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n_attributes):</span>
<span id="cb7-1753"><a href="#cb7-1753" aria-hidden="true" tabindex="-1"></a>    eps <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma_eps_true[k], n_products)</span>
<span id="cb7-1754"><a href="#cb7-1754" aria-hidden="true" tabindex="-1"></a>    Y[:, k] <span class="op">=</span> lambda_true[k] <span class="op">*</span> eta <span class="op">+</span> eps</span>
<span id="cb7-1755"><a href="#cb7-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1756"><a href="#cb7-1756" aria-hidden="true" tabindex="-1"></a>dfY <span class="op">=</span> pd.DataFrame(Y, columns<span class="op">=</span>[<span class="st">"Durability"</span>, <span class="st">"Appearance"</span>, <span class="st">"Comfort"</span>])</span>
<span id="cb7-1757"><a href="#cb7-1757" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> dfY.corr()</span>
<span id="cb7-1758"><a href="#cb7-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1759"><a href="#cb7-1759" aria-hidden="true" tabindex="-1"></a>corr.to_csv(out_tab <span class="op">/</span> <span class="st">"corr_attributes.csv"</span>, index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-1760"><a href="#cb7-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1761"><a href="#cb7-1761" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb7-1762"><a href="#cb7-1762" aria-hidden="true" tabindex="-1"></a>plt.hist(eta, bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb7-1763"><a href="#cb7-1763" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r"Simulated latent quality </span><span class="dv">$</span><span class="er">\</span><span class="vs">eta</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-1764"><a href="#cb7-1764" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-1765"><a href="#cb7-1765" aria-hidden="true" tabindex="-1"></a>plt.savefig(out_fig <span class="op">/</span> <span class="st">"eta_hist.png"</span>, dpi<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb7-1766"><a href="#cb7-1766" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb7-1767"><a href="#cb7-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1768"><a href="#cb7-1768" aria-hidden="true" tabindex="-1"></a>corr.<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb7-1769"><a href="#cb7-1769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1770"><a href="#cb7-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1771"><a href="#cb7-1771" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bayesian SEM Estimation (PyMC)</span></span>
<span id="cb7-1772"><a href="#cb7-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1775"><a href="#cb7-1775" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-1776"><a href="#cb7-1776" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb7-1777"><a href="#cb7-1777" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytensor.tensor <span class="im">as</span> pt</span>
<span id="cb7-1778"><a href="#cb7-1778" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb7-1779"><a href="#cb7-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1780"><a href="#cb7-1780" aria-hidden="true" tabindex="-1"></a>Y_obs <span class="op">=</span> dfY.values</span>
<span id="cb7-1781"><a href="#cb7-1781" aria-hidden="true" tabindex="-1"></a>X_obs <span class="op">=</span> X</span>
<span id="cb7-1782"><a href="#cb7-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1783"><a href="#cb7-1783" aria-hidden="true" tabindex="-1"></a>n, J <span class="op">=</span> X_obs.shape</span>
<span id="cb7-1784"><a href="#cb7-1784" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> Y_obs.shape[<span class="dv">1</span>]</span>
<span id="cb7-1785"><a href="#cb7-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1786"><a href="#cb7-1786" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> sem_model:</span>
<span id="cb7-1787"><a href="#cb7-1787" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> pm.Normal(<span class="st">"beta"</span>, mu<span class="op">=</span><span class="fl">0.0</span>, sigma<span class="op">=</span><span class="fl">1.0</span>, shape<span class="op">=</span>J)</span>
<span id="cb7-1788"><a href="#cb7-1788" aria-hidden="true" tabindex="-1"></a>    sigma_zeta <span class="op">=</span> pm.HalfNormal(<span class="st">"sigma_zeta"</span>, sigma<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb7-1789"><a href="#cb7-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1790"><a href="#cb7-1790" aria-hidden="true" tabindex="-1"></a>    lam <span class="op">=</span> pm.Normal(<span class="st">"lambda"</span>, mu<span class="op">=</span><span class="fl">1.0</span>, sigma<span class="op">=</span><span class="fl">0.5</span>, shape<span class="op">=</span>K)</span>
<span id="cb7-1791"><a href="#cb7-1791" aria-hidden="true" tabindex="-1"></a>    sigma_eps <span class="op">=</span> pm.HalfNormal(<span class="st">"sigma_eps"</span>, sigma<span class="op">=</span><span class="fl">1.0</span>, shape<span class="op">=</span>K)</span>
<span id="cb7-1792"><a href="#cb7-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1793"><a href="#cb7-1793" aria-hidden="true" tabindex="-1"></a>    eta_latent <span class="op">=</span> pm.Normal(</span>
<span id="cb7-1794"><a href="#cb7-1794" aria-hidden="true" tabindex="-1"></a>        <span class="st">"eta"</span>,</span>
<span id="cb7-1795"><a href="#cb7-1795" aria-hidden="true" tabindex="-1"></a>        mu<span class="op">=</span>pt.dot(X_obs, beta),</span>
<span id="cb7-1796"><a href="#cb7-1796" aria-hidden="true" tabindex="-1"></a>        sigma<span class="op">=</span>sigma_zeta,</span>
<span id="cb7-1797"><a href="#cb7-1797" aria-hidden="true" tabindex="-1"></a>        shape<span class="op">=</span>n</span>
<span id="cb7-1798"><a href="#cb7-1798" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-1799"><a href="#cb7-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1800"><a href="#cb7-1800" aria-hidden="true" tabindex="-1"></a>    muY <span class="op">=</span> eta_latent[:, <span class="va">None</span>] <span class="op">*</span> lam[<span class="va">None</span>, :]</span>
<span id="cb7-1801"><a href="#cb7-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1802"><a href="#cb7-1802" aria-hidden="true" tabindex="-1"></a>    pm.Normal(<span class="st">"Y"</span>, mu<span class="op">=</span>muY, sigma<span class="op">=</span>sigma_eps, observed<span class="op">=</span>Y_obs)</span>
<span id="cb7-1803"><a href="#cb7-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1804"><a href="#cb7-1804" aria-hidden="true" tabindex="-1"></a>    idata <span class="op">=</span> pm.sample(</span>
<span id="cb7-1805"><a href="#cb7-1805" aria-hidden="true" tabindex="-1"></a>        draws<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb7-1806"><a href="#cb7-1806" aria-hidden="true" tabindex="-1"></a>        tune<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb7-1807"><a href="#cb7-1807" aria-hidden="true" tabindex="-1"></a>        chains<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb7-1808"><a href="#cb7-1808" aria-hidden="true" tabindex="-1"></a>        target_accept<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb7-1809"><a href="#cb7-1809" aria-hidden="true" tabindex="-1"></a>        random_seed<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb7-1810"><a href="#cb7-1810" aria-hidden="true" tabindex="-1"></a>        progressbar<span class="op">=</span><span class="va">False</span></span>
<span id="cb7-1811"><a href="#cb7-1811" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-1812"><a href="#cb7-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1813"><a href="#cb7-1813" aria-hidden="true" tabindex="-1"></a>az.summary(idata, var_names<span class="op">=</span>[<span class="st">"beta"</span>, <span class="st">"lambda"</span>, <span class="st">"sigma_zeta"</span>, <span class="st">"sigma_eps"</span>], round_to<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb7-1814"><a href="#cb7-1814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1815"><a href="#cb7-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1816"><a href="#cb7-1816" aria-hidden="true" tabindex="-1"></a><span class="fu"># Posterior Diagnostics</span></span>
<span id="cb7-1817"><a href="#cb7-1817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1820"><a href="#cb7-1820" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-1821"><a href="#cb7-1821" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb7-1822"><a href="#cb7-1822" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb7-1823"><a href="#cb7-1823" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb7-1824"><a href="#cb7-1824" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "MCMC trace diagnostics."</span></span>
<span id="cb7-1825"><a href="#cb7-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1826"><a href="#cb7-1826" aria-hidden="true" tabindex="-1"></a>az.plot_trace(idata, var_names<span class="op">=</span>[<span class="st">"beta"</span>, <span class="st">"lambda"</span>, <span class="st">"sigma_zeta"</span>, <span class="st">"sigma_eps"</span>])</span>
<span id="cb7-1827"><a href="#cb7-1827" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-1828"><a href="#cb7-1828" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb7-1829"><a href="#cb7-1829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1830"><a href="#cb7-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1831"><a href="#cb7-1831" aria-hidden="true" tabindex="-1"></a><span class="fu"># Parameter Recovery Check</span></span>
<span id="cb7-1832"><a href="#cb7-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1835"><a href="#cb7-1835" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-1836"><a href="#cb7-1836" aria-hidden="true" tabindex="-1"></a>post <span class="op">=</span> az.summary(idata, var_names<span class="op">=</span>[<span class="st">"beta"</span>, <span class="st">"lambda"</span>], round_to<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb7-1837"><a href="#cb7-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1838"><a href="#cb7-1838" aria-hidden="true" tabindex="-1"></a>post_mean_beta <span class="op">=</span> post.loc[[<span class="ss">f"beta[</span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">]"</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(J)], <span class="st">"mean"</span>].to_numpy()</span>
<span id="cb7-1839"><a href="#cb7-1839" aria-hidden="true" tabindex="-1"></a>post_mean_lam <span class="op">=</span> post.loc[[<span class="ss">f"lambda[</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">]"</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(K)], <span class="st">"mean"</span>].to_numpy()</span>
<span id="cb7-1840"><a href="#cb7-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1841"><a href="#cb7-1841" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-1842"><a href="#cb7-1842" aria-hidden="true" tabindex="-1"></a>    <span class="st">"true"</span>: np.concatenate([beta_true, lambda_true]),</span>
<span id="cb7-1843"><a href="#cb7-1843" aria-hidden="true" tabindex="-1"></a>    <span class="st">"posterior_mean"</span>: np.concatenate([post_mean_beta, post_mean_lam])</span>
<span id="cb7-1844"><a href="#cb7-1844" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-1845"><a href="#cb7-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1846"><a href="#cb7-1846" aria-hidden="true" tabindex="-1"></a>comparison</span>
<span id="cb7-1847"><a href="#cb7-1847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1848"><a href="#cb7-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1851"><a href="#cb7-1851" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-1852"><a href="#cb7-1852" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb7-1853"><a href="#cb7-1853" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb7-1854"><a href="#cb7-1854" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb7-1855"><a href="#cb7-1855" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Posterior mean vs true parameter values."</span></span>
<span id="cb7-1856"><a href="#cb7-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1857"><a href="#cb7-1857" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb7-1858"><a href="#cb7-1858" aria-hidden="true" tabindex="-1"></a>plt.scatter(comparison[<span class="st">"true"</span>], comparison[<span class="st">"posterior_mean"</span>])</span>
<span id="cb7-1859"><a href="#cb7-1859" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"True value"</span>)</span>
<span id="cb7-1860"><a href="#cb7-1860" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Posterior mean"</span>)</span>
<span id="cb7-1861"><a href="#cb7-1861" aria-hidden="true" tabindex="-1"></a>plt.plot(</span>
<span id="cb7-1862"><a href="#cb7-1862" aria-hidden="true" tabindex="-1"></a>    [comparison[<span class="st">"true"</span>].<span class="bu">min</span>(), comparison[<span class="st">"true"</span>].<span class="bu">max</span>()],</span>
<span id="cb7-1863"><a href="#cb7-1863" aria-hidden="true" tabindex="-1"></a>    [comparison[<span class="st">"true"</span>].<span class="bu">min</span>(), comparison[<span class="st">"true"</span>].<span class="bu">max</span>()]</span>
<span id="cb7-1864"><a href="#cb7-1864" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-1865"><a href="#cb7-1865" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-1866"><a href="#cb7-1866" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb7-1867"><a href="#cb7-1867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1868"><a href="#cb7-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1869"><a href="#cb7-1869" aria-hidden="true" tabindex="-1"></a><span class="fu"># Integrated Architecture (Conceptual Diagram)</span></span>
<span id="cb7-1870"><a href="#cb7-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1873"><a href="#cb7-1873" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb7-1874"><a href="#cb7-1874" aria-hidden="true" tabindex="-1"></a>%<span class="dt">%</span>{init: {</span>
<span id="cb7-1875"><a href="#cb7-1875" aria-hidden="true" tabindex="-1"></a>  <span class="ot">"</span><span class="st">theme</span><span class="ot">"</span>: <span class="ot">"</span><span class="st">base</span><span class="ot">"</span>,</span>
<span id="cb7-1876"><a href="#cb7-1876" aria-hidden="true" tabindex="-1"></a>  <span class="ot">"</span><span class="st">themeVariables</span><span class="ot">"</span>: {</span>
<span id="cb7-1877"><a href="#cb7-1877" aria-hidden="true" tabindex="-1"></a>    <span class="ot">"</span><span class="st">background</span><span class="ot">"</span>: <span class="ot">"</span><span class="st">#ffffff</span><span class="ot">"</span>,</span>
<span id="cb7-1878"><a href="#cb7-1878" aria-hidden="true" tabindex="-1"></a>    <span class="ot">"</span><span class="st">primaryColor</span><span class="ot">"</span>: <span class="ot">"</span><span class="st">#ffffff</span><span class="ot">"</span>,</span>
<span id="cb7-1879"><a href="#cb7-1879" aria-hidden="true" tabindex="-1"></a>    <span class="ot">"</span><span class="st">primaryTextColor</span><span class="ot">"</span>: <span class="ot">"</span><span class="st">#111111</span><span class="ot">"</span>,</span>
<span id="cb7-1880"><a href="#cb7-1880" aria-hidden="true" tabindex="-1"></a>    <span class="ot">"</span><span class="st">primaryBorderColor</span><span class="ot">"</span>: <span class="ot">"</span><span class="st">#111111</span><span class="ot">"</span>,</span>
<span id="cb7-1881"><a href="#cb7-1881" aria-hidden="true" tabindex="-1"></a>    <span class="ot">"</span><span class="st">lineColor</span><span class="ot">"</span>: <span class="ot">"</span><span class="st">#111111</span><span class="ot">"</span>,</span>
<span id="cb7-1882"><a href="#cb7-1882" aria-hidden="true" tabindex="-1"></a>    <span class="ot">"</span><span class="st">fontSize</span><span class="ot">"</span>: <span class="ot">"</span><span class="st">12px</span><span class="ot">"</span></span>
<span id="cb7-1883"><a href="#cb7-1883" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb7-1884"><a href="#cb7-1884" aria-hidden="true" tabindex="-1"></a>  <span class="ot">"</span><span class="st">flowchart</span><span class="ot">"</span>: { <span class="ot">"</span><span class="st">curve</span><span class="ot">"</span>: <span class="ot">"</span><span class="st">linear</span><span class="ot">"</span> }</span>
<span id="cb7-1885"><a href="#cb7-1885" aria-hidden="true" tabindex="-1"></a>}}%%</span>
<span id="cb7-1886"><a href="#cb7-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1887"><a href="#cb7-1887" aria-hidden="true" tabindex="-1"></a>flowchart TB</span>
<span id="cb7-1888"><a href="#cb7-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1889"><a href="#cb7-1889" aria-hidden="true" tabindex="-1"></a>  subgraph S[<span class="ot">"</span><span class="st">Red multi-eslabón (tiers)</span><span class="ot">"</span>]</span>
<span id="cb7-1890"><a href="#cb7-1890" aria-hidden="true" tabindex="-1"></a>    direction TB</span>
<span id="cb7-1891"><a href="#cb7-1891" aria-hidden="true" tabindex="-1"></a>    T3[<span class="ot">"</span><span class="st">Tier 3</span><span class="ot">"</span>] --&gt; T2[<span class="ot">"</span><span class="st">Tier 2</span><span class="ot">"</span>] --&gt; T1[<span class="ot">"</span><span class="st">Tier 1</span><span class="ot">"</span>] --&gt; M[<span class="ot">"</span><span class="st">Manufacturer</span><span class="ot">"</span>] --&gt; D[<span class="ot">"</span><span class="st">CD</span><span class="ot">"</span>] --&gt; C[<span class="ot">"</span><span class="st">Customer</span><span class="ot">"</span>]</span>
<span id="cb7-1892"><a href="#cb7-1892" aria-hidden="true" tabindex="-1"></a>  end</span>
<span id="cb7-1893"><a href="#cb7-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1894"><a href="#cb7-1894" aria-hidden="true" tabindex="-1"></a>  subgraph B[<span class="ot">"</span><span class="st">Capa Bayesiana (SEM + BO)</span><span class="ot">"</span>]</span>
<span id="cb7-1895"><a href="#cb7-1895" aria-hidden="true" tabindex="-1"></a>    direction TB</span>
<span id="cb7-1896"><a href="#cb7-1896" aria-hidden="true" tabindex="-1"></a>    X[<span class="ot">"</span><span class="st">Procesos / variables&lt;br/&gt;X_s</span><span class="ot">"</span>] --&gt; ETA[<span class="ot">"</span><span class="st">Calidad latente η</span><span class="ot">"</span>]</span>
<span id="cb7-1897"><a href="#cb7-1897" aria-hidden="true" tabindex="-1"></a>    ETA --&gt; Y[<span class="ot">"</span><span class="st">Criterios Y_{c,k}</span><span class="ot">"</span>]</span>
<span id="cb7-1898"><a href="#cb7-1898" aria-hidden="true" tabindex="-1"></a>    Y --&gt; SC[<span class="ot">"</span><span class="st">Satisfacción S_c</span><span class="ot">"</span>]</span>
<span id="cb7-1899"><a href="#cb7-1899" aria-hidden="true" tabindex="-1"></a>    SC --&gt; U[<span class="ot">"</span><span class="st">Utilidad económica U</span><span class="ot">"</span>]</span>
<span id="cb7-1900"><a href="#cb7-1900" aria-hidden="true" tabindex="-1"></a>  end</span>
<span id="cb7-1901"><a href="#cb7-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1902"><a href="#cb7-1902" aria-hidden="true" tabindex="-1"></a>  S --&gt; X</span>
<span id="cb7-1903"><a href="#cb7-1903" aria-hidden="true" tabindex="-1"></a>  U --&gt; MILP[<span class="ot">"</span><span class="st">MILP: selección de enlaces z&lt;br/&gt;y flujos q</span><span class="ot">"</span>]</span>
<span id="cb7-1904"><a href="#cb7-1904" aria-hidden="true" tabindex="-1"></a>  MILP --&gt; S</span>
<span id="cb7-1905"><a href="#cb7-1905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1906"><a href="#cb7-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1907"><a href="#cb7-1907" aria-hidden="true" tabindex="-1"></a><span class="fu"># Customer Satisfaction and Endogenous Demand</span></span>
<span id="cb7-1908"><a href="#cb7-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1909"><a href="#cb7-1909" aria-hidden="true" tabindex="-1"></a>Customer satisfaction for product $p$ and customer $c$ is defined as:</span>
<span id="cb7-1910"><a href="#cb7-1910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1911"><a href="#cb7-1911" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1912"><a href="#cb7-1912" aria-hidden="true" tabindex="-1"></a>S_{c,p} = \sum_{k=1}^{K} w_{c,k} \mathbb{E}<span class="co">[</span><span class="ot">Y_{c,p,k}</span><span class="co">]</span></span>
<span id="cb7-1913"><a href="#cb7-1913" aria-hidden="true" tabindex="-1"></a>$$ {#eq-satisfaction}</span>
<span id="cb7-1914"><a href="#cb7-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1915"><a href="#cb7-1915" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1916"><a href="#cb7-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1917"><a href="#cb7-1917" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$w_{c,k}$ represents the importance weight of criterion $k$ for customer $c$,</span>
<span id="cb7-1918"><a href="#cb7-1918" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\sum_{k} w_{c,k} = 1$.</span>
<span id="cb7-1919"><a href="#cb7-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1920"><a href="#cb7-1920" aria-hidden="true" tabindex="-1"></a>Demand is assumed to be endogenous and driven by satisfaction:</span>
<span id="cb7-1921"><a href="#cb7-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1922"><a href="#cb7-1922" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1923"><a href="#cb7-1923" aria-hidden="true" tabindex="-1"></a>d_{c,p} = d_{c,p}^{0} + \alpha_{c,p} S_{c,p}</span>
<span id="cb7-1924"><a href="#cb7-1924" aria-hidden="true" tabindex="-1"></a>$$ {#eq-demand}</span>
<span id="cb7-1925"><a href="#cb7-1925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1926"><a href="#cb7-1926" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1927"><a href="#cb7-1927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1928"><a href="#cb7-1928" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$d_{c,p}^{0}$ is the baseline demand,</span>
<span id="cb7-1929"><a href="#cb7-1929" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\alpha_{c,p}$ measures sensitivity of demand to satisfaction.</span>
<span id="cb7-1930"><a href="#cb7-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1931"><a href="#cb7-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1932"><a href="#cb7-1932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1933"><a href="#cb7-1933" aria-hidden="true" tabindex="-1"></a><span class="fu"># Economic Utility Function</span></span>
<span id="cb7-1934"><a href="#cb7-1934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1935"><a href="#cb7-1935" aria-hidden="true" tabindex="-1"></a>Total economic utility is defined as:</span>
<span id="cb7-1936"><a href="#cb7-1936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1937"><a href="#cb7-1937" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1938"><a href="#cb7-1938" aria-hidden="true" tabindex="-1"></a>U = \sum_{c,p} \left( price_{c,p} \cdot q_{c,p} \right)</span>
<span id="cb7-1939"><a href="#cb7-1939" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\gamma \sum_{c,p} S_{c,p} q_{c,p}</span>
<span id="cb7-1940"><a href="#cb7-1940" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>C</span>
<span id="cb7-1941"><a href="#cb7-1941" aria-hidden="true" tabindex="-1"></a>$$ {#eq-utility}</span>
<span id="cb7-1942"><a href="#cb7-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1943"><a href="#cb7-1943" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb7-1944"><a href="#cb7-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1945"><a href="#cb7-1945" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$q_{c,p}$ is the quantity delivered to customer $c$,</span>
<span id="cb7-1946"><a href="#cb7-1946" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\gamma$ represents the economic impact of satisfaction,</span>
<span id="cb7-1947"><a href="#cb7-1947" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$C$ is total supply chain cost.</span>
<span id="cb7-1948"><a href="#cb7-1948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1949"><a href="#cb7-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1950"><a href="#cb7-1950" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cost Structure</span></span>
<span id="cb7-1951"><a href="#cb7-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1952"><a href="#cb7-1952" aria-hidden="true" tabindex="-1"></a>Total cost is composed of:</span>
<span id="cb7-1953"><a href="#cb7-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1954"><a href="#cb7-1954" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1955"><a href="#cb7-1955" aria-hidden="true" tabindex="-1"></a>C = C^{var} + C^{struct}</span>
<span id="cb7-1956"><a href="#cb7-1956" aria-hidden="true" tabindex="-1"></a>$$ {#eq-cost-total}</span>
<span id="cb7-1957"><a href="#cb7-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1958"><a href="#cb7-1958" aria-hidden="true" tabindex="-1"></a>Variable cost:</span>
<span id="cb7-1959"><a href="#cb7-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1960"><a href="#cb7-1960" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1961"><a href="#cb7-1961" aria-hidden="true" tabindex="-1"></a>C^{var} = \sum_{(i,j),p} c^{arc}_{i,j,p} q_{i,j,p}</span>
<span id="cb7-1962"><a href="#cb7-1962" aria-hidden="true" tabindex="-1"></a>$$ {#eq-cost-var}</span>
<span id="cb7-1963"><a href="#cb7-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1964"><a href="#cb7-1964" aria-hidden="true" tabindex="-1"></a>Structural cost:</span>
<span id="cb7-1965"><a href="#cb7-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1966"><a href="#cb7-1966" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1967"><a href="#cb7-1967" aria-hidden="true" tabindex="-1"></a>C^{struct} = \sum_{(i,j),p} f_{i,j} z_{i,j,p}</span>
<span id="cb7-1968"><a href="#cb7-1968" aria-hidden="true" tabindex="-1"></a>$$ {#eq-cost-struct}</span>
<span id="cb7-1969"><a href="#cb7-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1970"><a href="#cb7-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1971"><a href="#cb7-1971" aria-hidden="true" tabindex="-1"></a><span class="fu"># MILP Formulation</span></span>
<span id="cb7-1972"><a href="#cb7-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1973"><a href="#cb7-1973" aria-hidden="true" tabindex="-1"></a>The optimization problem is:</span>
<span id="cb7-1974"><a href="#cb7-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1975"><a href="#cb7-1975" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1976"><a href="#cb7-1976" aria-hidden="true" tabindex="-1"></a>\max U</span>
<span id="cb7-1977"><a href="#cb7-1977" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1978"><a href="#cb7-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1979"><a href="#cb7-1979" aria-hidden="true" tabindex="-1"></a>Subject to:</span>
<span id="cb7-1980"><a href="#cb7-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1981"><a href="#cb7-1981" aria-hidden="true" tabindex="-1"></a>Flow conservation:</span>
<span id="cb7-1982"><a href="#cb7-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1983"><a href="#cb7-1983" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1984"><a href="#cb7-1984" aria-hidden="true" tabindex="-1"></a>\sum_{i} q_{i,j,p} = \sum_{k} q_{j,k,p}</span>
<span id="cb7-1985"><a href="#cb7-1985" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1986"><a href="#cb7-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1987"><a href="#cb7-1987" aria-hidden="true" tabindex="-1"></a>Capacity constraints:</span>
<span id="cb7-1988"><a href="#cb7-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1989"><a href="#cb7-1989" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1990"><a href="#cb7-1990" aria-hidden="true" tabindex="-1"></a>\sum_{j,p} q_{i,j,p} \leq Cap_i</span>
<span id="cb7-1991"><a href="#cb7-1991" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1992"><a href="#cb7-1992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1993"><a href="#cb7-1993" aria-hidden="true" tabindex="-1"></a>Link activation constraints:</span>
<span id="cb7-1994"><a href="#cb7-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1995"><a href="#cb7-1995" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1996"><a href="#cb7-1996" aria-hidden="true" tabindex="-1"></a>q_{i,j,p} \leq M z_{i,j,p}</span>
<span id="cb7-1997"><a href="#cb7-1997" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-1998"><a href="#cb7-1998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1999"><a href="#cb7-1999" aria-hidden="true" tabindex="-1"></a>Binary structure:</span>
<span id="cb7-2000"><a href="#cb7-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2001"><a href="#cb7-2001" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2002"><a href="#cb7-2002" aria-hidden="true" tabindex="-1"></a>z_{i,j,p} \in <span class="sc">\{</span>0,1<span class="sc">\}</span></span>
<span id="cb7-2003"><a href="#cb7-2003" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2004"><a href="#cb7-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2005"><a href="#cb7-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2006"><a href="#cb7-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2007"><a href="#cb7-2007" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bayesian Optimization Layer (GP + Expected Improvement)</span></span>
<span id="cb7-2008"><a href="#cb7-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2009"><a href="#cb7-2009" aria-hidden="true" tabindex="-1"></a>This section formalizes the Bayesian Optimization (BO) layer used to learn or adapt decision parameters (e.g., customer weights, process targets, or policy parameters) that affect satisfaction and the downstream MILP objective. Let $\boldsymbol{\theta}\in\Theta\subset\mathbb{R}^d$ denote the vector of tunable parameters. Examples include:</span>
<span id="cb7-2010"><a href="#cb7-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2011"><a href="#cb7-2011" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>preference weights $\boldsymbol{\theta}=<span class="sc">\{</span>w_{c,k}<span class="sc">\}</span>$,</span>
<span id="cb7-2012"><a href="#cb7-2012" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>process-control targets $\boldsymbol{\theta}=<span class="sc">\{</span>x_{s,j}^{\star}<span class="sc">\}</span>$,</span>
<span id="cb7-2013"><a href="#cb7-2013" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>economic trade-off parameters $\boldsymbol{\theta}=<span class="sc">\{</span>\gamma,\alpha_{c,p}<span class="sc">\}</span>$,</span>
<span id="cb7-2014"><a href="#cb7-2014" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>or any calibration vector that impacts expected satisfaction and utility.</span>
<span id="cb7-2015"><a href="#cb7-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2016"><a href="#cb7-2016" aria-hidden="true" tabindex="-1"></a>We define the (black-box) BO objective as the **expected economic utility** induced by $\boldsymbol{\theta}$:</span>
<span id="cb7-2017"><a href="#cb7-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2018"><a href="#cb7-2018" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2019"><a href="#cb7-2019" aria-hidden="true" tabindex="-1"></a>f(\boldsymbol{\theta}) \;=\; \mathbb{E}\Big<span class="co">[</span><span class="ot">\, U(\boldsymbol{q}^{\star}(\boldsymbol{\theta}),\boldsymbol{z}^{\star}(\boldsymbol{\theta});\,\boldsymbol{\theta}) \,\Big</span><span class="co">]</span>,</span>
<span id="cb7-2020"><a href="#cb7-2020" aria-hidden="true" tabindex="-1"></a>$$ {#eq-bo-obj}</span>
<span id="cb7-2021"><a href="#cb7-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2022"><a href="#cb7-2022" aria-hidden="true" tabindex="-1"></a>where $(\boldsymbol{q}^{\star}(\boldsymbol{\theta}),\boldsymbol{z}^{\star}(\boldsymbol{\theta}))$ is the MILP optimal solution under parameterization $\boldsymbol{\theta}$, and the expectation is taken with respect to the Bayesian layer uncertainty (SEM posterior and any stochastic components).</span>
<span id="cb7-2023"><a href="#cb7-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2024"><a href="#cb7-2024" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gaussian Process Surrogate</span></span>
<span id="cb7-2025"><a href="#cb7-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2026"><a href="#cb7-2026" aria-hidden="true" tabindex="-1"></a>At iteration $n$, we have evaluated $f$ at $\mathcal{D}_n=\{(\boldsymbol{\theta}_i, y_i)\}_{i=1}^n$, where:</span>
<span id="cb7-2027"><a href="#cb7-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2028"><a href="#cb7-2028" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2029"><a href="#cb7-2029" aria-hidden="true" tabindex="-1"></a>y_i \;=\; f(\boldsymbol{\theta}_i) + \epsilon_i,\qquad \epsilon_i \sim \mathcal{N}(0,\sigma_\epsilon^2).</span>
<span id="cb7-2030"><a href="#cb7-2030" aria-hidden="true" tabindex="-1"></a>$$ {#eq-bo-noise}</span>
<span id="cb7-2031"><a href="#cb7-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2032"><a href="#cb7-2032" aria-hidden="true" tabindex="-1"></a>We place a Gaussian Process prior on $f$:</span>
<span id="cb7-2033"><a href="#cb7-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2034"><a href="#cb7-2034" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2035"><a href="#cb7-2035" aria-hidden="true" tabindex="-1"></a>f(\boldsymbol{\theta}) \sim \mathcal{GP}\big(m(\boldsymbol{\theta}),\,k(\boldsymbol{\theta},\boldsymbol{\theta}')\big),</span>
<span id="cb7-2036"><a href="#cb7-2036" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-prior}</span>
<span id="cb7-2037"><a href="#cb7-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2038"><a href="#cb7-2038" aria-hidden="true" tabindex="-1"></a>commonly using a constant mean $m(\boldsymbol{\theta})=m_0$ and an RBF kernel:</span>
<span id="cb7-2039"><a href="#cb7-2039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2040"><a href="#cb7-2040" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2041"><a href="#cb7-2041" aria-hidden="true" tabindex="-1"></a>k(\boldsymbol{\theta},\boldsymbol{\theta}') \;=\; \sigma_f^2 \exp<span class="sc">\!</span>\left(</span>
<span id="cb7-2042"><a href="#cb7-2042" aria-hidden="true" tabindex="-1"></a>-\frac{1}{2}\sum_{\ell=1}^{d}\frac{(\theta_\ell-\theta'_\ell)^2}{\rho_\ell^2}</span>
<span id="cb7-2043"><a href="#cb7-2043" aria-hidden="true" tabindex="-1"></a>\right).</span>
<span id="cb7-2044"><a href="#cb7-2044" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-kernel}</span>
<span id="cb7-2045"><a href="#cb7-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2046"><a href="#cb7-2046" aria-hidden="true" tabindex="-1"></a>Given $\mathcal{D}_n$, the GP posterior at a candidate $\boldsymbol{\theta}$ is Gaussian:</span>
<span id="cb7-2047"><a href="#cb7-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2048"><a href="#cb7-2048" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2049"><a href="#cb7-2049" aria-hidden="true" tabindex="-1"></a>f(\boldsymbol{\theta}) \mid \mathcal{D}_n \;\sim\; \mathcal{N}<span class="sc">\!</span>\big(\mu_n(\boldsymbol{\theta}),\,\sigma_n^2(\boldsymbol{\theta})\big),</span>
<span id="cb7-2050"><a href="#cb7-2050" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-post}</span>
<span id="cb7-2051"><a href="#cb7-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2052"><a href="#cb7-2052" aria-hidden="true" tabindex="-1"></a>with standard expressions:</span>
<span id="cb7-2053"><a href="#cb7-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2054"><a href="#cb7-2054" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2055"><a href="#cb7-2055" aria-hidden="true" tabindex="-1"></a>\mu_n(\boldsymbol{\theta}) \;=\; m(\boldsymbol{\theta}) + \mathbf{k}_n(\boldsymbol{\theta})^\top</span>
<span id="cb7-2056"><a href="#cb7-2056" aria-hidden="true" tabindex="-1"></a>\big(\mathbf{K}_n+\sigma_\epsilon^2\mathbf{I}\big)^{-1}\big(\mathbf{y}-\mathbf{m}_n\big),</span>
<span id="cb7-2057"><a href="#cb7-2057" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-mu}</span>
<span id="cb7-2058"><a href="#cb7-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2059"><a href="#cb7-2059" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2060"><a href="#cb7-2060" aria-hidden="true" tabindex="-1"></a>\sigma_n^2(\boldsymbol{\theta}) \;=\; k(\boldsymbol{\theta},\boldsymbol{\theta}) -</span>
<span id="cb7-2061"><a href="#cb7-2061" aria-hidden="true" tabindex="-1"></a>\mathbf{k}_n(\boldsymbol{\theta})^\top\big(\mathbf{K}_n+\sigma_\epsilon^2\mathbf{I}\big)^{-1}\mathbf{k}_n(\boldsymbol{\theta}),</span>
<span id="cb7-2062"><a href="#cb7-2062" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gp-sigma}</span>
<span id="cb7-2063"><a href="#cb7-2063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2064"><a href="#cb7-2064" aria-hidden="true" tabindex="-1"></a>where $\mathbf{K}_n=[k(\boldsymbol{\theta}_i,\boldsymbol{\theta}_j)]_{i,j}$, $\mathbf{k}_n(\boldsymbol{\theta})=<span class="co">[</span><span class="ot">k(\boldsymbol{\theta}_1,\boldsymbol{\theta}),\ldots,k(\boldsymbol{\theta}_n,\boldsymbol{\theta})</span><span class="co">]</span>^\top$, $\mathbf{y}=<span class="co">[</span><span class="ot">y_1,\ldots,y_n</span><span class="co">]</span>^\top$, and $\mathbf{m}_n=<span class="co">[</span><span class="ot">m(\boldsymbol{\theta}_1),\ldots,m(\boldsymbol{\theta}_n)</span><span class="co">]</span>^\top$.</span>
<span id="cb7-2065"><a href="#cb7-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2066"><a href="#cb7-2066" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expected Improvement Acquisition</span></span>
<span id="cb7-2067"><a href="#cb7-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2068"><a href="#cb7-2068" aria-hidden="true" tabindex="-1"></a>Let $f_n^{\max}=\max_{i\le n} y_i$ be the best observed value so far. The Expected Improvement (EI) acquisition for maximization is:</span>
<span id="cb7-2069"><a href="#cb7-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2070"><a href="#cb7-2070" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2071"><a href="#cb7-2071" aria-hidden="true" tabindex="-1"></a>\mathrm{EI}_n(\boldsymbol{\theta}) \;=\;</span>
<span id="cb7-2072"><a href="#cb7-2072" aria-hidden="true" tabindex="-1"></a>\mathbb{E}\Big<span class="co">[</span><span class="ot">\max\big(0,\, f(\boldsymbol{\theta})-f_n^{\max}-\xi\big)\;\big|\;\mathcal{D}_n\Big</span><span class="co">]</span>,</span>
<span id="cb7-2073"><a href="#cb7-2073" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ei-def}</span>
<span id="cb7-2074"><a href="#cb7-2074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2075"><a href="#cb7-2075" aria-hidden="true" tabindex="-1"></a>where $\xi\ge 0$ controls exploration. Under the GP posterior \@eq-gp-post, EI has closed form. Define:</span>
<span id="cb7-2076"><a href="#cb7-2076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2077"><a href="#cb7-2077" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2078"><a href="#cb7-2078" aria-hidden="true" tabindex="-1"></a>Z(\boldsymbol{\theta}) \;=\; \frac{\mu_n(\boldsymbol{\theta})-f_n^{\max}-\xi}{\sigma_n(\boldsymbol{\theta})},</span>
<span id="cb7-2079"><a href="#cb7-2079" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ei-z}</span>
<span id="cb7-2080"><a href="#cb7-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2081"><a href="#cb7-2081" aria-hidden="true" tabindex="-1"></a>then:</span>
<span id="cb7-2082"><a href="#cb7-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2083"><a href="#cb7-2083" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2084"><a href="#cb7-2084" aria-hidden="true" tabindex="-1"></a>\mathrm{EI}_n(\boldsymbol{\theta}) \;=\;</span>
<span id="cb7-2085"><a href="#cb7-2085" aria-hidden="true" tabindex="-1"></a>\big(\mu_n(\boldsymbol{\theta})-f_n^{\max}-\xi\big)\Phi<span class="sc">\!</span>\big(Z(\boldsymbol{\theta})\big)</span>
<span id="cb7-2086"><a href="#cb7-2086" aria-hidden="true" tabindex="-1"></a>+\sigma_n(\boldsymbol{\theta})\phi<span class="sc">\!</span>\big(Z(\boldsymbol{\theta})\big),</span>
<span id="cb7-2087"><a href="#cb7-2087" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ei-closed}</span>
<span id="cb7-2088"><a href="#cb7-2088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2089"><a href="#cb7-2089" aria-hidden="true" tabindex="-1"></a>with $\Phi(\cdot)$ and $\phi(\cdot)$ the standard normal CDF and PDF.</span>
<span id="cb7-2090"><a href="#cb7-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2091"><a href="#cb7-2091" aria-hidden="true" tabindex="-1"></a>The BO iteration selects the next evaluation point by:</span>
<span id="cb7-2092"><a href="#cb7-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2093"><a href="#cb7-2093" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb7-2094"><a href="#cb7-2094" aria-hidden="true" tabindex="-1"></a>\boldsymbol{\theta}_{n+1} \;=\; \arg\max_{\boldsymbol{\theta}\in\Theta}\;\mathrm{EI}_n(\boldsymbol{\theta}).</span>
<span id="cb7-2095"><a href="#cb7-2095" aria-hidden="true" tabindex="-1"></a>$$ {#eq-bo-next}</span>
<span id="cb7-2096"><a href="#cb7-2096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2097"><a href="#cb7-2097" aria-hidden="true" tabindex="-1"></a><span class="fu">## Coupling with the Bayesian SEM and MILP</span></span>
<span id="cb7-2098"><a href="#cb7-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2099"><a href="#cb7-2099" aria-hidden="true" tabindex="-1"></a>For each candidate $\boldsymbol{\theta}$ evaluated during BO, the workflow is:</span>
<span id="cb7-2100"><a href="#cb7-2100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2101"><a href="#cb7-2101" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**SEM posterior propagation:** draw $(\boldsymbol{\beta},\boldsymbol{\lambda},\boldsymbol{\sigma}) \sim p(\cdot\mid \text{data})$ and compute $\mathbb{E}<span class="co">[</span><span class="ot">Y_{c,p,k}\mid X,\boldsymbol{\theta}</span><span class="co">]</span>$ (or Monte Carlo estimates).</span>
<span id="cb7-2102"><a href="#cb7-2102" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Satisfaction / demand update:** compute $S_{c,p}(\boldsymbol{\theta})$ and any derived demand parameters.</span>
<span id="cb7-2103"><a href="#cb7-2103" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**MILP solve:** solve the MILP to obtain $(\boldsymbol{q}^{\star}(\boldsymbol{\theta}),\boldsymbol{z}^{\star}(\boldsymbol{\theta}))$.</span>
<span id="cb7-2104"><a href="#cb7-2104" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Utility evaluation:** compute $y=f(\boldsymbol{\theta})$ as the expected (or Monte Carlo averaged) utility.</span>
<span id="cb7-2105"><a href="#cb7-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2106"><a href="#cb7-2106" aria-hidden="true" tabindex="-1"></a>This closes the Bayesian loop: BO learns $\boldsymbol{\theta}$ that maximizes the satisfaction-driven expected utility under uncertainty.</span>
<span id="cb7-2107"><a href="#cb7-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2108"><a href="#cb7-2108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2109"><a href="#cb7-2109" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb7-2110"><a href="#cb7-2110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2111"><a href="#cb7-2111" aria-hidden="true" tabindex="-1"></a>The proposed framework integrates:</span>
<span id="cb7-2112"><a href="#cb7-2112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2113"><a href="#cb7-2113" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesian Structural Equation Modeling</span>
<span id="cb7-2114"><a href="#cb7-2114" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multi-tier supply chain structure</span>
<span id="cb7-2115"><a href="#cb7-2115" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Endogenous satisfaction-driven demand</span>
<span id="cb7-2116"><a href="#cb7-2116" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mixed-integer network optimization</span>
<span id="cb7-2117"><a href="#cb7-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2118"><a href="#cb7-2118" aria-hidden="true" tabindex="-1"></a>forming a unified architecture for economic utility maximization.</span>
<span id="cb7-2119"><a href="#cb7-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2120"><a href="#cb7-2120" aria-hidden="true" tabindex="-1"></a>::contentReference<span class="co">[</span><span class="ot">oaicite:0</span><span class="co">]</span>{index=0}</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>